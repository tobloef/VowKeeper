/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={486:function(t,e,n){var r;t=n.nmd(t),function(){var o,i="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",c=32,l=128,u=1/0,f=9007199254740991,p=NaN,h=4294967295,d=[["ary",l],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],m="[object Arguments]",v="[object Array]",g="[object Boolean]",y="[object Date]",b="[object Error]",w="[object Function]",x="[object GeneratorFunction]",k="[object Map]",$="[object Number]",_="[object Object]",M="[object Promise]",S="[object RegExp]",C="[object Set]",O="[object String]",T="[object Symbol]",A="[object WeakMap]",N="[object ArrayBuffer]",E="[object DataView]",D="[object Float32Array]",z="[object Float64Array]",R="[object Int8Array]",I="[object Int16Array]",B="[object Int32Array]",P="[object Uint8Array]",j="[object Uint8ClampedArray]",V="[object Uint16Array]",L="[object Uint32Array]",H=/\b__p \+= '';/g,F=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/&(?:amp|lt|gt|quot|#39);/g,J=/[&<>"']/g,K=RegExp(q.source),U=RegExp(J.source),Y=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),rt=/^\s+/,ot=/\s/,it=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,lt=/[()=,{}\[\]\/\s]/,ut=/\\(\\)?/g,ft=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pt=/\w*$/,ht=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,mt=/^\[object .+?Constructor\]$/,vt=/^0o[0-7]+$/i,gt=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bt=/($^)/,wt=/['\n\r\u2028\u2029\\]/g,xt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",kt="a-z\\xdf-\\xf6\\xf8-\\xff",$t="A-Z\\xc0-\\xd6\\xd8-\\xde",_t="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Mt="["+_t+"]",St="["+xt+"]",Ct="\\d+",Ot="["+kt+"]",Tt="[^\\ud800-\\udfff"+_t+Ct+"\\u2700-\\u27bf"+kt+$t+"]",At="\\ud83c[\\udffb-\\udfff]",Nt="[^\\ud800-\\udfff]",Et="(?:\\ud83c[\\udde6-\\uddff]){2}",Dt="[\\ud800-\\udbff][\\udc00-\\udfff]",zt="["+$t+"]",Rt="(?:"+Ot+"|"+Tt+")",It="(?:"+zt+"|"+Tt+")",Bt="(?:['’](?:d|ll|m|re|s|t|ve))?",Pt="(?:['’](?:D|LL|M|RE|S|T|VE))?",jt="(?:"+St+"|"+At+")?",Vt="[\\ufe0e\\ufe0f]?",Lt=Vt+jt+"(?:\\u200d(?:"+[Nt,Et,Dt].join("|")+")"+Vt+jt+")*",Ht="(?:"+["[\\u2700-\\u27bf]",Et,Dt].join("|")+")"+Lt,Ft="(?:"+[Nt+St+"?",St,Et,Dt,"[\\ud800-\\udfff]"].join("|")+")",Wt=RegExp("['’]","g"),qt=RegExp(St,"g"),Jt=RegExp(At+"(?="+At+")|"+Ft+Lt,"g"),Kt=RegExp([zt+"?"+Ot+"+"+Bt+"(?="+[Mt,zt,"$"].join("|")+")",It+"+"+Pt+"(?="+[Mt,zt+Rt,"$"].join("|")+")",zt+"?"+Rt+"+"+Bt,zt+"+"+Pt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ct,Ht].join("|"),"g"),Ut=RegExp("[\\u200d\\ud800-\\udfff"+xt+"\\ufe0e\\ufe0f]"),Yt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Zt=-1,Xt={};Xt[D]=Xt[z]=Xt[R]=Xt[I]=Xt[B]=Xt[P]=Xt[j]=Xt[V]=Xt[L]=!0,Xt[m]=Xt[v]=Xt[N]=Xt[g]=Xt[E]=Xt[y]=Xt[b]=Xt[w]=Xt[k]=Xt[$]=Xt[_]=Xt[S]=Xt[C]=Xt[O]=Xt[A]=!1;var Qt={};Qt[m]=Qt[v]=Qt[N]=Qt[E]=Qt[g]=Qt[y]=Qt[D]=Qt[z]=Qt[R]=Qt[I]=Qt[B]=Qt[k]=Qt[$]=Qt[_]=Qt[S]=Qt[C]=Qt[O]=Qt[T]=Qt[P]=Qt[j]=Qt[V]=Qt[L]=!0,Qt[b]=Qt[w]=Qt[A]=!1;var te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ee=parseFloat,ne=parseInt,re="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,oe="object"==typeof self&&self&&self.Object===Object&&self,ie=re||oe||Function("return this")(),se=e&&!e.nodeType&&e,ae=se&&t&&!t.nodeType&&t,ce=ae&&ae.exports===se,le=ce&&re.process,ue=function(){try{return ae&&ae.require&&ae.require("util").types||le&&le.binding&&le.binding("util")}catch(t){}}(),fe=ue&&ue.isArrayBuffer,pe=ue&&ue.isDate,he=ue&&ue.isMap,de=ue&&ue.isRegExp,me=ue&&ue.isSet,ve=ue&&ue.isTypedArray;function ge(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ye(t,e,n,r){for(var o=-1,i=null==t?0:t.length;++o<i;){var s=t[o];e(r,s,n(s),t)}return r}function be(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function we(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function xe(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function ke(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}function $e(t,e){return!(null==t||!t.length)&&De(t,e,0)>-1}function _e(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}function Me(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}function Se(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function Ce(t,e,n,r){var o=-1,i=null==t?0:t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function Oe(t,e,n,r){var o=null==t?0:t.length;for(r&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function Te(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Ae=Be("length");function Ne(t,e,n){var r;return n(t,(function(t,n,o){if(e(t,n,o))return r=n,!1})),r}function Ee(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function De(t,e,n){return e==e?function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):Ee(t,Re,n)}function ze(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}function Re(t){return t!=t}function Ie(t,e){var n=null==t?0:t.length;return n?Ve(t,e)/n:p}function Be(t){return function(e){return null==e?o:e[t]}}function Pe(t){return function(e){return null==t?o:t[e]}}function je(t,e,n,r,o){return o(t,(function(t,o,i){n=r?(r=!1,t):e(n,t,o,i)})),n}function Ve(t,e){for(var n,r=-1,i=t.length;++r<i;){var s=e(t[r]);s!==o&&(n=n===o?s:n+s)}return n}function Le(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function He(t){return t?t.slice(0,an(t)+1).replace(rt,""):t}function Fe(t){return function(e){return t(e)}}function We(t,e){return Me(e,(function(e){return t[e]}))}function qe(t,e){return t.has(e)}function Je(t,e){for(var n=-1,r=t.length;++n<r&&De(e,t[n],0)>-1;);return n}function Ke(t,e){for(var n=t.length;n--&&De(e,t[n],0)>-1;);return n}function Ue(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Ye=Pe({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),Ge=Pe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ze(t){return"\\"+te[t]}function Xe(t){return Ut.test(t)}function Qe(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function tn(t,e){return function(n){return t(e(n))}}function en(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var s=t[n];s!==e&&s!==a||(t[n]=a,i[o++]=n)}return i}function nn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function rn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function on(t){return Xe(t)?function(t){for(var e=Jt.lastIndex=0;Jt.test(t);)++e;return e}(t):Ae(t)}function sn(t){return Xe(t)?function(t){return t.match(Jt)||[]}(t):function(t){return t.split("")}(t)}function an(t){for(var e=t.length;e--&&ot.test(t.charAt(e)););return e}var cn=Pe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),ln=function t(e){var n,r=(e=null==e?ie:ln.defaults(ie.Object(),e,ln.pick(ie,Gt))).Array,ot=e.Date,xt=e.Error,kt=e.Function,$t=e.Math,_t=e.Object,Mt=e.RegExp,St=e.String,Ct=e.TypeError,Ot=r.prototype,Tt=kt.prototype,At=_t.prototype,Nt=e["__core-js_shared__"],Et=Tt.toString,Dt=At.hasOwnProperty,zt=0,Rt=(n=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",It=At.toString,Bt=Et.call(_t),Pt=ie._,jt=Mt("^"+Et.call(Dt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vt=ce?e.Buffer:o,Lt=e.Symbol,Ht=e.Uint8Array,Ft=Vt?Vt.allocUnsafe:o,Jt=tn(_t.getPrototypeOf,_t),Ut=_t.create,te=At.propertyIsEnumerable,re=Ot.splice,oe=Lt?Lt.isConcatSpreadable:o,se=Lt?Lt.iterator:o,ae=Lt?Lt.toStringTag:o,le=function(){try{var t=ui(_t,"defineProperty");return t({},"",{}),t}catch(t){}}(),ue=e.clearTimeout!==ie.clearTimeout&&e.clearTimeout,Ae=ot&&ot.now!==ie.Date.now&&ot.now,Pe=e.setTimeout!==ie.setTimeout&&e.setTimeout,un=$t.ceil,fn=$t.floor,pn=_t.getOwnPropertySymbols,hn=Vt?Vt.isBuffer:o,dn=e.isFinite,mn=Ot.join,vn=tn(_t.keys,_t),gn=$t.max,yn=$t.min,bn=ot.now,wn=e.parseInt,xn=$t.random,kn=Ot.reverse,$n=ui(e,"DataView"),_n=ui(e,"Map"),Mn=ui(e,"Promise"),Sn=ui(e,"Set"),Cn=ui(e,"WeakMap"),On=ui(_t,"create"),Tn=Cn&&new Cn,An={},Nn=ji($n),En=ji(_n),Dn=ji(Mn),zn=ji(Sn),Rn=ji(Cn),In=Lt?Lt.prototype:o,Bn=In?In.valueOf:o,Pn=In?In.toString:o;function jn(t){if(na(t)&&!qs(t)&&!(t instanceof Fn)){if(t instanceof Hn)return t;if(Dt.call(t,"__wrapped__"))return Vi(t)}return new Hn(t)}var Vn=function(){function t(){}return function(e){if(!ea(e))return{};if(Ut)return Ut(e);t.prototype=e;var n=new t;return t.prototype=o,n}}();function Ln(){}function Hn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function Fn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Wn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function qn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Jn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Kn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Jn;++e<n;)this.add(t[e])}function Un(t){var e=this.__data__=new qn(t);this.size=e.size}function Yn(t,e){var n=qs(t),r=!n&&Ws(t),o=!n&&!r&&Ys(t),i=!n&&!r&&!o&&ua(t),s=n||r||o||i,a=s?Le(t.length,St):[],c=a.length;for(var l in t)!e&&!Dt.call(t,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||gi(l,c))||a.push(l);return a}function Gn(t){var e=t.length;return e?t[Jr(0,e-1)]:o}function Zn(t,e){return zi(Oo(t),sr(e,0,t.length))}function Xn(t){return zi(Oo(t))}function Qn(t,e,n){(n!==o&&!Ls(t[e],n)||n===o&&!(e in t))&&or(t,e,n)}function tr(t,e,n){var r=t[e];Dt.call(t,e)&&Ls(r,n)&&(n!==o||e in t)||or(t,e,n)}function er(t,e){for(var n=t.length;n--;)if(Ls(t[n][0],e))return n;return-1}function nr(t,e,n,r){return fr(t,(function(t,o,i){e(r,t,n(t),i)})),r}function rr(t,e){return t&&To(e,Ea(e),t)}function or(t,e,n){"__proto__"==e&&le?le(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ir(t,e){for(var n=-1,i=e.length,s=r(i),a=null==t;++n<i;)s[n]=a?o:Ca(t,e[n]);return s}function sr(t,e,n){return t==t&&(n!==o&&(t=t<=n?t:n),e!==o&&(t=t>=e?t:e)),t}function ar(t,e,n,r,i,s){var a,c=1&e,l=2&e,u=4&e;if(n&&(a=i?n(t,r,i,s):n(t)),a!==o)return a;if(!ea(t))return t;var f=qs(t);if(f){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Dt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!c)return Oo(t,a)}else{var p=hi(t),h=p==w||p==x;if(Ys(t))return ko(t,c);if(p==_||p==m||h&&!i){if(a=l||h?{}:mi(t),!c)return l?function(t,e){return To(t,pi(t),e)}(t,function(t,e){return t&&To(e,Da(e),t)}(a,t)):function(t,e){return To(t,fi(t),e)}(t,rr(a,t))}else{if(!Qt[p])return i?t:{};a=function(t,e,n){var r,o=t.constructor;switch(e){case N:return $o(t);case g:case y:return new o(+t);case E:return function(t,e){var n=e?$o(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case D:case z:case R:case I:case B:case P:case j:case V:case L:return _o(t,n);case k:return new o;case $:case O:return new o(t);case S:return function(t){var e=new t.constructor(t.source,pt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case C:return new o;case T:return r=t,Bn?_t(Bn.call(r)):{}}}(t,p,c)}}s||(s=new Un);var d=s.get(t);if(d)return d;s.set(t,a),aa(t)?t.forEach((function(r){a.add(ar(r,e,n,r,t,s))})):ra(t)&&t.forEach((function(r,o){a.set(o,ar(r,e,n,o,t,s))}));var v=f?o:(u?l?ri:ni:l?Da:Ea)(t);return be(v||t,(function(r,o){v&&(r=t[o=r]),tr(a,o,ar(r,e,n,o,t,s))})),a}function cr(t,e,n){var r=n.length;if(null==t)return!r;for(t=_t(t);r--;){var i=n[r],s=e[i],a=t[i];if(a===o&&!(i in t)||!s(a))return!1}return!0}function lr(t,e,n){if("function"!=typeof t)throw new Ct(i);return Ai((function(){t.apply(o,n)}),e)}function ur(t,e,n,r){var o=-1,i=$e,s=!0,a=t.length,c=[],l=e.length;if(!a)return c;n&&(e=Me(e,Fe(n))),r?(i=_e,s=!1):e.length>=200&&(i=qe,s=!1,e=new Kn(e));t:for(;++o<a;){var u=t[o],f=null==n?u:n(u);if(u=r||0!==u?u:0,s&&f==f){for(var p=l;p--;)if(e[p]===f)continue t;c.push(u)}else i(e,f,r)||c.push(u)}return c}jn.templateSettings={escape:Y,evaluate:G,interpolate:Z,variable:"",imports:{_:jn}},jn.prototype=Ln.prototype,jn.prototype.constructor=jn,Hn.prototype=Vn(Ln.prototype),Hn.prototype.constructor=Hn,Fn.prototype=Vn(Ln.prototype),Fn.prototype.constructor=Fn,Wn.prototype.clear=function(){this.__data__=On?On(null):{},this.size=0},Wn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Wn.prototype.get=function(t){var e=this.__data__;if(On){var n=e[t];return n===s?o:n}return Dt.call(e,t)?e[t]:o},Wn.prototype.has=function(t){var e=this.__data__;return On?e[t]!==o:Dt.call(e,t)},Wn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=On&&e===o?s:e,this},qn.prototype.clear=function(){this.__data__=[],this.size=0},qn.prototype.delete=function(t){var e=this.__data__,n=er(e,t);return!(n<0||(n==e.length-1?e.pop():re.call(e,n,1),--this.size,0))},qn.prototype.get=function(t){var e=this.__data__,n=er(e,t);return n<0?o:e[n][1]},qn.prototype.has=function(t){return er(this.__data__,t)>-1},qn.prototype.set=function(t,e){var n=this.__data__,r=er(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Jn.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(_n||qn),string:new Wn}},Jn.prototype.delete=function(t){var e=ci(this,t).delete(t);return this.size-=e?1:0,e},Jn.prototype.get=function(t){return ci(this,t).get(t)},Jn.prototype.has=function(t){return ci(this,t).has(t)},Jn.prototype.set=function(t,e){var n=ci(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Kn.prototype.add=Kn.prototype.push=function(t){return this.__data__.set(t,s),this},Kn.prototype.has=function(t){return this.__data__.has(t)},Un.prototype.clear=function(){this.__data__=new qn,this.size=0},Un.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Un.prototype.get=function(t){return this.__data__.get(t)},Un.prototype.has=function(t){return this.__data__.has(t)},Un.prototype.set=function(t,e){var n=this.__data__;if(n instanceof qn){var r=n.__data__;if(!_n||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Jn(r)}return n.set(t,e),this.size=n.size,this};var fr=Eo(br),pr=Eo(wr,!0);function hr(t,e){var n=!0;return fr(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function dr(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(null!=a&&(c===o?a==a&&!la(a):n(a,c)))var c=a,l=s}return l}function mr(t,e){var n=[];return fr(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}function vr(t,e,n,r,o){var i=-1,s=t.length;for(n||(n=vi),o||(o=[]);++i<s;){var a=t[i];e>0&&n(a)?e>1?vr(a,e-1,n,r,o):Se(o,a):r||(o[o.length]=a)}return o}var gr=Do(),yr=Do(!0);function br(t,e){return t&&gr(t,e,Ea)}function wr(t,e){return t&&yr(t,e,Ea)}function xr(t,e){return ke(e,(function(e){return Xs(t[e])}))}function kr(t,e){for(var n=0,r=(e=yo(e,t)).length;null!=t&&n<r;)t=t[Pi(e[n++])];return n&&n==r?t:o}function $r(t,e,n){var r=e(t);return qs(t)?r:Se(r,n(t))}function _r(t){return null==t?t===o?"[object Undefined]":"[object Null]":ae&&ae in _t(t)?function(t){var e=Dt.call(t,ae),n=t[ae];try{t[ae]=o;var r=!0}catch(t){}var i=It.call(t);return r&&(e?t[ae]=n:delete t[ae]),i}(t):function(t){return It.call(t)}(t)}function Mr(t,e){return t>e}function Sr(t,e){return null!=t&&Dt.call(t,e)}function Cr(t,e){return null!=t&&e in _t(t)}function Or(t,e,n){for(var i=n?_e:$e,s=t[0].length,a=t.length,c=a,l=r(a),u=1/0,f=[];c--;){var p=t[c];c&&e&&(p=Me(p,Fe(e))),u=yn(p.length,u),l[c]=!n&&(e||s>=120&&p.length>=120)?new Kn(c&&p):o}p=t[0];var h=-1,d=l[0];t:for(;++h<s&&f.length<u;){var m=p[h],v=e?e(m):m;if(m=n||0!==m?m:0,!(d?qe(d,v):i(f,v,n))){for(c=a;--c;){var g=l[c];if(!(g?qe(g,v):i(t[c],v,n)))continue t}d&&d.push(v),f.push(m)}}return f}function Tr(t,e,n){var r=null==(t=Si(t,e=yo(e,t)))?t:t[Pi(Zi(e))];return null==r?o:ge(r,t,n)}function Ar(t){return na(t)&&_r(t)==m}function Nr(t,e,n,r,i){return t===e||(null==t||null==e||!na(t)&&!na(e)?t!=t&&e!=e:function(t,e,n,r,i,s){var a=qs(t),c=qs(e),l=a?v:hi(t),u=c?v:hi(e),f=(l=l==m?_:l)==_,p=(u=u==m?_:u)==_,h=l==u;if(h&&Ys(t)){if(!Ys(e))return!1;a=!0,f=!1}if(h&&!f)return s||(s=new Un),a||ua(t)?ti(t,e,n,r,i,s):function(t,e,n,r,o,i,s){switch(n){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case N:return!(t.byteLength!=e.byteLength||!i(new Ht(t),new Ht(e)));case g:case y:case $:return Ls(+t,+e);case b:return t.name==e.name&&t.message==e.message;case S:case O:return t==e+"";case k:var a=Qe;case C:var c=1&r;if(a||(a=nn),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;r|=2,s.set(t,e);var u=ti(a(t),a(e),r,o,i,s);return s.delete(t),u;case T:if(Bn)return Bn.call(t)==Bn.call(e)}return!1}(t,e,l,n,r,i,s);if(!(1&n)){var d=f&&Dt.call(t,"__wrapped__"),w=p&&Dt.call(e,"__wrapped__");if(d||w){var x=d?t.value():t,M=w?e.value():e;return s||(s=new Un),i(x,M,n,r,s)}}return!!h&&(s||(s=new Un),function(t,e,n,r,i,s){var a=1&n,c=ni(t),l=c.length;if(l!=ni(e).length&&!a)return!1;for(var u=l;u--;){var f=c[u];if(!(a?f in e:Dt.call(e,f)))return!1}var p=s.get(t),h=s.get(e);if(p&&h)return p==e&&h==t;var d=!0;s.set(t,e),s.set(e,t);for(var m=a;++u<l;){var v=t[f=c[u]],g=e[f];if(r)var y=a?r(g,v,f,e,t,s):r(v,g,f,t,e,s);if(!(y===o?v===g||i(v,g,n,r,s):y)){d=!1;break}m||(m="constructor"==f)}if(d&&!m){var b=t.constructor,w=e.constructor;b==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(d=!1)}return s.delete(t),s.delete(e),d}(t,e,n,r,i,s))}(t,e,n,r,Nr,i))}function Er(t,e,n,r){var i=n.length,s=i,a=!r;if(null==t)return!s;for(t=_t(t);i--;){var c=n[i];if(a&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++i<s;){var l=(c=n[i])[0],u=t[l],f=c[1];if(a&&c[2]){if(u===o&&!(l in t))return!1}else{var p=new Un;if(r)var h=r(u,f,l,t,e,p);if(!(h===o?Nr(f,u,3,r,p):h))return!1}}return!0}function Dr(t){return!(!ea(t)||(e=t,Rt&&Rt in e))&&(Xs(t)?jt:mt).test(ji(t));var e}function zr(t){return"function"==typeof t?t:null==t?oc:"object"==typeof t?qs(t)?jr(t[0],t[1]):Pr(t):hc(t)}function Rr(t){if(!ki(t))return vn(t);var e=[];for(var n in _t(t))Dt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Ir(t,e){return t<e}function Br(t,e){var n=-1,o=Ks(t)?r(t.length):[];return fr(t,(function(t,r,i){o[++n]=e(t,r,i)})),o}function Pr(t){var e=li(t);return 1==e.length&&e[0][2]?_i(e[0][0],e[0][1]):function(n){return n===t||Er(n,t,e)}}function jr(t,e){return bi(t)&&$i(e)?_i(Pi(t),e):function(n){var r=Ca(n,t);return r===o&&r===e?Oa(n,t):Nr(e,r,3)}}function Vr(t,e,n,r,i){t!==e&&gr(e,(function(s,a){if(i||(i=new Un),ea(s))!function(t,e,n,r,i,s,a){var c=Oi(t,n),l=Oi(e,n),u=a.get(l);if(u)Qn(t,n,u);else{var f=s?s(c,l,n+"",t,e,a):o,p=f===o;if(p){var h=qs(l),d=!h&&Ys(l),m=!h&&!d&&ua(l);f=l,h||d||m?qs(c)?f=c:Us(c)?f=Oo(c):d?(p=!1,f=ko(l,!0)):m?(p=!1,f=_o(l,!0)):f=[]:ia(l)||Ws(l)?(f=c,Ws(c)?f=ya(c):ea(c)&&!Xs(c)||(f=mi(l))):p=!1}p&&(a.set(l,f),i(f,l,r,s,a),a.delete(l)),Qn(t,n,f)}}(t,e,a,n,Vr,r,i);else{var c=r?r(Oi(t,a),s,a+"",t,e,i):o;c===o&&(c=s),Qn(t,a,c)}}),Da)}function Lr(t,e){var n=t.length;if(n)return gi(e+=e<0?n:0,n)?t[e]:o}function Hr(t,e,n){e=e.length?Me(e,(function(t){return qs(t)?function(e){return kr(e,1===t.length?t[0]:t)}:t})):[oc];var r=-1;return e=Me(e,Fe(ai())),function(t,e){var r=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var r=-1,o=t.criteria,i=e.criteria,s=o.length,a=n.length;++r<s;){var c=Mo(o[r],i[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}));r--;)t[r]=t[r].value;return t}(Br(t,(function(t,n,o){return{criteria:Me(e,(function(e){return e(t)})),index:++r,value:t}})))}function Fr(t,e,n){for(var r=-1,o=e.length,i={};++r<o;){var s=e[r],a=kr(t,s);n(a,s)&&Zr(i,yo(s,t),a)}return i}function Wr(t,e,n,r){var o=r?ze:De,i=-1,s=e.length,a=t;for(t===e&&(e=Oo(e)),n&&(a=Me(t,Fe(n)));++i<s;)for(var c=0,l=e[i],u=n?n(l):l;(c=o(a,u,c,r))>-1;)a!==t&&re.call(a,c,1),re.call(t,c,1);return t}function qr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==i){var i=o;gi(o)?re.call(t,o,1):lo(t,o)}}return t}function Jr(t,e){return t+fn(xn()*(e-t+1))}function Kr(t,e){var n="";if(!t||e<1||e>f)return n;do{e%2&&(n+=t),(e=fn(e/2))&&(t+=t)}while(e);return n}function Ur(t,e){return Ni(Mi(t,e,oc),t+"")}function Yr(t){return Gn(La(t))}function Gr(t,e){var n=La(t);return zi(n,sr(e,0,n.length))}function Zr(t,e,n,r){if(!ea(t))return t;for(var i=-1,s=(e=yo(e,t)).length,a=s-1,c=t;null!=c&&++i<s;){var l=Pi(e[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=a){var f=c[l];(u=r?r(f,l,c):o)===o&&(u=ea(f)?f:gi(e[i+1])?[]:{})}tr(c,l,u),c=c[l]}return t}var Xr=Tn?function(t,e){return Tn.set(t,e),t}:oc,Qr=le?function(t,e){return le(t,"toString",{configurable:!0,enumerable:!1,value:ec(e),writable:!0})}:oc;function to(t){return zi(La(t))}function eo(t,e,n){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=r(i);++o<i;)s[o]=t[o+e];return s}function no(t,e){var n;return fr(t,(function(t,r,o){return!(n=e(t,r,o))})),!!n}function ro(t,e,n){var r=0,o=null==t?r:t.length;if("number"==typeof e&&e==e&&o<=2147483647){for(;r<o;){var i=r+o>>>1,s=t[i];null!==s&&!la(s)&&(n?s<=e:s<e)?r=i+1:o=i}return o}return oo(t,e,oc,n)}function oo(t,e,n,r){var i=0,s=null==t?0:t.length;if(0===s)return 0;for(var a=(e=n(e))!=e,c=null===e,l=la(e),u=e===o;i<s;){var f=fn((i+s)/2),p=n(t[f]),h=p!==o,d=null===p,m=p==p,v=la(p);if(a)var g=r||m;else g=u?m&&(r||h):c?m&&h&&(r||!d):l?m&&h&&!d&&(r||!v):!d&&!v&&(r?p<=e:p<e);g?i=f+1:s=f}return yn(s,4294967294)}function io(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!Ls(a,c)){var c=a;i[o++]=0===s?0:s}}return i}function so(t){return"number"==typeof t?t:la(t)?p:+t}function ao(t){if("string"==typeof t)return t;if(qs(t))return Me(t,ao)+"";if(la(t))return Pn?Pn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function co(t,e,n){var r=-1,o=$e,i=t.length,s=!0,a=[],c=a;if(n)s=!1,o=_e;else if(i>=200){var l=e?null:Uo(t);if(l)return nn(l);s=!1,o=qe,c=new Kn}else c=e?[]:a;t:for(;++r<i;){var u=t[r],f=e?e(u):u;if(u=n||0!==u?u:0,s&&f==f){for(var p=c.length;p--;)if(c[p]===f)continue t;e&&c.push(f),a.push(u)}else o(c,f,n)||(c!==a&&c.push(f),a.push(u))}return a}function lo(t,e){return null==(t=Si(t,e=yo(e,t)))||delete t[Pi(Zi(e))]}function uo(t,e,n,r){return Zr(t,e,n(kr(t,e)),r)}function fo(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?eo(t,r?0:i,r?i+1:o):eo(t,r?i+1:0,r?o:i)}function po(t,e){var n=t;return n instanceof Fn&&(n=n.value()),Ce(e,(function(t,e){return e.func.apply(e.thisArg,Se([t],e.args))}),n)}function ho(t,e,n){var o=t.length;if(o<2)return o?co(t[0]):[];for(var i=-1,s=r(o);++i<o;)for(var a=t[i],c=-1;++c<o;)c!=i&&(s[i]=ur(s[i]||a,t[c],e,n));return co(vr(s,1),e,n)}function mo(t,e,n){for(var r=-1,i=t.length,s=e.length,a={};++r<i;){var c=r<s?e[r]:o;n(a,t[r],c)}return a}function vo(t){return Us(t)?t:[]}function go(t){return"function"==typeof t?t:oc}function yo(t,e){return qs(t)?t:bi(t,e)?[t]:Bi(ba(t))}var bo=Ur;function wo(t,e,n){var r=t.length;return n=n===o?r:n,!e&&n>=r?t:eo(t,e,n)}var xo=ue||function(t){return ie.clearTimeout(t)};function ko(t,e){if(e)return t.slice();var n=t.length,r=Ft?Ft(n):new t.constructor(n);return t.copy(r),r}function $o(t){var e=new t.constructor(t.byteLength);return new Ht(e).set(new Ht(t)),e}function _o(t,e){var n=e?$o(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Mo(t,e){if(t!==e){var n=t!==o,r=null===t,i=t==t,s=la(t),a=e!==o,c=null===e,l=e==e,u=la(e);if(!c&&!u&&!s&&t>e||s&&a&&l&&!c&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!s&&!u&&t<e||u&&n&&i&&!r&&!s||c&&n&&i||!a&&i||!l)return-1}return 0}function So(t,e,n,o){for(var i=-1,s=t.length,a=n.length,c=-1,l=e.length,u=gn(s-a,0),f=r(l+u),p=!o;++c<l;)f[c]=e[c];for(;++i<a;)(p||i<s)&&(f[n[i]]=t[i]);for(;u--;)f[c++]=t[i++];return f}function Co(t,e,n,o){for(var i=-1,s=t.length,a=-1,c=n.length,l=-1,u=e.length,f=gn(s-c,0),p=r(f+u),h=!o;++i<f;)p[i]=t[i];for(var d=i;++l<u;)p[d+l]=e[l];for(;++a<c;)(h||i<s)&&(p[d+n[a]]=t[i++]);return p}function Oo(t,e){var n=-1,o=t.length;for(e||(e=r(o));++n<o;)e[n]=t[n];return e}function To(t,e,n,r){var i=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var c=e[s],l=r?r(n[c],t[c],c,n,t):o;l===o&&(l=t[c]),i?or(n,c,l):tr(n,c,l)}return n}function Ao(t,e){return function(n,r){var o=qs(n)?ye:nr,i=e?e():{};return o(n,t,ai(r,2),i)}}function No(t){return Ur((function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:o,a=i>2?n[2]:o;for(s=t.length>3&&"function"==typeof s?(i--,s):o,a&&yi(n[0],n[1],a)&&(s=i<3?o:s,i=1),e=_t(e);++r<i;){var c=n[r];c&&t(e,c,r,s)}return e}))}function Eo(t,e){return function(n,r){if(null==n)return n;if(!Ks(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=_t(n);(e?i--:++i<o)&&!1!==r(s[i],i,s););return n}}function Do(t){return function(e,n,r){for(var o=-1,i=_t(e),s=r(e),a=s.length;a--;){var c=s[t?a:++o];if(!1===n(i[c],c,i))break}return e}}function zo(t){return function(e){var n=Xe(e=ba(e))?sn(e):o,r=n?n[0]:e.charAt(0),i=n?wo(n,1).join(""):e.slice(1);return r[t]()+i}}function Ro(t){return function(e){return Ce(Xa(Wa(e).replace(Wt,"")),t,"")}}function Io(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Vn(t.prototype),r=t.apply(n,e);return ea(r)?r:n}}function Bo(t){return function(e,n,r){var i=_t(e);if(!Ks(e)){var s=ai(n,3);e=Ea(e),n=function(t){return s(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:o}}function Po(t){return ei((function(e){var n=e.length,r=n,s=Hn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new Ct(i);if(s&&!c&&"wrapper"==ii(a))var c=new Hn([],!0)}for(r=c?r:n;++r<n;){var l=ii(a=e[r]),u="wrapper"==l?oi(a):o;c=u&&wi(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?c[ii(u[0])].apply(c,u[3]):1==a.length&&wi(a)?c[l]():c.thru(a)}return function(){var t=arguments,r=t[0];if(c&&1==t.length&&qs(r))return c.plant(r).value();for(var o=0,i=n?e[o].apply(this,t):r;++o<n;)i=e[o].call(this,i);return i}}))}function jo(t,e,n,i,s,a,c,u,f,p){var h=e&l,d=1&e,m=2&e,v=24&e,g=512&e,y=m?o:Io(t);return function o(){for(var l=arguments.length,b=r(l),w=l;w--;)b[w]=arguments[w];if(v)var x=si(o),k=Ue(b,x);if(i&&(b=So(b,i,s,v)),a&&(b=Co(b,a,c,v)),l-=k,v&&l<p){var $=en(b,x);return Jo(t,e,jo,o.placeholder,n,b,$,u,f,p-l)}var _=d?n:this,M=m?_[t]:t;return l=b.length,u?b=Ci(b,u):g&&l>1&&b.reverse(),h&&f<l&&(b.length=f),this&&this!==ie&&this instanceof o&&(M=y||Io(M)),M.apply(_,b)}}function Vo(t,e){return function(n,r){return function(t,e,n,r){return br(t,(function(t,o,i){e(r,n(t),o,i)})),r}(n,t,e(r),{})}}function Lo(t,e){return function(n,r){var i;if(n===o&&r===o)return e;if(n!==o&&(i=n),r!==o){if(i===o)return r;"string"==typeof n||"string"==typeof r?(n=ao(n),r=ao(r)):(n=so(n),r=so(r)),i=t(n,r)}return i}}function Ho(t){return ei((function(e){return e=Me(e,Fe(ai())),Ur((function(n){var r=this;return t(e,(function(t){return ge(t,r,n)}))}))}))}function Fo(t,e){var n=(e=e===o?" ":ao(e)).length;if(n<2)return n?Kr(e,t):e;var r=Kr(e,un(t/on(e)));return Xe(e)?wo(sn(r),0,t).join(""):r.slice(0,t)}function Wo(t){return function(e,n,i){return i&&"number"!=typeof i&&yi(e,n,i)&&(n=i=o),e=da(e),n===o?(n=e,e=0):n=da(n),function(t,e,n,o){for(var i=-1,s=gn(un((e-t)/(n||1)),0),a=r(s);s--;)a[o?s:++i]=t,t+=n;return a}(e,n,i=i===o?e<n?1:-1:da(i),t)}}function qo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ga(e),n=ga(n)),t(e,n)}}function Jo(t,e,n,r,i,s,a,l,u,f){var p=8&e;e|=p?c:64,4&(e&=~(p?64:c))||(e&=-4);var h=[t,e,i,p?s:o,p?a:o,p?o:s,p?o:a,l,u,f],d=n.apply(o,h);return wi(t)&&Ti(d,h),d.placeholder=r,Ei(d,t,e)}function Ko(t){var e=$t[t];return function(t,n){if(t=ga(t),(n=null==n?0:yn(ma(n),292))&&dn(t)){var r=(ba(t)+"e").split("e");return+((r=(ba(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Uo=Sn&&1/nn(new Sn([,-0]))[1]==u?function(t){return new Sn(t)}:lc;function Yo(t){return function(e){var n=hi(e);return n==k?Qe(e):n==C?rn(e):function(t,e){return Me(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Go(t,e,n,s,u,f,p,h){var d=2&e;if(!d&&"function"!=typeof t)throw new Ct(i);var m=s?s.length:0;if(m||(e&=-97,s=u=o),p=p===o?p:gn(ma(p),0),h=h===o?h:ma(h),m-=u?u.length:0,64&e){var v=s,g=u;s=u=o}var y=d?o:oi(t),b=[t,e,n,s,u,v,g,f,p,h];if(y&&function(t,e){var n=t[1],r=e[1],o=n|r,i=o<131,s=r==l&&8==n||r==l&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!i&&!s)return t;1&r&&(t[2]=e[2],o|=1&n?0:4);var c=e[3];if(c){var u=t[3];t[3]=u?So(u,c,e[4]):c,t[4]=u?en(t[3],a):e[4]}(c=e[5])&&(u=t[5],t[5]=u?Co(u,c,e[6]):c,t[6]=u?en(t[5],a):e[6]),(c=e[7])&&(t[7]=c),r&l&&(t[8]=null==t[8]?e[8]:yn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o}(b,y),t=b[0],e=b[1],n=b[2],s=b[3],u=b[4],!(h=b[9]=b[9]===o?d?0:t.length:gn(b[9]-m,0))&&24&e&&(e&=-25),e&&1!=e)w=8==e||16==e?function(t,e,n){var i=Io(t);return function s(){for(var a=arguments.length,c=r(a),l=a,u=si(s);l--;)c[l]=arguments[l];var f=a<3&&c[0]!==u&&c[a-1]!==u?[]:en(c,u);return(a-=f.length)<n?Jo(t,e,jo,s.placeholder,o,c,f,o,o,n-a):ge(this&&this!==ie&&this instanceof s?i:t,this,c)}}(t,e,h):e!=c&&33!=e||u.length?jo.apply(o,b):function(t,e,n,o){var i=1&e,s=Io(t);return function e(){for(var a=-1,c=arguments.length,l=-1,u=o.length,f=r(u+c),p=this&&this!==ie&&this instanceof e?s:t;++l<u;)f[l]=o[l];for(;c--;)f[l++]=arguments[++a];return ge(p,i?n:this,f)}}(t,e,n,s);else var w=function(t,e,n){var r=1&e,o=Io(t);return function e(){return(this&&this!==ie&&this instanceof e?o:t).apply(r?n:this,arguments)}}(t,e,n);return Ei((y?Xr:Ti)(w,b),t,e)}function Zo(t,e,n,r){return t===o||Ls(t,At[n])&&!Dt.call(r,n)?e:t}function Xo(t,e,n,r,i,s){return ea(t)&&ea(e)&&(s.set(e,t),Vr(t,e,o,Xo,s),s.delete(e)),t}function Qo(t){return ia(t)?o:t}function ti(t,e,n,r,i,s){var a=1&n,c=t.length,l=e.length;if(c!=l&&!(a&&l>c))return!1;var u=s.get(t),f=s.get(e);if(u&&f)return u==e&&f==t;var p=-1,h=!0,d=2&n?new Kn:o;for(s.set(t,e),s.set(e,t);++p<c;){var m=t[p],v=e[p];if(r)var g=a?r(v,m,p,e,t,s):r(m,v,p,t,e,s);if(g!==o){if(g)continue;h=!1;break}if(d){if(!Te(e,(function(t,e){if(!qe(d,e)&&(m===t||i(m,t,n,r,s)))return d.push(e)}))){h=!1;break}}else if(m!==v&&!i(m,v,n,r,s)){h=!1;break}}return s.delete(t),s.delete(e),h}function ei(t){return Ni(Mi(t,o,Ji),t+"")}function ni(t){return $r(t,Ea,fi)}function ri(t){return $r(t,Da,pi)}var oi=Tn?function(t){return Tn.get(t)}:lc;function ii(t){for(var e=t.name+"",n=An[e],r=Dt.call(An,e)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==t)return o.name}return e}function si(t){return(Dt.call(jn,"placeholder")?jn:t).placeholder}function ai(){var t=jn.iteratee||ic;return t=t===ic?zr:t,arguments.length?t(arguments[0],arguments[1]):t}function ci(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function li(t){for(var e=Ea(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,$i(o)]}return e}function ui(t,e){var n=function(t,e){return null==t?o:t[e]}(t,e);return Dr(n)?n:o}var fi=pn?function(t){return null==t?[]:(t=_t(t),ke(pn(t),(function(e){return te.call(t,e)})))}:vc,pi=pn?function(t){for(var e=[];t;)Se(e,fi(t)),t=Jt(t);return e}:vc,hi=_r;function di(t,e,n){for(var r=-1,o=(e=yo(e,t)).length,i=!1;++r<o;){var s=Pi(e[r]);if(!(i=null!=t&&n(t,s)))break;t=t[s]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&ta(o)&&gi(s,o)&&(qs(t)||Ws(t))}function mi(t){return"function"!=typeof t.constructor||ki(t)?{}:Vn(Jt(t))}function vi(t){return qs(t)||Ws(t)||!!(oe&&t&&t[oe])}function gi(t,e){var n=typeof t;return!!(e=null==e?f:e)&&("number"==n||"symbol"!=n&&gt.test(t))&&t>-1&&t%1==0&&t<e}function yi(t,e,n){if(!ea(n))return!1;var r=typeof e;return!!("number"==r?Ks(n)&&gi(e,n.length):"string"==r&&e in n)&&Ls(n[e],t)}function bi(t,e){if(qs(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!la(t))||Q.test(t)||!X.test(t)||null!=e&&t in _t(e)}function wi(t){var e=ii(t),n=jn[e];if("function"!=typeof n||!(e in Fn.prototype))return!1;if(t===n)return!0;var r=oi(n);return!!r&&t===r[0]}($n&&hi(new $n(new ArrayBuffer(1)))!=E||_n&&hi(new _n)!=k||Mn&&hi(Mn.resolve())!=M||Sn&&hi(new Sn)!=C||Cn&&hi(new Cn)!=A)&&(hi=function(t){var e=_r(t),n=e==_?t.constructor:o,r=n?ji(n):"";if(r)switch(r){case Nn:return E;case En:return k;case Dn:return M;case zn:return C;case Rn:return A}return e});var xi=Nt?Xs:gc;function ki(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||At)}function $i(t){return t==t&&!ea(t)}function _i(t,e){return function(n){return null!=n&&n[t]===e&&(e!==o||t in _t(n))}}function Mi(t,e,n){return e=gn(e===o?t.length-1:e,0),function(){for(var o=arguments,i=-1,s=gn(o.length-e,0),a=r(s);++i<s;)a[i]=o[e+i];i=-1;for(var c=r(e+1);++i<e;)c[i]=o[i];return c[e]=n(a),ge(t,this,c)}}function Si(t,e){return e.length<2?t:kr(t,eo(e,0,-1))}function Ci(t,e){for(var n=t.length,r=yn(e.length,n),i=Oo(t);r--;){var s=e[r];t[r]=gi(s,n)?i[s]:o}return t}function Oi(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ti=Di(Xr),Ai=Pe||function(t,e){return ie.setTimeout(t,e)},Ni=Di(Qr);function Ei(t,e,n){var r=e+"";return Ni(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(it,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return be(d,(function(n){var r="_."+n[0];e&n[1]&&!$e(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(st);return e?e[1].split(at):[]}(r),n)))}function Di(t){var e=0,n=0;return function(){var r=bn(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(o,arguments)}}function zi(t,e){var n=-1,r=t.length,i=r-1;for(e=e===o?r:e;++n<e;){var s=Jr(n,i),a=t[s];t[s]=t[n],t[n]=a}return t.length=e,t}var Ri,Ii,Bi=(Ri=Rs((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,r,o){e.push(r?o.replace(ut,"$1"):n||t)})),e}),(function(t){return 500===Ii.size&&Ii.clear(),t})),Ii=Ri.cache,Ri);function Pi(t){if("string"==typeof t||la(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ji(t){if(null!=t){try{return Et.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Vi(t){if(t instanceof Fn)return t.clone();var e=new Hn(t.__wrapped__,t.__chain__);return e.__actions__=Oo(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Li=Ur((function(t,e){return Us(t)?ur(t,vr(e,1,Us,!0)):[]})),Hi=Ur((function(t,e){var n=Zi(e);return Us(n)&&(n=o),Us(t)?ur(t,vr(e,1,Us,!0),ai(n,2)):[]})),Fi=Ur((function(t,e){var n=Zi(e);return Us(n)&&(n=o),Us(t)?ur(t,vr(e,1,Us,!0),o,n):[]}));function Wi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ma(n);return o<0&&(o=gn(r+o,0)),Ee(t,ai(e,3),o)}function qi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==o&&(i=ma(n),i=n<0?gn(r+i,0):yn(i,r-1)),Ee(t,ai(e,3),i,!0)}function Ji(t){return null!=t&&t.length?vr(t,1):[]}function Ki(t){return t&&t.length?t[0]:o}var Ui=Ur((function(t){var e=Me(t,vo);return e.length&&e[0]===t[0]?Or(e):[]})),Yi=Ur((function(t){var e=Zi(t),n=Me(t,vo);return e===Zi(n)?e=o:n.pop(),n.length&&n[0]===t[0]?Or(n,ai(e,2)):[]})),Gi=Ur((function(t){var e=Zi(t),n=Me(t,vo);return(e="function"==typeof e?e:o)&&n.pop(),n.length&&n[0]===t[0]?Or(n,o,e):[]}));function Zi(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Xi=Ur(Qi);function Qi(t,e){return t&&t.length&&e&&e.length?Wr(t,e):t}var ts=ei((function(t,e){var n=null==t?0:t.length,r=ir(t,e);return qr(t,Me(e,(function(t){return gi(t,n)?+t:t})).sort(Mo)),r}));function es(t){return null==t?t:kn.call(t)}var ns=Ur((function(t){return co(vr(t,1,Us,!0))})),rs=Ur((function(t){var e=Zi(t);return Us(e)&&(e=o),co(vr(t,1,Us,!0),ai(e,2))})),os=Ur((function(t){var e=Zi(t);return e="function"==typeof e?e:o,co(vr(t,1,Us,!0),o,e)}));function is(t){if(!t||!t.length)return[];var e=0;return t=ke(t,(function(t){if(Us(t))return e=gn(t.length,e),!0})),Le(e,(function(e){return Me(t,Be(e))}))}function ss(t,e){if(!t||!t.length)return[];var n=is(t);return null==e?n:Me(n,(function(t){return ge(e,o,t)}))}var as=Ur((function(t,e){return Us(t)?ur(t,e):[]})),cs=Ur((function(t){return ho(ke(t,Us))})),ls=Ur((function(t){var e=Zi(t);return Us(e)&&(e=o),ho(ke(t,Us),ai(e,2))})),us=Ur((function(t){var e=Zi(t);return e="function"==typeof e?e:o,ho(ke(t,Us),o,e)})),fs=Ur(is),ps=Ur((function(t){var e=t.length,n=e>1?t[e-1]:o;return n="function"==typeof n?(t.pop(),n):o,ss(t,n)}));function hs(t){var e=jn(t);return e.__chain__=!0,e}function ds(t,e){return e(t)}var ms=ei((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return ir(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Fn&&gi(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:ds,args:[i],thisArg:o}),new Hn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(o),t}))):this.thru(i)})),vs=Ao((function(t,e,n){Dt.call(t,n)?++t[n]:or(t,n,1)})),gs=Bo(Wi),ys=Bo(qi);function bs(t,e){return(qs(t)?be:fr)(t,ai(e,3))}function ws(t,e){return(qs(t)?we:pr)(t,ai(e,3))}var xs=Ao((function(t,e,n){Dt.call(t,n)?t[n].push(e):or(t,n,[e])})),ks=Ur((function(t,e,n){var o=-1,i="function"==typeof e,s=Ks(t)?r(t.length):[];return fr(t,(function(t){s[++o]=i?ge(e,t,n):Tr(t,e,n)})),s})),$s=Ao((function(t,e,n){or(t,n,e)}));function _s(t,e){return(qs(t)?Me:Br)(t,ai(e,3))}var Ms=Ao((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Ss=Ur((function(t,e){if(null==t)return[];var n=e.length;return n>1&&yi(t,e[0],e[1])?e=[]:n>2&&yi(e[0],e[1],e[2])&&(e=[e[0]]),Hr(t,vr(e,1),[])})),Cs=Ae||function(){return ie.Date.now()};function Os(t,e,n){return e=n?o:e,e=t&&null==e?t.length:e,Go(t,l,o,o,o,o,e)}function Ts(t,e){var n;if("function"!=typeof e)throw new Ct(i);return t=ma(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var As=Ur((function(t,e,n){var r=1;if(n.length){var o=en(n,si(As));r|=c}return Go(t,r,e,n,o)})),Ns=Ur((function(t,e,n){var r=3;if(n.length){var o=en(n,si(Ns));r|=c}return Go(e,r,t,n,o)}));function Es(t,e,n){var r,s,a,c,l,u,f=0,p=!1,h=!1,d=!0;if("function"!=typeof t)throw new Ct(i);function m(e){var n=r,i=s;return r=s=o,f=e,c=t.apply(i,n)}function v(t){return f=t,l=Ai(y,e),p?m(t):c}function g(t){var n=t-u;return u===o||n>=e||n<0||h&&t-f>=a}function y(){var t=Cs();if(g(t))return b(t);l=Ai(y,function(t){var n=e-(t-u);return h?yn(n,a-(t-f)):n}(t))}function b(t){return l=o,d&&r?m(t):(r=s=o,c)}function w(){var t=Cs(),n=g(t);if(r=arguments,s=this,u=t,n){if(l===o)return v(u);if(h)return xo(l),l=Ai(y,e),m(u)}return l===o&&(l=Ai(y,e)),c}return e=ga(e)||0,ea(n)&&(p=!!n.leading,a=(h="maxWait"in n)?gn(ga(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d),w.cancel=function(){l!==o&&xo(l),f=0,r=u=s=l=o},w.flush=function(){return l===o?c:b(Cs())},w}var Ds=Ur((function(t,e){return lr(t,1,e)})),zs=Ur((function(t,e,n){return lr(t,ga(e)||0,n)}));function Rs(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ct(i);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(Rs.Cache||Jn),n}function Is(t){if("function"!=typeof t)throw new Ct(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Rs.Cache=Jn;var Bs=bo((function(t,e){var n=(e=1==e.length&&qs(e[0])?Me(e[0],Fe(ai())):Me(vr(e,1),Fe(ai()))).length;return Ur((function(r){for(var o=-1,i=yn(r.length,n);++o<i;)r[o]=e[o].call(this,r[o]);return ge(t,this,r)}))})),Ps=Ur((function(t,e){var n=en(e,si(Ps));return Go(t,c,o,e,n)})),js=Ur((function(t,e){var n=en(e,si(js));return Go(t,64,o,e,n)})),Vs=ei((function(t,e){return Go(t,256,o,o,o,e)}));function Ls(t,e){return t===e||t!=t&&e!=e}var Hs=qo(Mr),Fs=qo((function(t,e){return t>=e})),Ws=Ar(function(){return arguments}())?Ar:function(t){return na(t)&&Dt.call(t,"callee")&&!te.call(t,"callee")},qs=r.isArray,Js=fe?Fe(fe):function(t){return na(t)&&_r(t)==N};function Ks(t){return null!=t&&ta(t.length)&&!Xs(t)}function Us(t){return na(t)&&Ks(t)}var Ys=hn||gc,Gs=pe?Fe(pe):function(t){return na(t)&&_r(t)==y};function Zs(t){if(!na(t))return!1;var e=_r(t);return e==b||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ia(t)}function Xs(t){if(!ea(t))return!1;var e=_r(t);return e==w||e==x||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qs(t){return"number"==typeof t&&t==ma(t)}function ta(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=f}function ea(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function na(t){return null!=t&&"object"==typeof t}var ra=he?Fe(he):function(t){return na(t)&&hi(t)==k};function oa(t){return"number"==typeof t||na(t)&&_r(t)==$}function ia(t){if(!na(t)||_r(t)!=_)return!1;var e=Jt(t);if(null===e)return!0;var n=Dt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Et.call(n)==Bt}var sa=de?Fe(de):function(t){return na(t)&&_r(t)==S},aa=me?Fe(me):function(t){return na(t)&&hi(t)==C};function ca(t){return"string"==typeof t||!qs(t)&&na(t)&&_r(t)==O}function la(t){return"symbol"==typeof t||na(t)&&_r(t)==T}var ua=ve?Fe(ve):function(t){return na(t)&&ta(t.length)&&!!Xt[_r(t)]},fa=qo(Ir),pa=qo((function(t,e){return t<=e}));function ha(t){if(!t)return[];if(Ks(t))return ca(t)?sn(t):Oo(t);if(se&&t[se])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[se]());var e=hi(t);return(e==k?Qe:e==C?nn:La)(t)}function da(t){return t?(t=ga(t))===u||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ma(t){var e=da(t),n=e%1;return e==e?n?e-n:e:0}function va(t){return t?sr(ma(t),0,h):0}function ga(t){if("number"==typeof t)return t;if(la(t))return p;if(ea(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ea(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=He(t);var n=dt.test(t);return n||vt.test(t)?ne(t.slice(2),n?2:8):ht.test(t)?p:+t}function ya(t){return To(t,Da(t))}function ba(t){return null==t?"":ao(t)}var wa=No((function(t,e){if(ki(e)||Ks(e))To(e,Ea(e),t);else for(var n in e)Dt.call(e,n)&&tr(t,n,e[n])})),xa=No((function(t,e){To(e,Da(e),t)})),ka=No((function(t,e,n,r){To(e,Da(e),t,r)})),$a=No((function(t,e,n,r){To(e,Ea(e),t,r)})),_a=ei(ir),Ma=Ur((function(t,e){t=_t(t);var n=-1,r=e.length,i=r>2?e[2]:o;for(i&&yi(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],a=Da(s),c=-1,l=a.length;++c<l;){var u=a[c],f=t[u];(f===o||Ls(f,At[u])&&!Dt.call(t,u))&&(t[u]=s[u])}return t})),Sa=Ur((function(t){return t.push(o,Xo),ge(Ra,o,t)}));function Ca(t,e,n){var r=null==t?o:kr(t,e);return r===o?n:r}function Oa(t,e){return null!=t&&di(t,e,Cr)}var Ta=Vo((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=It.call(e)),t[e]=n}),ec(oc)),Aa=Vo((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=It.call(e)),Dt.call(t,e)?t[e].push(n):t[e]=[n]}),ai),Na=Ur(Tr);function Ea(t){return Ks(t)?Yn(t):Rr(t)}function Da(t){return Ks(t)?Yn(t,!0):function(t){if(!ea(t))return function(t){var e=[];if(null!=t)for(var n in _t(t))e.push(n);return e}(t);var e=ki(t),n=[];for(var r in t)("constructor"!=r||!e&&Dt.call(t,r))&&n.push(r);return n}(t)}var za=No((function(t,e,n){Vr(t,e,n)})),Ra=No((function(t,e,n,r){Vr(t,e,n,r)})),Ia=ei((function(t,e){var n={};if(null==t)return n;var r=!1;e=Me(e,(function(e){return e=yo(e,t),r||(r=e.length>1),e})),To(t,ri(t),n),r&&(n=ar(n,7,Qo));for(var o=e.length;o--;)lo(n,e[o]);return n})),Ba=ei((function(t,e){return null==t?{}:function(t,e){return Fr(t,e,(function(e,n){return Oa(t,n)}))}(t,e)}));function Pa(t,e){if(null==t)return{};var n=Me(ri(t),(function(t){return[t]}));return e=ai(e),Fr(t,n,(function(t,n){return e(t,n[0])}))}var ja=Yo(Ea),Va=Yo(Da);function La(t){return null==t?[]:We(t,Ea(t))}var Ha=Ro((function(t,e,n){return e=e.toLowerCase(),t+(n?Fa(e):e)}));function Fa(t){return Za(ba(t).toLowerCase())}function Wa(t){return(t=ba(t))&&t.replace(yt,Ye).replace(qt,"")}var qa=Ro((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ja=Ro((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Ka=zo("toLowerCase"),Ua=Ro((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Ya=Ro((function(t,e,n){return t+(n?" ":"")+Za(e)})),Ga=Ro((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Za=zo("toUpperCase");function Xa(t,e,n){return t=ba(t),(e=n?o:e)===o?function(t){return Yt.test(t)}(t)?function(t){return t.match(Kt)||[]}(t):function(t){return t.match(ct)||[]}(t):t.match(e)||[]}var Qa=Ur((function(t,e){try{return ge(t,o,e)}catch(t){return Zs(t)?t:new xt(t)}})),tc=ei((function(t,e){return be(e,(function(e){e=Pi(e),or(t,e,As(t[e],t))})),t}));function ec(t){return function(){return t}}var nc=Po(),rc=Po(!0);function oc(t){return t}function ic(t){return zr("function"==typeof t?t:ar(t,1))}var sc=Ur((function(t,e){return function(n){return Tr(n,t,e)}})),ac=Ur((function(t,e){return function(n){return Tr(t,n,e)}}));function cc(t,e,n){var r=Ea(e),o=xr(e,r);null!=n||ea(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=xr(e,Ea(e)));var i=!(ea(n)&&"chain"in n&&!n.chain),s=Xs(t);return be(o,(function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),o=n.__actions__=Oo(this.__actions__);return o.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Se([this.value()],arguments))})})),t}function lc(){}var uc=Ho(Me),fc=Ho(xe),pc=Ho(Te);function hc(t){return bi(t)?Be(Pi(t)):function(t){return function(e){return kr(e,t)}}(t)}var dc=Wo(),mc=Wo(!0);function vc(){return[]}function gc(){return!1}var yc,bc=Lo((function(t,e){return t+e}),0),wc=Ko("ceil"),xc=Lo((function(t,e){return t/e}),1),kc=Ko("floor"),$c=Lo((function(t,e){return t*e}),1),_c=Ko("round"),Mc=Lo((function(t,e){return t-e}),0);return jn.after=function(t,e){if("function"!=typeof e)throw new Ct(i);return t=ma(t),function(){if(--t<1)return e.apply(this,arguments)}},jn.ary=Os,jn.assign=wa,jn.assignIn=xa,jn.assignInWith=ka,jn.assignWith=$a,jn.at=_a,jn.before=Ts,jn.bind=As,jn.bindAll=tc,jn.bindKey=Ns,jn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return qs(t)?t:[t]},jn.chain=hs,jn.chunk=function(t,e,n){e=(n?yi(t,e,n):e===o)?1:gn(ma(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var s=0,a=0,c=r(un(i/e));s<i;)c[a++]=eo(t,s,s+=e);return c},jn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,o=[];++e<n;){var i=t[e];i&&(o[r++]=i)}return o},jn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return Se(qs(n)?Oo(n):[n],vr(e,1))},jn.cond=function(t){var e=null==t?0:t.length,n=ai();return t=e?Me(t,(function(t){if("function"!=typeof t[1])throw new Ct(i);return[n(t[0]),t[1]]})):[],Ur((function(n){for(var r=-1;++r<e;){var o=t[r];if(ge(o[0],this,n))return ge(o[1],this,n)}}))},jn.conforms=function(t){return function(t){var e=Ea(t);return function(n){return cr(n,t,e)}}(ar(t,1))},jn.constant=ec,jn.countBy=vs,jn.create=function(t,e){var n=Vn(t);return null==e?n:rr(n,e)},jn.curry=function t(e,n,r){var i=Go(e,8,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},jn.curryRight=function t(e,n,r){var i=Go(e,16,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},jn.debounce=Es,jn.defaults=Ma,jn.defaultsDeep=Sa,jn.defer=Ds,jn.delay=zs,jn.difference=Li,jn.differenceBy=Hi,jn.differenceWith=Fi,jn.drop=function(t,e,n){var r=null==t?0:t.length;return r?eo(t,(e=n||e===o?1:ma(e))<0?0:e,r):[]},jn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?eo(t,0,(e=r-(e=n||e===o?1:ma(e)))<0?0:e):[]},jn.dropRightWhile=function(t,e){return t&&t.length?fo(t,ai(e,3),!0,!0):[]},jn.dropWhile=function(t,e){return t&&t.length?fo(t,ai(e,3),!0):[]},jn.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&yi(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=ma(n))<0&&(n=-n>i?0:i+n),(r=r===o||r>i?i:ma(r))<0&&(r+=i),r=n>r?0:va(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},jn.filter=function(t,e){return(qs(t)?ke:mr)(t,ai(e,3))},jn.flatMap=function(t,e){return vr(_s(t,e),1)},jn.flatMapDeep=function(t,e){return vr(_s(t,e),u)},jn.flatMapDepth=function(t,e,n){return n=n===o?1:ma(n),vr(_s(t,e),n)},jn.flatten=Ji,jn.flattenDeep=function(t){return null!=t&&t.length?vr(t,u):[]},jn.flattenDepth=function(t,e){return null!=t&&t.length?vr(t,e=e===o?1:ma(e)):[]},jn.flip=function(t){return Go(t,512)},jn.flow=nc,jn.flowRight=rc,jn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var o=t[e];r[o[0]]=o[1]}return r},jn.functions=function(t){return null==t?[]:xr(t,Ea(t))},jn.functionsIn=function(t){return null==t?[]:xr(t,Da(t))},jn.groupBy=xs,jn.initial=function(t){return null!=t&&t.length?eo(t,0,-1):[]},jn.intersection=Ui,jn.intersectionBy=Yi,jn.intersectionWith=Gi,jn.invert=Ta,jn.invertBy=Aa,jn.invokeMap=ks,jn.iteratee=ic,jn.keyBy=$s,jn.keys=Ea,jn.keysIn=Da,jn.map=_s,jn.mapKeys=function(t,e){var n={};return e=ai(e,3),br(t,(function(t,r,o){or(n,e(t,r,o),t)})),n},jn.mapValues=function(t,e){var n={};return e=ai(e,3),br(t,(function(t,r,o){or(n,r,e(t,r,o))})),n},jn.matches=function(t){return Pr(ar(t,1))},jn.matchesProperty=function(t,e){return jr(t,ar(e,1))},jn.memoize=Rs,jn.merge=za,jn.mergeWith=Ra,jn.method=sc,jn.methodOf=ac,jn.mixin=cc,jn.negate=Is,jn.nthArg=function(t){return t=ma(t),Ur((function(e){return Lr(e,t)}))},jn.omit=Ia,jn.omitBy=function(t,e){return Pa(t,Is(ai(e)))},jn.once=function(t){return Ts(2,t)},jn.orderBy=function(t,e,n,r){return null==t?[]:(qs(e)||(e=null==e?[]:[e]),qs(n=r?o:n)||(n=null==n?[]:[n]),Hr(t,e,n))},jn.over=uc,jn.overArgs=Bs,jn.overEvery=fc,jn.overSome=pc,jn.partial=Ps,jn.partialRight=js,jn.partition=Ms,jn.pick=Ba,jn.pickBy=Pa,jn.property=hc,jn.propertyOf=function(t){return function(e){return null==t?o:kr(t,e)}},jn.pull=Xi,jn.pullAll=Qi,jn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Wr(t,e,ai(n,2)):t},jn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Wr(t,e,o,n):t},jn.pullAt=ts,jn.range=dc,jn.rangeRight=mc,jn.rearg=Vs,jn.reject=function(t,e){return(qs(t)?ke:mr)(t,Is(ai(e,3)))},jn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],i=t.length;for(e=ai(e,3);++r<i;){var s=t[r];e(s,r,t)&&(n.push(s),o.push(r))}return qr(t,o),n},jn.rest=function(t,e){if("function"!=typeof t)throw new Ct(i);return Ur(t,e=e===o?e:ma(e))},jn.reverse=es,jn.sampleSize=function(t,e,n){return e=(n?yi(t,e,n):e===o)?1:ma(e),(qs(t)?Zn:Gr)(t,e)},jn.set=function(t,e,n){return null==t?t:Zr(t,e,n)},jn.setWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:Zr(t,e,n,r)},jn.shuffle=function(t){return(qs(t)?Xn:to)(t)},jn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&yi(t,e,n)?(e=0,n=r):(e=null==e?0:ma(e),n=n===o?r:ma(n)),eo(t,e,n)):[]},jn.sortBy=Ss,jn.sortedUniq=function(t){return t&&t.length?io(t):[]},jn.sortedUniqBy=function(t,e){return t&&t.length?io(t,ai(e,2)):[]},jn.split=function(t,e,n){return n&&"number"!=typeof n&&yi(t,e,n)&&(e=n=o),(n=n===o?h:n>>>0)?(t=ba(t))&&("string"==typeof e||null!=e&&!sa(e))&&!(e=ao(e))&&Xe(t)?wo(sn(t),0,n):t.split(e,n):[]},jn.spread=function(t,e){if("function"!=typeof t)throw new Ct(i);return e=null==e?0:gn(ma(e),0),Ur((function(n){var r=n[e],o=wo(n,0,e);return r&&Se(o,r),ge(t,this,o)}))},jn.tail=function(t){var e=null==t?0:t.length;return e?eo(t,1,e):[]},jn.take=function(t,e,n){return t&&t.length?eo(t,0,(e=n||e===o?1:ma(e))<0?0:e):[]},jn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?eo(t,(e=r-(e=n||e===o?1:ma(e)))<0?0:e,r):[]},jn.takeRightWhile=function(t,e){return t&&t.length?fo(t,ai(e,3),!1,!0):[]},jn.takeWhile=function(t,e){return t&&t.length?fo(t,ai(e,3)):[]},jn.tap=function(t,e){return e(t),t},jn.throttle=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new Ct(i);return ea(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Es(t,e,{leading:r,maxWait:e,trailing:o})},jn.thru=ds,jn.toArray=ha,jn.toPairs=ja,jn.toPairsIn=Va,jn.toPath=function(t){return qs(t)?Me(t,Pi):la(t)?[t]:Oo(Bi(ba(t)))},jn.toPlainObject=ya,jn.transform=function(t,e,n){var r=qs(t),o=r||Ys(t)||ua(t);if(e=ai(e,4),null==n){var i=t&&t.constructor;n=o?r?new i:[]:ea(t)&&Xs(i)?Vn(Jt(t)):{}}return(o?be:br)(t,(function(t,r,o){return e(n,t,r,o)})),n},jn.unary=function(t){return Os(t,1)},jn.union=ns,jn.unionBy=rs,jn.unionWith=os,jn.uniq=function(t){return t&&t.length?co(t):[]},jn.uniqBy=function(t,e){return t&&t.length?co(t,ai(e,2)):[]},jn.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?co(t,o,e):[]},jn.unset=function(t,e){return null==t||lo(t,e)},jn.unzip=is,jn.unzipWith=ss,jn.update=function(t,e,n){return null==t?t:uo(t,e,go(n))},jn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:uo(t,e,go(n),r)},jn.values=La,jn.valuesIn=function(t){return null==t?[]:We(t,Da(t))},jn.without=as,jn.words=Xa,jn.wrap=function(t,e){return Ps(go(e),t)},jn.xor=cs,jn.xorBy=ls,jn.xorWith=us,jn.zip=fs,jn.zipObject=function(t,e){return mo(t||[],e||[],tr)},jn.zipObjectDeep=function(t,e){return mo(t||[],e||[],Zr)},jn.zipWith=ps,jn.entries=ja,jn.entriesIn=Va,jn.extend=xa,jn.extendWith=ka,cc(jn,jn),jn.add=bc,jn.attempt=Qa,jn.camelCase=Ha,jn.capitalize=Fa,jn.ceil=wc,jn.clamp=function(t,e,n){return n===o&&(n=e,e=o),n!==o&&(n=(n=ga(n))==n?n:0),e!==o&&(e=(e=ga(e))==e?e:0),sr(ga(t),e,n)},jn.clone=function(t){return ar(t,4)},jn.cloneDeep=function(t){return ar(t,5)},jn.cloneDeepWith=function(t,e){return ar(t,5,e="function"==typeof e?e:o)},jn.cloneWith=function(t,e){return ar(t,4,e="function"==typeof e?e:o)},jn.conformsTo=function(t,e){return null==e||cr(t,e,Ea(e))},jn.deburr=Wa,jn.defaultTo=function(t,e){return null==t||t!=t?e:t},jn.divide=xc,jn.endsWith=function(t,e,n){t=ba(t),e=ao(e);var r=t.length,i=n=n===o?r:sr(ma(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},jn.eq=Ls,jn.escape=function(t){return(t=ba(t))&&U.test(t)?t.replace(J,Ge):t},jn.escapeRegExp=function(t){return(t=ba(t))&&nt.test(t)?t.replace(et,"\\$&"):t},jn.every=function(t,e,n){var r=qs(t)?xe:hr;return n&&yi(t,e,n)&&(e=o),r(t,ai(e,3))},jn.find=gs,jn.findIndex=Wi,jn.findKey=function(t,e){return Ne(t,ai(e,3),br)},jn.findLast=ys,jn.findLastIndex=qi,jn.findLastKey=function(t,e){return Ne(t,ai(e,3),wr)},jn.floor=kc,jn.forEach=bs,jn.forEachRight=ws,jn.forIn=function(t,e){return null==t?t:gr(t,ai(e,3),Da)},jn.forInRight=function(t,e){return null==t?t:yr(t,ai(e,3),Da)},jn.forOwn=function(t,e){return t&&br(t,ai(e,3))},jn.forOwnRight=function(t,e){return t&&wr(t,ai(e,3))},jn.get=Ca,jn.gt=Hs,jn.gte=Fs,jn.has=function(t,e){return null!=t&&di(t,e,Sr)},jn.hasIn=Oa,jn.head=Ki,jn.identity=oc,jn.includes=function(t,e,n,r){t=Ks(t)?t:La(t),n=n&&!r?ma(n):0;var o=t.length;return n<0&&(n=gn(o+n,0)),ca(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&De(t,e,n)>-1},jn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ma(n);return o<0&&(o=gn(r+o,0)),De(t,e,o)},jn.inRange=function(t,e,n){return e=da(e),n===o?(n=e,e=0):n=da(n),function(t,e,n){return t>=yn(e,n)&&t<gn(e,n)}(t=ga(t),e,n)},jn.invoke=Na,jn.isArguments=Ws,jn.isArray=qs,jn.isArrayBuffer=Js,jn.isArrayLike=Ks,jn.isArrayLikeObject=Us,jn.isBoolean=function(t){return!0===t||!1===t||na(t)&&_r(t)==g},jn.isBuffer=Ys,jn.isDate=Gs,jn.isElement=function(t){return na(t)&&1===t.nodeType&&!ia(t)},jn.isEmpty=function(t){if(null==t)return!0;if(Ks(t)&&(qs(t)||"string"==typeof t||"function"==typeof t.splice||Ys(t)||ua(t)||Ws(t)))return!t.length;var e=hi(t);if(e==k||e==C)return!t.size;if(ki(t))return!Rr(t).length;for(var n in t)if(Dt.call(t,n))return!1;return!0},jn.isEqual=function(t,e){return Nr(t,e)},jn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:o)?n(t,e):o;return r===o?Nr(t,e,o,n):!!r},jn.isError=Zs,jn.isFinite=function(t){return"number"==typeof t&&dn(t)},jn.isFunction=Xs,jn.isInteger=Qs,jn.isLength=ta,jn.isMap=ra,jn.isMatch=function(t,e){return t===e||Er(t,e,li(e))},jn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:o,Er(t,e,li(e),n)},jn.isNaN=function(t){return oa(t)&&t!=+t},jn.isNative=function(t){if(xi(t))throw new xt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Dr(t)},jn.isNil=function(t){return null==t},jn.isNull=function(t){return null===t},jn.isNumber=oa,jn.isObject=ea,jn.isObjectLike=na,jn.isPlainObject=ia,jn.isRegExp=sa,jn.isSafeInteger=function(t){return Qs(t)&&t>=-9007199254740991&&t<=f},jn.isSet=aa,jn.isString=ca,jn.isSymbol=la,jn.isTypedArray=ua,jn.isUndefined=function(t){return t===o},jn.isWeakMap=function(t){return na(t)&&hi(t)==A},jn.isWeakSet=function(t){return na(t)&&"[object WeakSet]"==_r(t)},jn.join=function(t,e){return null==t?"":mn.call(t,e)},jn.kebabCase=qa,jn.last=Zi,jn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==o&&(i=(i=ma(n))<0?gn(r+i,0):yn(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):Ee(t,Re,i,!0)},jn.lowerCase=Ja,jn.lowerFirst=Ka,jn.lt=fa,jn.lte=pa,jn.max=function(t){return t&&t.length?dr(t,oc,Mr):o},jn.maxBy=function(t,e){return t&&t.length?dr(t,ai(e,2),Mr):o},jn.mean=function(t){return Ie(t,oc)},jn.meanBy=function(t,e){return Ie(t,ai(e,2))},jn.min=function(t){return t&&t.length?dr(t,oc,Ir):o},jn.minBy=function(t,e){return t&&t.length?dr(t,ai(e,2),Ir):o},jn.stubArray=vc,jn.stubFalse=gc,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=$c,jn.nth=function(t,e){return t&&t.length?Lr(t,ma(e)):o},jn.noConflict=function(){return ie._===this&&(ie._=Pt),this},jn.noop=lc,jn.now=Cs,jn.pad=function(t,e,n){t=ba(t);var r=(e=ma(e))?on(t):0;if(!e||r>=e)return t;var o=(e-r)/2;return Fo(fn(o),n)+t+Fo(un(o),n)},jn.padEnd=function(t,e,n){t=ba(t);var r=(e=ma(e))?on(t):0;return e&&r<e?t+Fo(e-r,n):t},jn.padStart=function(t,e,n){t=ba(t);var r=(e=ma(e))?on(t):0;return e&&r<e?Fo(e-r,n)+t:t},jn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),wn(ba(t).replace(rt,""),e||0)},jn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&yi(t,e,n)&&(e=n=o),n===o&&("boolean"==typeof e?(n=e,e=o):"boolean"==typeof t&&(n=t,t=o)),t===o&&e===o?(t=0,e=1):(t=da(t),e===o?(e=t,t=0):e=da(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=xn();return yn(t+i*(e-t+ee("1e-"+((i+"").length-1))),e)}return Jr(t,e)},jn.reduce=function(t,e,n){var r=qs(t)?Ce:je,o=arguments.length<3;return r(t,ai(e,4),n,o,fr)},jn.reduceRight=function(t,e,n){var r=qs(t)?Oe:je,o=arguments.length<3;return r(t,ai(e,4),n,o,pr)},jn.repeat=function(t,e,n){return e=(n?yi(t,e,n):e===o)?1:ma(e),Kr(ba(t),e)},jn.replace=function(){var t=arguments,e=ba(t[0]);return t.length<3?e:e.replace(t[1],t[2])},jn.result=function(t,e,n){var r=-1,i=(e=yo(e,t)).length;for(i||(i=1,t=o);++r<i;){var s=null==t?o:t[Pi(e[r])];s===o&&(r=i,s=n),t=Xs(s)?s.call(t):s}return t},jn.round=_c,jn.runInContext=t,jn.sample=function(t){return(qs(t)?Gn:Yr)(t)},jn.size=function(t){if(null==t)return 0;if(Ks(t))return ca(t)?on(t):t.length;var e=hi(t);return e==k||e==C?t.size:Rr(t).length},jn.snakeCase=Ua,jn.some=function(t,e,n){var r=qs(t)?Te:no;return n&&yi(t,e,n)&&(e=o),r(t,ai(e,3))},jn.sortedIndex=function(t,e){return ro(t,e)},jn.sortedIndexBy=function(t,e,n){return oo(t,e,ai(n,2))},jn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ro(t,e);if(r<n&&Ls(t[r],e))return r}return-1},jn.sortedLastIndex=function(t,e){return ro(t,e,!0)},jn.sortedLastIndexBy=function(t,e,n){return oo(t,e,ai(n,2),!0)},jn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ro(t,e,!0)-1;if(Ls(t[n],e))return n}return-1},jn.startCase=Ya,jn.startsWith=function(t,e,n){return t=ba(t),n=null==n?0:sr(ma(n),0,t.length),e=ao(e),t.slice(n,n+e.length)==e},jn.subtract=Mc,jn.sum=function(t){return t&&t.length?Ve(t,oc):0},jn.sumBy=function(t,e){return t&&t.length?Ve(t,ai(e,2)):0},jn.template=function(t,e,n){var r=jn.templateSettings;n&&yi(t,e,n)&&(e=o),t=ba(t),e=ka({},e,r,Zo);var i,s,a=ka({},e.imports,r.imports,Zo),c=Ea(a),l=We(a,c),u=0,f=e.interpolate||bt,p="__p += '",h=Mt((e.escape||bt).source+"|"+f.source+"|"+(f===Z?ft:bt).source+"|"+(e.evaluate||bt).source+"|$","g"),d="//# sourceURL="+(Dt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Zt+"]")+"\n";t.replace(h,(function(e,n,r,o,a,c){return r||(r=o),p+=t.slice(u,c).replace(wt,Ze),n&&(i=!0,p+="' +\n__e("+n+") +\n'"),a&&(s=!0,p+="';\n"+a+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+e.length,e})),p+="';\n";var m=Dt.call(e,"variable")&&e.variable;if(m){if(lt.test(m))throw new xt("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(s?p.replace(H,""):p).replace(F,"$1").replace(W,"$1;"),p="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=Qa((function(){return kt(c,d+"return "+p).apply(o,l)}));if(v.source=p,Zs(v))throw v;return v},jn.times=function(t,e){if((t=ma(t))<1||t>f)return[];var n=h,r=yn(t,h);e=ai(e),t-=h;for(var o=Le(r,e);++n<t;)e(n);return o},jn.toFinite=da,jn.toInteger=ma,jn.toLength=va,jn.toLower=function(t){return ba(t).toLowerCase()},jn.toNumber=ga,jn.toSafeInteger=function(t){return t?sr(ma(t),-9007199254740991,f):0===t?t:0},jn.toString=ba,jn.toUpper=function(t){return ba(t).toUpperCase()},jn.trim=function(t,e,n){if((t=ba(t))&&(n||e===o))return He(t);if(!t||!(e=ao(e)))return t;var r=sn(t),i=sn(e);return wo(r,Je(r,i),Ke(r,i)+1).join("")},jn.trimEnd=function(t,e,n){if((t=ba(t))&&(n||e===o))return t.slice(0,an(t)+1);if(!t||!(e=ao(e)))return t;var r=sn(t);return wo(r,0,Ke(r,sn(e))+1).join("")},jn.trimStart=function(t,e,n){if((t=ba(t))&&(n||e===o))return t.replace(rt,"");if(!t||!(e=ao(e)))return t;var r=sn(t);return wo(r,Je(r,sn(e))).join("")},jn.truncate=function(t,e){var n=30,r="...";if(ea(e)){var i="separator"in e?e.separator:i;n="length"in e?ma(e.length):n,r="omission"in e?ao(e.omission):r}var s=(t=ba(t)).length;if(Xe(t)){var a=sn(t);s=a.length}if(n>=s)return t;var c=n-on(r);if(c<1)return r;var l=a?wo(a,0,c).join(""):t.slice(0,c);if(i===o)return l+r;if(a&&(c+=l.length-c),sa(i)){if(t.slice(c).search(i)){var u,f=l;for(i.global||(i=Mt(i.source,ba(pt.exec(i))+"g")),i.lastIndex=0;u=i.exec(f);)var p=u.index;l=l.slice(0,p===o?c:p)}}else if(t.indexOf(ao(i),c)!=c){var h=l.lastIndexOf(i);h>-1&&(l=l.slice(0,h))}return l+r},jn.unescape=function(t){return(t=ba(t))&&K.test(t)?t.replace(q,cn):t},jn.uniqueId=function(t){var e=++zt;return ba(t)+e},jn.upperCase=Ga,jn.upperFirst=Za,jn.each=bs,jn.eachRight=ws,jn.first=Ki,cc(jn,(yc={},br(jn,(function(t,e){Dt.call(jn.prototype,e)||(yc[e]=t)})),yc),{chain:!1}),jn.VERSION="4.17.21",be(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){jn[t].placeholder=jn})),be(["drop","take"],(function(t,e){Fn.prototype[t]=function(n){n=n===o?1:gn(ma(n),0);var r=this.__filtered__&&!e?new Fn(this):this.clone();return r.__filtered__?r.__takeCount__=yn(n,r.__takeCount__):r.__views__.push({size:yn(n,h),type:t+(r.__dir__<0?"Right":"")}),r},Fn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),be(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Fn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ai(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),be(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Fn.prototype[t]=function(){return this[n](1).value()[0]}})),be(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Fn.prototype[t]=function(){return this.__filtered__?new Fn(this):this[n](1)}})),Fn.prototype.compact=function(){return this.filter(oc)},Fn.prototype.find=function(t){return this.filter(t).head()},Fn.prototype.findLast=function(t){return this.reverse().find(t)},Fn.prototype.invokeMap=Ur((function(t,e){return"function"==typeof t?new Fn(this):this.map((function(n){return Tr(n,t,e)}))})),Fn.prototype.reject=function(t){return this.filter(Is(ai(t)))},Fn.prototype.slice=function(t,e){t=ma(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Fn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=ma(e))<0?n.dropRight(-e):n.take(e-t)),n)},Fn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Fn.prototype.toArray=function(){return this.take(h)},br(Fn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=jn[r?"take"+("last"==e?"Right":""):e],s=r||/^find/.test(e);i&&(jn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,c=e instanceof Fn,l=a[0],u=c||qs(e),f=function(t){var e=i.apply(jn,Se([t],a));return r&&p?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var p=this.__chain__,h=!!this.__actions__.length,d=s&&!p,m=c&&!h;if(!s&&u){e=m?e:new Fn(this);var v=t.apply(e,a);return v.__actions__.push({func:ds,args:[f],thisArg:o}),new Hn(v,p)}return d&&m?t.apply(this,a):(v=this.thru(f),d?r?v.value()[0]:v.value():v)})})),be(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Ot[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);jn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var o=this.value();return e.apply(qs(o)?o:[],t)}return this[n]((function(n){return e.apply(qs(n)?n:[],t)}))}})),br(Fn.prototype,(function(t,e){var n=jn[e];if(n){var r=n.name+"";Dt.call(An,r)||(An[r]=[]),An[r].push({name:e,func:n})}})),An[jo(o,2).name]=[{name:"wrapper",func:o}],Fn.prototype.clone=function(){var t=new Fn(this.__wrapped__);return t.__actions__=Oo(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Oo(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Oo(this.__views__),t},Fn.prototype.reverse=function(){if(this.__filtered__){var t=new Fn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Fn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=qs(t),r=e<0,o=n?t.length:0,i=function(t,e,n){for(var r=-1,o=n.length;++r<o;){var i=n[r],s=i.size;switch(i.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=yn(e,t+s);break;case"takeRight":t=gn(t,e-s)}}return{start:t,end:e}}(0,o,this.__views__),s=i.start,a=i.end,c=a-s,l=r?a:s-1,u=this.__iteratees__,f=u.length,p=0,h=yn(c,this.__takeCount__);if(!n||!r&&o==c&&h==c)return po(t,this.__actions__);var d=[];t:for(;c--&&p<h;){for(var m=-1,v=t[l+=e];++m<f;){var g=u[m],y=g.iteratee,b=g.type,w=y(v);if(2==b)v=w;else if(!w){if(1==b)continue t;break t}}d[p++]=v}return d},jn.prototype.at=ms,jn.prototype.chain=function(){return hs(this)},jn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===o&&(this.__values__=ha(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},jn.prototype.plant=function(t){for(var e,n=this;n instanceof Ln;){var r=Vi(n);r.__index__=0,r.__values__=o,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},jn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Fn){var e=t;return this.__actions__.length&&(e=new Fn(this)),(e=e.reverse()).__actions__.push({func:ds,args:[es],thisArg:o}),new Hn(e,this.__chain__)}return this.thru(es)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return po(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,se&&(jn.prototype[se]=function(){return this}),jn}();ie._=ln,(r=function(){return ln}.call(e,n,e,t))===o||(t.exports=r)}.call(this)}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t){return 0===Object.keys(t).length}function c(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function l(t){let e;return c(t,(t=>e=t))(),e}function u(t,e,n){t.$$.on_destroy.push(c(e,n))}function f(t,e,n,r){if(t){const o=p(t,e,n,r);return t[0](o)}}function p(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function h(t,e,n,r,o,i,s){const a=function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(e,r,o,i);if(a){const o=p(e,n,r,s);t.p(o,a)}}function d(t,e,n=e){return t.set(n),e}function m(e){return e&&i(e.destroy)?e.destroy:t}new Set;let v,g=!1;function y(t,e,n,r){for(;t<e;){const o=t+(e-t>>1);n(o)<=r?t=o+1:e=o}return t}function b(t,e){g?(function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let o=0;for(let t=0;t<e.length;t++){const i=y(1,o+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[i]+1;const s=i+1;n[s]=t,o=Math.max(s,o)}const i=[],s=[];let a=e.length-1;for(let t=n[o]+1;0!=t;t=r[t-1]){for(i.push(e[t-1]);a>=t;a--)s.push(e[a]);a--}for(;a>=0;a--)s.push(e[a]);i.reverse(),s.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<s.length;e++){for(;n<i.length&&s[e].claim_order>=i[n].claim_order;)n++;const r=n<i.length?i[n]:null;t.insertBefore(s[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function w(t,e,n){g&&!n?b(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function x(t){t.parentNode.removeChild(t)}function k(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function $(t){return document.createElement(t)}function _(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function M(t){return document.createTextNode(t)}function S(){return M(" ")}function C(){return M("")}function O(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function T(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function A(t){return""===t?null:+t}function N(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function E(t,e){t.value=null==e?"":e}function D(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function z(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function R(t,e,n){t.classList[n?"add":"remove"](e)}function I(t){v=t}function B(){if(!v)throw new Error("Function called outside component initialization");return v}function P(t){B().$$.on_mount.push(t)}function j(t){B().$$.on_destroy.push(t)}function V(t){return B().$$.context.get(t)}new Set;const L=[],H=[],F=[],W=[],q=Promise.resolve();let J=!1;function K(){J||(J=!0,q.then(X))}function U(){return K(),q}function Y(t){F.push(t)}let G=!1;const Z=new Set;function X(){if(!G){G=!0;do{for(let t=0;t<L.length;t+=1){const e=L[t];I(e),Q(e.$$)}for(I(null),L.length=0;H.length;)H.pop()();for(let t=0;t<F.length;t+=1){const e=F[t];Z.has(e)||(Z.add(e),e())}F.length=0}while(L.length);for(;W.length;)W.pop()();J=!1,G=!1,Z.clear()}}function Q(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Y)}}const tt=new Set;let et,nt;function rt(){et={r:0,c:[],p:et}}function ot(){et.r||o(et.c),et=et.p}function it(t,e){t&&t.i&&(tt.delete(t),t.i(e))}function st(t,e,n,r){if(t&&t.o){if(tt.has(t))return;tt.add(t),et.c.push((()=>{tt.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function at(t,e){st(t,1,1,(()=>{e.delete(t.key)}))}function ct(t){t&&t.c()}function lt(t,n,r,s){const{fragment:a,on_mount:c,on_destroy:l,after_update:u}=t.$$;a&&a.m(n,r),s||Y((()=>{const n=c.map(e).filter(i);l?l.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(Y)}function ut(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ft(e,n,i,s,a,c,l=[-1]){const u=v;I(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:n.context||[]),callbacks:r(),dirty:l,skip_bound:!1};let p=!1;if(f.ctx=i?i(e,n.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&function(t,e){-1===t.$$.dirty[0]&&(L.push(t),K(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],f.update(),p=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){g=!0;const t=(h=n.target,Array.from(h.childNodes));f.fragment&&f.fragment.l(t),t.forEach(x)}else f.fragment&&f.fragment.c();n.intro&&it(e.$$.fragment),lt(e,n.target,n.anchor,n.customElement),g=!1,X()}var h;I(u)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(nt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(i);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){ut(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class pt{$destroy(){ut(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function ht(t){this.content=t}ht.prototype={constructor:ht,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,o=r.find(t),i=r.content.slice();return-1==o?i.push(n||t,e):(i[o+1]=e,n&&(i[o]=n)),new ht(i)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new ht(n)},addToStart:function(t,e){return new ht([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new ht(n)},addBefore:function(t,e,n){var r=this.remove(e),o=r.content.slice(),i=r.find(t);return o.splice(-1==i?o.length:i,0,e,n),new ht(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=ht.from(t)).size?new ht(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=ht.from(t)).size?new ht(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=ht.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},get size(){return this.content.length>>1}},ht.from=function(t){if(t instanceof ht)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new ht(e)};const dt=ht;function mt(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=mt(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function vt(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var l=0,u=Math.min(s.text.length,a.text.length);l<u&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=vt(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var gt=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},yt={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};gt.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},gt.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},gt.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},gt.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new gt(r,this.size+t.size)},gt.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new gt(n,r)},gt.prototype.cutByIndex=function(t,e){return t==e?gt.empty:0==t&&e==this.content.length?this:new gt(this.content.slice(t,e))},gt.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new gt(r,o)},gt.prototype.addToStart=function(t){return new gt([t].concat(this.content),this.size+t.nodeSize)},gt.prototype.addToEnd=function(t){return new gt(this.content.concat(t),this.size+t.nodeSize)},gt.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},yt.firstChild.get=function(){return this.content.length?this.content[0]:null},yt.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},yt.childCount.get=function(){return this.content.length},gt.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},gt.prototype.maybeChild=function(t){return this.content[t]},gt.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},gt.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),mt(this,t,e)},gt.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),vt(this,t,e,n)},gt.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return wt(0,t);if(t==this.size)return wt(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?wt(n+1,o):wt(n,r);r=o}},gt.prototype.toString=function(){return"<"+this.toStringInner()+">"},gt.prototype.toStringInner=function(){return this.content.join(", ")},gt.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},gt.fromJSON=function(t,e){if(!e)return gt.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new gt(e.map(t.nodeFromJSON))},gt.fromArray=function(t){if(!t.length)return gt.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new gt(e||t,n)},gt.from=function(t){if(!t)return gt.empty;if(t instanceof gt)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new gt([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(gt.prototype,yt);var bt={index:0,offset:0};function wt(t,e){return bt.index=t,bt.offset=e,bt}function xt(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!xt(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!xt(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}gt.empty=new gt([],0);var kt=function(t,e){this.type=t,this.attrs=e};function $t(t){var e=Error.call(this,t);return e.__proto__=$t.prototype,e}kt.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},kt.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},kt.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},kt.prototype.eq=function(t){return this==t||this.type==t.type&&xt(this.attrs,t.attrs)},kt.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},kt.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},kt.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},kt.setFrom=function(t){if(!t||0==t.length)return kt.none;if(t instanceof kt)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},kt.none=[],$t.prototype=Object.create(Error.prototype),$t.prototype.constructor=$t,$t.prototype.name="ReplaceError";var _t=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},Mt={size:{configurable:!0}};function St(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,l=a.offset;if(i==e||s.isText){if(l!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(St(s.content,e-i-1,n-i-1)))}function Ct(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=Ct(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function Ot(t,e,n){if(n.openStart>t.depth)throw new $t("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new $t("Inconsistent open depths");return Tt(t,e,n,0)}function Tt(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=Tt(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(gt.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return zt(i,Rt(t,a.start,a.end,e,r))}var c=t.parent,l=c.content;return zt(c,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}return zt(i,It(t,e,r))}function At(t,e){if(!e.type.compatibleContent(t.type))throw new $t("Cannot join "+e.type.name+" onto "+t.type.name)}function Nt(t,e,n){var r=t.node(n);return At(r,e.node(n)),r}function Et(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Dt(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Et(t.nodeAfter,r),i++));for(var a=i;a<s;a++)Et(o.child(a),r);e&&e.depth==n&&e.textOffset&&Et(e.nodeBefore,r)}function zt(t,e){if(!t.type.validContent(e))throw new $t("Invalid content for node "+t.type.name);return t.copy(e)}function Rt(t,e,n,r,o){var i=t.depth>o&&Nt(t,e,o+1),s=r.depth>o&&Nt(n,r,o+1),a=[];return Dt(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(At(i,s),Et(zt(i,Rt(t,e,n,r,o+1)),a)):(i&&Et(zt(i,It(t,e,o+1)),a),Dt(e,n,o,a),s&&Et(zt(s,It(n,r,o+1)),a)),Dt(r,null,o,a),new gt(a)}function It(t,e,n){var r=[];return Dt(null,t,n,r),t.depth>n&&Et(zt(Nt(t,e,n+1),It(t,e,n+1)),r),Dt(e,null,n,r),new gt(r)}Mt.size.get=function(){return this.content.size-this.openStart-this.openEnd},_t.prototype.insertAt=function(t,e){var n=Ct(this.content,t+this.openStart,e,null);return n&&new _t(n,this.openStart,this.openEnd)},_t.prototype.removeBetween=function(t,e){return new _t(St(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},_t.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},_t.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},_t.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},_t.fromJSON=function(t,e){if(!e)return _t.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new _t(gt.fromJSON(t,e.content),n,r)},_t.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new _t(t,n,r)},Object.defineProperties(_t.prototype,Mt),_t.empty=new _t(gt.empty,0,0);var Bt=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},Pt={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};Bt.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Pt.parent.get=function(){return this.node(this.depth)},Pt.doc.get=function(){return this.node(0)},Bt.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},Bt.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},Bt.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},Bt.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},Bt.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},Bt.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},Bt.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Pt.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Pt.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},Pt.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},Bt.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},Bt.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return kt.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},Bt.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},Bt.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},Bt.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Ht(this,t,n)},Bt.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},Bt.prototype.max=function(t){return t.pos>this.pos?t:this},Bt.prototype.min=function(t){return t.pos<this.pos?t:this},Bt.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},Bt.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new Bt(e,n,o)},Bt.resolveCached=function(t,e){for(var n=0;n<jt.length;n++){var r=jt[n];if(r.pos==e&&r.doc==t)return r}var o=jt[Vt]=Bt.resolve(t,e);return Vt=(Vt+1)%Lt,o},Object.defineProperties(Bt.prototype,Pt);var jt=[],Vt=0,Lt=12,Ht=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Ft={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Ft.start.get=function(){return this.$from.before(this.depth+1)},Ft.end.get=function(){return this.$to.after(this.depth+1)},Ft.parent.get=function(){return this.$from.node(this.depth)},Ft.startIndex.get=function(){return this.$from.index(this.depth)},Ft.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Ht.prototype,Ft);var Wt=Object.create(null),qt=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||gt.empty,this.marks=r||kt.none},Jt={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Jt.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Jt.childCount.get=function(){return this.content.childCount},qt.prototype.child=function(t){return this.content.child(t)},qt.prototype.maybeChild=function(t){return this.content.maybeChild(t)},qt.prototype.forEach=function(t){this.content.forEach(t)},qt.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},qt.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},Jt.textContent.get=function(){return this.textBetween(0,this.content.size,"")},qt.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},Jt.firstChild.get=function(){return this.content.firstChild},Jt.lastChild.get=function(){return this.content.lastChild},qt.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},qt.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},qt.prototype.hasMarkup=function(t,e,n){return this.type==t&&xt(this.attrs,e||t.defaultAttrs||Wt)&&kt.sameSet(this.marks,n||kt.none)},qt.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},qt.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},qt.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},qt.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return _t.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new _t(a,r.depth-i,o.depth-i)},qt.prototype.replace=function(t,e,n){return Ot(this.resolve(t),this.resolve(e),n)},qt.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},qt.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},qt.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},qt.prototype.resolve=function(t){return Bt.resolveCached(this,t)},qt.prototype.resolveNoCache=function(t){return Bt.resolve(this,t)},qt.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},Jt.isBlock.get=function(){return this.type.isBlock},Jt.isTextblock.get=function(){return this.type.isTextblock},Jt.inlineContent.get=function(){return this.type.inlineContent},Jt.isInline.get=function(){return this.type.isInline},Jt.isText.get=function(){return this.type.isText},Jt.isLeaf.get=function(){return this.type.isLeaf},Jt.isAtom.get=function(){return this.type.isAtom},qt.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Ut(this.marks,t)},qt.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},qt.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=gt.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},qt.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},qt.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},qt.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var t=kt.none,e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!kt.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(t){return t.type.name})));this.content.forEach((function(t){return t.check()}))},qt.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},qt.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=gt.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(qt.prototype,Jt);var Kt=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ut(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(qt);function Ut(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var Yt=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Gt={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Yt.parse=function(t,e){var n=new Zt(t,e);if(null==n.next)return Yt.empty;var r=Qt(n);n.next&&n.err("Unexpected trailing text");var o,i,s=(o=function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,f=0;f<e.min;f++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var h=e.min;h<e.max;h++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r),i=Object.create(null),function t(e){var n=[];e.forEach((function(t){o[t].forEach((function(t){var e=t.term,r=t.to;if(e){var i=n.indexOf(e),s=i>-1&&n[i+1];ie(o,r).forEach((function(t){s||n.push(e,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var r=i[e.join(",")]=new Yt(e.indexOf(o.length-1)>-1),s=0;s<n.length;s+=2){var a=n[s+1].sort(oe);r.next.push(n[s],i[a.join(",")]||t(a))}return r}(ie(o,0)));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,n),s},Yt.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},Yt.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},Gt.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},Gt.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},Yt.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},Yt.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return gt.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var f=o(u,s.concat(l));if(f)return f}}}(this,[])},Yt.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},Yt.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},Gt.edgeCount.get=function(){return this.next.length>>1},Yt.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},Yt.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(Yt.prototype,Gt),Yt.empty=new Yt(!0);var Zt=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Xt={next:{configurable:!0}};function Qt(t){var e=[];do{e.push(te(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function te(t){var e=[];do{e.push(ee(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function ee(t){for(var e=function(t){if(t.eat("(")){var e=Qt(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}return 0==o.length&&t.err("No node type or group '"+e+"' found"),o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=re(t,e)}return e}function ne(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function re(t,e){var n=ne(t),r=n;return t.eat(",")&&(r="}"!=t.next?ne(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function oe(t,e){return e-t}function ie(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(oe)}function se(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function ae(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ce(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new fe(t[n]);return e}Xt.next.get=function(){return this.tokens[this.pos]},Zt.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Zt.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Zt.prototype,Xt);var le=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ce(n.attrs),this.defaultAttrs=se(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},ue={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ue.isInline.get=function(){return!this.isBlock},ue.isTextblock.get=function(){return this.isBlock&&this.inlineContent},ue.isLeaf.get=function(){return this.contentMatch==Yt.empty},ue.isAtom.get=function(){return this.isLeaf||this.spec.atom},le.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},le.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},le.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:ae(this.attrs,t)},le.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new qt(this,this.computeAttrs(t),gt.from(e),kt.setFrom(n))},le.prototype.createChecked=function(t,e,n){if(e=gt.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new qt(this,this.computeAttrs(t),e,kt.setFrom(n))},le.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=gt.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(gt.empty,!0);return o?new qt(this,t,e.append(o),kt.setFrom(n)):null},le.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},le.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},le.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},le.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:kt.empty:t},le.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new le(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(le.prototype,ue);var fe=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},pe={isRequired:{configurable:!0}};pe.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(fe.prototype,pe);var he=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=ce(r.attrs),this.rank=e,this.excluded=null;var o=se(this.attrs);this.instance=o&&new kt(this,o)};he.prototype.create=function(t){return!t&&this.instance?this.instance:new kt(this,ae(this.attrs,t))},he.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new he(t,r++,e,o)})),n},he.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t},he.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},he.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var de=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=dt.from(t.nodes),this.spec.marks=dt.from(t.marks),this.nodes=le.compile(this.spec.nodes,this),this.marks=he.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=Yt.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?me(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],l=c.spec.excludes;c.excluded=null==l?[c]:""==l?[]:me(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function me(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}de.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof le))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},de.prototype.text=function(t,e){var n=this.nodes.text;return new Kt(n,n.defaultAttrs,t,kt.setFrom(e))},de.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},de.prototype.nodeFromJSON=function(t){return qt.fromJSON(this,t)},de.prototype.markFromJSON=function(t){return kt.fromJSON(this,t)},de.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var ve=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};ve.prototype.parse=function(t,e){void 0===e&&(e={});var n=new ke(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},ve.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new ke(this,e,!0);return n.addAll(t,null,e.from,e.to),_t.maxOpen(n.finish())},ve.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(_e(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},ve.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},ve.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r,o=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Me(t)),t.mark=e}))};for(var i in t.marks)o(i);for(var s in t.nodes)r=void 0,(r=t.nodes[s].spec.parseDOM)&&r.forEach((function(t){n(t=Me(t)),t.node=s}));return e},ve.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new ve(t,ve.schemaRules(t)))};var ge={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ye={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},be={ol:!0,ul:!0};function we(t){return(t?1:0)|("full"===t?2:0)}var xe=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=kt.none,this.pendingMarks=r,this.stashMarks=[]};xe.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(gt.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},xe.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=gt.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(gt.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},xe.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},xe.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):Se(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},xe.prototype.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!ge.hasOwnProperty(t.parentNode.nodeName.toLowerCase())};var ke=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=we(e.preserveWhitespace)|(n?4:0);r=o?new xe(o.type,o.attrs,kt.none,kt.none,!0,e.topMatch||o.type.contentMatch,i):new xe(n?null:t.schema.topNodeType,null,kt.none,kt.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},$e={top:{configurable:!0},currentPos:{configurable:!0}};function _e(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Me(t){var e={};for(var n in t)e[n]=t[n];return e}function Se(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[],s=function(t){i.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),o=r.type,a=r.next;if(o==e)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}$e.top.get=function(){return this.nodes[this.open]},ke.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){for(var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},ke.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if(2&n.options||n.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)e=2&n.options?e.replace(/\r\n?/g,"\n"):e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},ke.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();be.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&be.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:ye.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(ge.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},ke.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},ke.prototype.ignoreFallback=function(t){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},ke.prototype.readStyles=function(t){var e=kt.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},ke.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},ke.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&ge.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},ke.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},ke.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},ke.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},ke.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:we(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new xe(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},ke.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},ke.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ke.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},$e.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},ke.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},ke.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},ke.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++)null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)&&e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)},ke.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},ke.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},ke.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},ke.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},ke.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(ke.prototype,$e);var Ce=function(t,e){this.nodes=t||{},this.marks=e||{}};function Oe(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Te(t){return t.document||window.document}Ce.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Te(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Ce.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Ce.renderSpec(Te(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Ce.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Ce.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&Ce.renderSpec(Te(n),r(t,e))},Ce.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var f=c;f<e.length;f++){var p=e[f];if(0===p){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var h=Ce.renderSpec(t,p,n),d=h.dom,m=h.contentDOM;if(s.appendChild(d),m){if(i)throw new RangeError("Multiple content holes");i=m}}return{dom:s,contentDOM:i}},Ce.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Ce(this.nodesFromSchema(t),this.marksFromSchema(t)))},Ce.nodesFromSchema=function(t){var e=Oe(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Ce.marksFromSchema=function(t){return Oe(t.marks)};var Ae=Math.pow(2,16);function Ne(t){return 65535&t}var Ee=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n},De=function(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e};De.prototype.recover=function(t){var e=0,n=Ne(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/Ae}(t)},De.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},De.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},De.prototype._map=function(t,e,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;var c=this.ranges[s+o],l=this.ranges[s+i],u=a+c;if(t<=u){var f=a+r+((c?t==a?-1:t==u?1:e:e)<0?0:l);return n?f:new Ee(f,e<0?t!=a:t!=u,t==(e<0?a:u)?null:s/3+(t-a)*Ae)}r+=l-c}return n?t+r:new Ee(t+r)},De.prototype.touches=function(t,e){for(var n=0,r=Ne(e),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>t)break;var c=this.ranges[s+o];if(t<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},De.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+e],l=this.ranges[r+n];t(s,s+c,a,a+l),o+=l-c}},De.prototype.invert=function(){return new De(this.ranges,!this.inverted)},De.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},De.offset=function(t){return 0==t?De.empty:new De(t<0?[0,-t,0]:[0,0,t])},De.empty=new De([]);var ze=function(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e};function Re(t){var e=Error.call(this,t);return e.__proto__=Re.prototype,e}ze.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new ze(this.maps,this.mirror,t,e)},ze.prototype.copy=function(){return new ze(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},ze.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},ze.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},ze.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},ze.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},ze.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&r>e?n-r-1:null)}},ze.prototype.invert=function(){var t=new ze;return t.appendMappingInverted(this),t},ze.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},ze.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},ze.prototype._map=function(t,e,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(t,e);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,t=this.maps[s].recover(i.recover);continue}}i.deleted&&(r=!0),t=i.pos}return n?t:new Ee(t,r)},Re.prototype=Object.create(Error.prototype),Re.prototype.constructor=Re,Re.prototype.name="TransformError";var Ie=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new ze},Be={before:{configurable:!0},docChanged:{configurable:!0}};function Pe(){throw new Error("Override me")}Be.before.get=function(){return this.docs.length?this.docs[0]:this.doc},Ie.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new Re(e.failed);return this},Ie.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},Be.docChanged.get=function(){return this.steps.length>0},Ie.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(Ie.prototype,Be);var je=Object.create(null),Ve=function(){};Ve.prototype.apply=function(t){return Pe()},Ve.prototype.getMap=function(){return De.empty},Ve.prototype.invert=function(t){return Pe()},Ve.prototype.map=function(t){return Pe()},Ve.prototype.merge=function(t){return null},Ve.prototype.toJSON=function(){return Pe()},Ve.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=je[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},Ve.jsonID=function(t,e){if(t in je)throw new RangeError("Duplicate use of step JSON ID "+t);return je[t]=e,e.prototype.jsonID=t,e};var Le=function(t,e){this.doc=t,this.failed=e};Le.ok=function(t){return new Le(t,null)},Le.fail=function(t){return new Le(null,t)},Le.fromReplace=function(t,e,n,r){try{return Le.ok(t.replace(e,n,r))}catch(t){if(t instanceof $t)return Le.fail(t.message);throw t}};var He=function(t){function e(e,n,r,o){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&We(t,this.from,this.to)?Le.fail("Structure replace would overwrite content"):Le.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new De([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?_t.empty:new _t(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var r=this.slice.size+t.slice.size==0?_t.empty:new _t(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),r,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,_t.fromJSON(t,n.slice),!!n.structure)},e}(Ve);Ve.jsonID("replace",He);var Fe=function(t){function e(e,n,r,o,i,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(We(t,this.from,this.gapFrom)||We(t,this.gapTo,this.to)))return Le.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Le.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?Le.fromReplace(t,this.from,this.to,n):Le.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new De([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1),i=t.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new e(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,_t.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(Ve);function We(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function qe(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Je(t){for(var e=t.parent.content.cutByIndex(t.startIndex,t.endIndex),n=t.depth;;--n){var r=t.$from.node(n),o=t.$from.index(n),i=t.$to.indexAfter(n);if(n<t.depth&&r.canReplace(o,i,e))return n;if(0==n||r.type.spec.isolating||!qe(r,o,i))break}}function Ke(t,e,n,r){void 0===r&&(r=t);var o=function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;var s=i.length?i[0]:e;return n.canReplaceWith(r,o,s)?i:null}(t,e),i=o&&function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:e).contentMatch,c=r;a&&c<o;c++)a=a.matchType(n.child(c).type);return a&&a.validEnd?s:null}(r,e);return i?o.map(Ue).concat({type:e,attrs:n}).concat(i.map(Ue)):null}function Ue(t){return{type:t,attrs:null}}function Ye(t,e,n,r){void 0===n&&(n=1);var o=t.resolve(e),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var l=o.node(a),u=o.index(a);if(l.type.spec.isolating)return!1;var f=l.content.cutByIndex(u,l.childCount),p=r&&r[c]||l;if(p!=l&&(f=f.replaceChild(0,p.type.create(p.attrs))),!l.canReplace(u+1,l.childCount)||!p.type.validContent(f))return!1}var h=o.indexAfter(i),d=r&&r[0];return o.node(i).canReplaceWith(h,h,d?d.type:o.node(i+1).type)}function Ge(t,e){var n=t.resolve(e),r=n.index();return function(t,e){return t&&e&&!t.isLeaf&&t.canAppend(e)}(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Ze(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0),u=r.node(a),f=!1;if(1==s)f=u.canReplace(l,l,o);else{var p=u.contentMatchAt(l).findWrapping(o.firstChild.type);f=p&&u.canReplaceWith(l,l,p[0])}if(f)return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function Xe(t,e,n){for(var r=[],o=0;o<t.childCount;o++){var i=t.child(o);i.content.size&&(i=i.copy(Xe(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return gt.fromArray(r)}Ve.jsonID("replaceAround",Fe),Ie.prototype.lift=function(t,e){for(var n=t.$from,r=t.$to,o=t.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=gt.empty,u=0,f=o,p=!1;f>e;f--)p||n.index(f)>0?(p=!0,l=gt.from(n.node(f).copy(l)),u++):a--;for(var h=gt.empty,d=0,m=o,v=!1;m>e;m--)v||r.after(m+1)<r.end(m)?(v=!0,h=gt.from(r.node(m).copy(h)),d++):c++;return this.step(new Fe(a,c,i,s,new _t(l.append(h),u,d),l.size-u,!0))},Ie.prototype.wrap=function(t,e){for(var n=gt.empty,r=e.length-1;r>=0;r--)n=gt.from(e[r].type.create(e[r].attrs,n));var o=t.start,i=t.end;return this.step(new Fe(o,i,o,i,new _t(n,0,0),e.length,!0))},Ie.prototype.setBlockType=function(t,e,n,r){var o=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,r)&&function(t,e,n){var r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(e),n)){o.clearIncompatible(o.mapping.slice(i).map(e,1),n);var s=o.mapping.slice(i),a=s.map(e,1),c=s.map(e+t.nodeSize,1);return o.step(new Fe(a,c,a+1,c-1,new _t(gt.from(n.create(r,null,t.marks)),0,0),1,!0)),!1}})),this},Ie.prototype.setNodeMarkup=function(t,e,n,r){var o=this.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");e||(e=o.type);var i=e.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(t,t+o.nodeSize,i);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new Fe(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new _t(gt.from(i),0,0),1,!0))},Ie.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var r=this.doc.resolve(t),o=gt.empty,i=gt.empty,s=r.depth,a=r.depth-e,c=e-1;s>a;s--,c--){o=gt.from(r.node(s).copy(o));var l=n&&n[c];i=gt.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new He(t,t,new _t(o.append(i),e,e),!0))},Ie.prototype.join=function(t,e){void 0===e&&(e=1);var n=new He(t-e,t+e,_t.empty,!0);return this.step(n)};var Qe=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new _t(Xe(n.content,(function(t,n){return t.isAtom&&n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),o),n.openStart,n.openEnd);return Le.fromReplace(t,this.from,this.to,i)},e.prototype.invert=function(){return new tn(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Ve);Ve.jsonID("addMark",Qe);var tn=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=new _t(Xe(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return Le.fromReplace(t,this.from,this.to,r)},e.prototype.invert=function(){return new Qe(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Ve);function en(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}Ve.jsonID("removeMark",tn),Ie.prototype.addMark=function(t,e,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var f=Math.max(c,t),p=Math.min(c+r.nodeSize,e),h=n.addToSet(u),d=0;d<u.length;d++)u[d].isInSet(h)||(s&&s.to==f&&s.mark.eq(u[d])?s.to=p:o.push(s=new tn(f,p,u[d])));a&&a.to==f?a.to=p:i.push(a=new Qe(f,p,n))}}})),o.forEach((function(t){return r.step(t)})),i.forEach((function(t){return r.step(t)})),this},Ie.prototype.removeMark=function(t,e,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(t,e,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof he)for(var c,l=r.marks;c=n.isInSet(l);)(a||(a=[])).push(c),l=c.removeFromSet(l);else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var u=Math.min(s+r.nodeSize,e),f=0;f<a.length;f++){for(var p=a[f],h=void 0,d=0;d<o.length;d++){var m=o[d];m.step==i-1&&p.eq(o[d].style)&&(h=m)}h?(h.to=u,h.step=i):o.push({style:p,from:Math.max(s,t),to:u,step:i})}}})),o.forEach((function(t){return r.step(new tn(t.from,t.to,t.style))})),this},Ie.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var r=this.doc.nodeAt(t),o=[],i=t+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var u=0;u<a.marks.length;u++)e.allowsMarkType(a.marks[u].type)||this.step(new tn(i,c,a.marks[u]))}else o.push(new He(i,c,_t.empty));i=c}if(!n.validEnd){var f=n.fillBefore(gt.empty,!0);this.replace(i,i,new _t(f,0,0))}for(var p=o.length-1;p>=0;p--)this.step(o[p]);return this},Ie.prototype.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=_t.empty);var r=function(t,e,n,r){if(void 0===n&&(n=e),void 0===r&&(r=_t.empty),e==n&&!r.size)return null;var o=t.resolve(e),i=t.resolve(n);return en(o,i,r)?new He(e,n,r):new nn(o,i,r).fit()}(this.doc,t,e,n);return r&&this.step(r),this},Ie.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new _t(gt.from(n),0,0))},Ie.prototype.delete=function(t,e){return this.replace(t,e,_t.empty)},Ie.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var nn=function(t,e,n){this.$to=e,this.$from=t,this.unplaced=n,this.frontier=[];for(var r=0;r<=t.depth;r++){var o=t.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(r))})}this.placed=gt.empty;for(var i=t.depth;i>0;i--)this.placed=gt.from(t.node(i).copy(this.placed))},rn={depth:{configurable:!0}};function on(t,e,n){return 0==e?t.cutByIndex(n):t.replaceChild(0,t.firstChild.copy(on(t.firstChild.content,e-1,n)))}function sn(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(sn(t.lastChild.content,e-1,n)))}function an(t,e){for(var n=0;n<e;n++)t=t.firstChild.content;return t}function cn(t,e,n){if(e<=0)return t;var r=t.content;return e>1&&(r=r.replaceChild(0,cn(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(gt.empty,!0)))),t.copy(r)}function ln(t,e,n,r,o){var i=t.node(e),s=o?t.indexAfter(e):t.index(e);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!function(t,e,n){for(var r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function un(t,e,n,r,o){if(e<n){var i=t.firstChild;t=t.replaceChild(0,i.copy(un(i.content,e+1,n,r,i)))}if(e>r){var s=o.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(gt.empty,!0))}return t}function fn(t,e){for(var n=[],r=Math.min(t.depth,e.depth);r>=0;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;o==e.start(r)&&n.push(r)}return n}rn.depth.get=function(){return this.frontier.length-1},nn.prototype.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new _t(i,s,a);return e>-1?new Fe(r.pos,e,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new He(r.pos,o.pos,c):void 0},nn.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var e=this.unplaced.openStart;e>=0;e--)for(var n=void 0,r=(e?(n=an(this.unplaced.content,e-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],s=i.type,a=i.match,c=void 0,l=void 0;if(1==t&&(r?a.matchType(r.type)||(l=a.fillBefore(gt.from(r),!1)):s.compatibleContent(n.type)))return{sliceDepth:e,frontierDepth:o,parent:n,inject:l};if(2==t&&r&&(c=a.findWrapping(r.type)))return{sliceDepth:e,frontierDepth:o,parent:n,wrap:c};if(n&&a.matchType(n.type))break}},nn.prototype.openMore=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,o=an(e,n);return!(!o.childCount||o.firstChild.isLeaf||(this.unplaced=new _t(e,n+1,Math.max(r,o.size+n>=e.size-r?n+1:0)),0))},nn.prototype.dropNode=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,o=an(e,n);if(o.childCount<=1&&n>0){var i=e.size-n<=n+o.size;this.unplaced=new _t(on(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new _t(on(e,n,1),n,r)},nn.prototype.placeNodes=function(t){for(var e=t.sliceDepth,n=t.frontierDepth,r=t.parent,o=t.inject,i=t.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,c=r?r.content:a.content,l=a.openStart-e,u=0,f=[],p=this.frontier[n],h=p.match,d=p.type;if(o){for(var m=0;m<o.childCount;m++)f.push(o.child(m));h=h.matchFragment(o)}for(var v=c.size+e-(a.content.size-a.openEnd);u<c.childCount;){var g=c.child(u),y=h.matchType(g.type);if(!y)break;(++u>1||0==l||g.content.size)&&(h=y,f.push(cn(g.mark(d.allowedMarks(g.marks)),1==u?l:0,u==c.childCount?v:-1)))}var b=u==c.childCount;b||(v=-1),this.placed=sn(this.placed,n,gt.from(f)),this.frontier[n].match=h,b&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var w=0,x=c;w<v;w++){var k=x.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),x=k.content}this.unplaced=b?0==e?_t.empty:new _t(on(a.content,e-1,1),e-1,v<0?a.openEnd:e-1):new _t(on(a.content,e,u),a.openStart,a.openEnd)},nn.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!ln(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},nn.prototype.findCloseLevel=function(t){t:for(var e=Math.min(this.depth,t.depth);e>=0;e--){var n=this.frontier[e],r=n.match,o=n.type,i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=ln(t,e,o,r,i);if(s){for(var a=e-1;a>=0;a--){var c=this.frontier[a],l=c.match,u=ln(t,a,c.type,l,!0);if(!u||u.childCount)continue t}return{depth:e,fit:s,move:i?t.doc.resolve(t.after(e+1)):t}}}},nn.prototype.close=function(t){var e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=sn(this.placed,e.depth,e.fit)),t=e.move;for(var n=e.depth+1;n<=t.depth;n++){var r=t.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,o)}return t},nn.prototype.openFrontierNode=function(t,e,n){var r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=sn(this.placed,this.depth,gt.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})},nn.prototype.closeFrontierNode=function(){var t=this.frontier.pop().match.fillBefore(gt.empty,!0);t.childCount&&(this.placed=sn(this.placed,this.frontier.length,t))},Object.defineProperties(nn.prototype,rn),Ie.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var r=this.doc.resolve(t),o=this.doc.resolve(e);if(en(r,o,n))return this.step(new He(t,e,n));var i=fn(r,this.doc.resolve(e));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),f=[],p=n.openStart,h=n.content,d=0;;d++){var m=h.firstChild;if(f.push(m),d==n.openStart)break;h=m.content}p>0&&f[p-1].type.spec.defining&&r.node(u).type!=f[p-1].type?p-=1:p>=2&&f[p-1].isTextblock&&f[p-2].type.spec.defining&&r.node(u).type!=f[p-2].type&&(p-=2);for(var v=n.openStart;v>=0;v--){var g=(v+p+1)%(n.openStart+1),y=f[g];if(y)for(var b=0;b<i.length;b++){var w=i[(b+u)%i.length],x=!0;w<0&&(x=!1,w=-w);var k=r.node(w-1),$=r.index(w-1);if(k.canReplaceWith($,$,y.type,y.marks))return this.replace(r.before(w),x?o.after(w):e,new _t(un(n.content,0,n.openStart,g),g,n.openEnd))}}for(var _=this.steps.length,M=i.length-1;M>=0&&(this.replace(t,e,n),!(this.steps.length>_));M--){var S=i[M];S<0||(t=r.before(S),e=o.after(S))}return this},Ie.prototype.replaceRangeWith=function(t,e,n){if(!n.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var r=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,t,n.type);null!=r&&(t=e=r)}return this.replaceRange(t,e,new _t(gt.from(n),0,0))},Ie.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),o=fn(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)};var pn=Object.create(null),hn=function(t,e,n){this.ranges=n||[new mn(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},dn={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};dn.anchor.get=function(){return this.$anchor.pos},dn.head.get=function(){return this.$head.pos},dn.from.get=function(){return this.$from.pos},dn.to.get=function(){return this.$to.pos},dn.$from.get=function(){return this.ranges[0].$from},dn.$to.get=function(){return this.ranges[0].$to},dn.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},hn.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},hn.prototype.replace=function(t,e){void 0===e&&(e=_t.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],l=c.$from,u=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(l.pos),f.map(u.pos),a?_t.empty:e),0==a&&$n(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},hn.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),l=c.map(s.pos),u=c.map(a.pos);o?t.deleteRange(l,u):(t.replaceRangeWith(l,u,e),$n(t,n,e.isInline?-1:1))}},hn.findFrom=function(t,e,n){var r=t.parent.inlineContent?new vn(t):kn(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?kn(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):kn(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},hn.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new wn(t.node(0))},hn.atStart=function(t){return kn(t,t,0,0,1)||new wn(t)},hn.atEnd=function(t){return kn(t,t,t.content.size,t.childCount,-1)||new wn(t)},hn.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=pn[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},hn.jsonID=function(t,e){if(t in pn)throw new RangeError("Duplicate use of selection JSON ID "+t);return pn[t]=e,e.prototype.jsonID=t,e},hn.prototype.getBookmark=function(){return vn.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(hn.prototype,dn),hn.prototype.visible=!0;var mn=function(t,e){this.$from=t,this.$to=e},vn=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=_t.empty),t.prototype.replace.call(this,e,n),n==_t.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new gn(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(hn);hn.jsonID("text",vn);var gn=function(t,e){this.anchor=t,this.head=e};gn.prototype.map=function(t){return new gn(t.map(this.anchor),t.map(this.head))},gn.prototype.resolve=function(t){return vn.between(t.resolve(this.anchor),t.resolve(this.head))};var yn=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new _t(gt.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new bn(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(hn);yn.prototype.visible=!1,hn.jsonID("node",yn);var bn=function(t){this.anchor=t};bn.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new gn(r,r):new bn(r)},bn.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&yn.isSelectable(n)?new yn(e):hn.near(e)};var wn=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=_t.empty),n==_t.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return xn},e}(hn);hn.jsonID("all",wn);var xn={map:function(){return this},resolve:function(t){return new wn(t)}};function kn(t,e,n,r,o,i){if(e.inlineContent)return vn.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&yn.isSelectable(a))return yn.create(t,n-(o<0?a.nodeSize:0))}else{var c=kn(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function $n(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];(i instanceof He||i instanceof Fe)&&(t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(hn.near(t.doc.resolve(o),n)))}}var _n=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return kt.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||kt.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(hn.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(Ie);function Mn(t,e){return e&&t?t.bind(e):t}var Sn=function(t,e,n){this.name=t,this.init=Mn(e.init,n),this.apply=Mn(e.apply,n)},Cn=[new Sn("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Sn("selection",{init:function(t,e){return t.selection||hn.atStart(e.doc)},apply:function(t){return t.selection}}),new Sn("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Sn("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],On=function(t,e){var n=this;this.schema=t,this.fields=Cn.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Sn(t.key,t.spec.state,t))}))},Tn=function(t){this.config=t},An={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};An.schema.get=function(){return this.config.schema},An.plugins.get=function(){return this.config.plugins},Tn.prototype.apply=function(t){return this.applyTransaction(t).state},Tn.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Tn.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,l=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(l&&n.filterTransaction(l,i)){if(l.setMeta("appendedTransaction",t),!r){r=[];for(var u=0;u<this.config.plugins.length;u++)r.push(u<i?{state:n,n:e.length}:{state:this,n:0})}e.push(l),n=n.applyInner(l),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Tn.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Tn(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Nn.length;i++)Nn[i](this,t,e);return e},An.tr.get=function(){return new _n(this)},Tn.create=function(t){for(var e=new On(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new Tn(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Tn.prototype.reconfigure=function(t){for(var e=new On(this.schema,t.plugins),n=e.fields,r=new Tn(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Tn.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Tn.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new On(t.schema,t.plugins),o=new Tn(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=qt.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=hn.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Tn.addApplyListener=function(t){Nn.push(t)},Tn.removeApplyListener=function(t){var e=Nn.indexOf(t);e>-1&&Nn.splice(e,1)},Object.defineProperties(Tn.prototype,An);var Nn=[];function En(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=En(o,e,{})),n[r]=o}return n}var Dn=function(t){this.props={},t.props&&En(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Rn("plugin")};Dn.prototype.getState=function(t){return t[this.key]};var zn=Object.create(null);function Rn(t){return t in zn?t+"$"+ ++zn[t]:(zn[t]=0,t+"$")}var In=function(t){void 0===t&&(t="key"),this.key=Rn(t)};In.prototype.get=function(t){return t.config.pluginsByKey[this.key]},In.prototype.getState=function(t){return t[this.key]};var Bn={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Pn=/Edge\/(\d+)/.exec(navigator.userAgent),jn=/MSIE \d/.test(navigator.userAgent),Vn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Bn.mac=/Mac/.test(navigator.platform);var Ln=Bn.ie=!!(jn||Vn||Pn);Bn.ie_version=jn?document.documentMode||6:Vn?+Vn[1]:Pn?+Pn[1]:null,Bn.gecko=!Ln&&/gecko\/(\d+)/i.test(navigator.userAgent),Bn.gecko_version=Bn.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Hn=!Ln&&/Chrome\/(\d+)/.exec(navigator.userAgent);Bn.chrome=!!Hn,Bn.chrome_version=Hn&&+Hn[1],Bn.safari=!Ln&&/Apple Computer/.test(navigator.vendor),Bn.ios=Bn.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Bn.android=/Android \d/.test(navigator.userAgent),Bn.webkit="webkitFontSmoothing"in document.documentElement.style,Bn.webkit_version=Bn.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Fn=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Wn=function(t){var e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e},qn=null,Jn=function(t,e,n){var r=qn||(qn=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},Kn=function(t,e,n,r){return n&&(Yn(t,e,n,r,-1)||Yn(t,e,n,r,1))},Un=/^(img|br|input|textarea|hr)$/i;function Yn(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Gn(t))){var i=t.parentNode;if(1!=i.nodeType||Zn(t)||Un.test(t.nodeName)||"false"==t.contentEditable)return!1;e=Fn(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?Gn(t):0}}}function Gn(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Zn(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Xn=function(t){var e=t.isCollapsed;return e&&Bn.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function Qn(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function tr(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function er(t,e){return"number"==typeof t?t:t[e]}function nr(t){var e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function rr(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=n||t.dom;s;s=Wn(s))if(1==s.nodeType){var a=s==i.body||1!=s.nodeType,c=a?tr(i):nr(s),l=0,u=0;if(e.top<c.top+er(r,"top")?u=-(c.top-e.top+er(o,"top")):e.bottom>c.bottom-er(r,"bottom")&&(u=e.bottom-c.bottom+er(o,"bottom")),e.left<c.left+er(r,"left")?l=-(c.left-e.left+er(o,"left")):e.right>c.right-er(r,"right")&&(l=e.right-c.right+er(o,"right")),l||u)if(a)i.defaultView.scrollBy(l,u);else{var f=s.scrollLeft,p=s.scrollTop;u&&(s.scrollTop+=u),l&&(s.scrollLeft+=l);var h=s.scrollLeft-f,d=s.scrollTop-p;e={left:e.left-h,top:e.top-d,right:e.right-h,bottom:e.bottom-d}}if(a)break}}function or(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=Wn(t));return e}function ir(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var sr=null;function ar(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=Jn(c).getClientRects()}for(var f=0;f<u.length;f++){var p=u[f];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);var h=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(h<o){n=c,o=h,r=h&&3==n.nodeType?{left:p.right<e.left?p.right:p.left,top:e.top}:e,1==c.nodeType&&h&&(i=l+(e.left>=(p.left+p.right)/2?1:0));continue}}!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=fr(r,1);if(i.top!=i.bottom&&cr(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:ar(n,r)}function cr(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function lr(t,e,n){var r=t.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=t.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var l=a[c];if(cr(e,l))return lr(s,e,l)}if((i=(i+1)%r)==o)break}return t}function ur(t,e){var n,r,o,i,s=t.root;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(e.left,e.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(t){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(e.left,e.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var l,u=s.elementFromPoint(e.left,e.top+1);if(!u||!t.dom.contains(1!=u.nodeType?u.parentNode:u)){var f=t.dom.getBoundingClientRect();if(!cr(e,f))return null;if(!(u=lr(t.dom,e,f)))return null}if(Bn.safari)for(var p=u;o&&p;p=Wn(p))p.draggable&&(o=i=null);if(u=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(u,e),o){if(Bn.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var h,d=o.childNodes[i];"IMG"==d.nodeName&&(h=d.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&i++}o==t.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&e.top>o.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(l=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n)}(t,o,i,e))}null==l&&(l=function(t,e,n){var r=ar(e,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(o,i,s)}(t,u,e));var m=t.docView.nearestDesc(u,!0);return{pos:l,inside:m?m.posAtStart-m.border:-1}}function fr(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}var pr=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function hr(t,e,n){var r=t.docView.domFromPos(e,n<0?-1:1),o=r.node,i=r.offset,s=Bn.webkit||Bn.gecko;if(3==o.nodeType){if(!s||!pr.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var a=i,c=i,l=n<0?1:-1;return n<0&&!i?(c++,l=-1):n>=0&&i==o.nodeValue.length?(a--,l=1):n<0?a--:c++,dr(fr(Jn(o,a,c),l),l<0)}var u=fr(Jn(o,i,i),n);if(Bn.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=fr(Jn(o,i-1,i-1),-1);if(f.top==u.top){var p=fr(Jn(o,i,i+1),-1);if(p.top!=u.top)return dr(p,p.left<f.left)}}return u}if(!t.state.doc.resolve(e).parent.inlineContent){if(i&&(n<0||i==Gn(o))){var h=o.childNodes[i-1];if(1==h.nodeType)return mr(h.getBoundingClientRect(),!1)}if(i<Gn(o)){var d=o.childNodes[i];if(1==d.nodeType)return mr(d.getBoundingClientRect(),!0)}return mr(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==Gn(o))){var m=o.childNodes[i-1],v=3==m.nodeType?Jn(m,Gn(m)-(s?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(v)return dr(fr(v,1),!1)}if(i<Gn(o)){var g=o.childNodes[i],y=3==g.nodeType?Jn(g,0,s?0:1):1==g.nodeType?g:null;if(y)return dr(fr(y,-1),!0)}return dr(fr(3==o.nodeType?Jn(o):o,-n),n>=0)}function dr(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function mr(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function vr(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}var gr=/[\u0590-\u08ac]/,yr=null,br=null,wr=!1;var xr=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},kr={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0}};xr.prototype.matchesWidget=function(){return!1},xr.prototype.matchesMark=function(){return!1},xr.prototype.matchesNode=function(){return!1},xr.prototype.matchesHack=function(t){return!1},kr.beforePosition.get=function(){return!1},xr.prototype.parseRule=function(){return null},xr.prototype.stopEvent=function(){return!1},kr.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},kr.border.get=function(){return 0},xr.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},xr.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},kr.posBefore.get=function(){return this.parent.posBeforeChild(this)},kr.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},kr.posAfter.get=function(){return this.posBefore+this.size},kr.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},xr.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(t==this.dom&&this.contentDOM)a=e>Fn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var l=t;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},xr.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==t.nodeType?t:t.parentNode):o.nodeDOM==t))return o;n=!1}}},xr.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},xr.prototype.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1},xr.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},xr.prototype.domFromPos=function(t,e){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=!0;;r++,o=!1){for(;r<this.children.length&&(this.children[r].beforePosition||this.children[r].dom.parentNode!=this.contentDOM);)n+=this.children[r++].size;var i=r==this.children.length?null:this.children[r];if(n==t&&(0==e||!i||!i.size||i.border||e<0&&o)||i&&i.domAtom&&t<n+i.size)return{node:this.contentDOM,offset:i?Fn(i.dom):this.contentDOM.childNodes.length};if(!i)throw new Error("Invalid position "+t);var s=n+i.size;if(!i.domAtom&&(e<0&&!i.border?s>=t:s>t)&&(s>t||r+1>=this.children.length||!this.children[r+1].beforePosition))return i.domFromPos(t-n-i.border,e);n=s}},xr.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var l=i+a.border;if(t>=l&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,l);t=i;for(var u=s;u>0;u--){var f=this.children[u-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=Fn(f.dom)+1;break}t-=f.size}-1==r&&(r=0)}if(r>-1&&(c>e||s==this.children.length-1)){e=c;for(var p=s+1;p<this.children.length;p++){var h=this.children[p];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){o=Fn(h.dom);break}e+=h.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},xr.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},xr.prototype.domAfterPos=function(t){var e=this.domFromPos(t,0),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},xr.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=l}var u=this.domFromPos(t,t?-1:1),f=e==t?u:this.domFromPos(e,e?-1:1),p=n.getSelection(),h=!1;if((Bn.gecko||Bn.safari)&&t==e){var d=u.node,m=u.offset;if(3==d.nodeType){if((h=m&&"\n"==d.nodeValue[m-1])&&m==d.nodeValue.length)for(var v=d,g=void 0;v;v=v.parentNode){if(g=v.nextSibling){"BR"==g.nodeName&&(u=f={node:g.parentNode,offset:Fn(g)+1});break}var y=v.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{var b=d.childNodes[m-1];h=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(Bn.gecko&&p.focusNode&&p.focusNode!=f.node&&1==p.focusNode.nodeType){var w=p.focusNode.childNodes[p.focusOffset];w&&"false"==w.contentEditable&&(r=!0)}if(r||h&&Bn.safari||!Kn(u.node,u.offset,p.anchorNode,p.anchorOffset)||!Kn(f.node,f.offset,p.focusNode,p.focusOffset)){var x=!1;if((p.extend||t==e)&&!h){p.collapse(u.node,u.offset);try{t!=e&&p.extend(f.node,f.offset),x=!0}catch(t){if(!(t instanceof DOMException))throw t}}if(!x){if(t>e){var k=u;u=f,f=k}var $=document.createRange();$.setEnd(f.node,f.offset),$.setStart(u.node,u.offset),p.removeAllRanges(),p.addRange($)}}},xr.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},kr.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},xr.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var s=n+o.border,a=i-o.border;if(t>=s&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=3}n=i}this.dirty=2},xr.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},kr.domAtom.get=function(){return!1},Object.defineProperties(xr.prototype,kr);var $r=[],_r=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,$r,s,null),this.widget=n,i=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0},domAtom:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(xr),Mr=function(t){function e(e,n,r,o){t.call(this,e,$r,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(xr),Sr=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=Ce.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,s.dom,s.contentDOM||s.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=Fr(i,n,s,r)),t>0&&(i=Fr(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(xr),Cr=function(t){function e(e,n,r,o,i,s,a,c,l){t.call(this,e,n.isLeaf?$r:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return e.create=function(t,n,r,o,i,s){var a,c,l=i.nodeViews[n.type.name],u=l&&l(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r,o),f=u&&u.dom,p=u&&u.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(a=Ce.renderSpec(document,n.type.spec.toDOM(n))).dom,p=a.contentDOM);p||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var h=f;return f=Pr(f,r,n),u?c=new Nr(t,n,r,o,f,p,h,u,i,s+1):n.isText?new Tr(t,n,r,o,f,h,i):new e(t,n,r,o,f,p,h,i,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?gt.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&jr(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=r&&t.composing&&this.localCompositionNode(t,e),s=new Lr(this,i&&i.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0!=o.length)for(var s=0,a=[],c=null,l=0;;){if(s<o.length&&o[s].to==i){for(var u=o[s++],f=void 0;s<o.length&&o[s].to==i;)(f||(f=[u])).push(o[s++]);if(f){f.sort(Hr);for(var p=0;p<f.length;p++)n(f[p],l,!!c)}else n(u,l,!!c)}var h=void 0,d=void 0;if(c)d=-1,h=c,c=null;else{if(!(l<t.childCount))break;d=l,h=t.child(l++)}for(var m=0;m<a.length;m++)a[m].to<=i&&a.splice(m--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);var v=i+h.nodeSize;if(h.isText){var g=v;s<o.length&&o[s].from<g&&(g=o[s].from);for(var y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<v&&(c=h.cut(g-i),h=h.cut(0,g-i),v=g,d=-1)}r(h,a.length?h.isInline&&!h.isLeaf?a.filter((function(t){return!t.inline})):a.slice():$r,e.forChild(i,h),d),i=v}else for(var b=0;b<t.childCount;b++){var w=t.child(b);r(w,o,e.forChild(i,w),b),i+=w.nodeSize}}(this.node,this.innerDeco,(function(e,i,a){e.spec.marks?s.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&!a&&s.syncToMarks(i==n.node.childCount?kt.none:n.node.child(i).marks,r,t),s.placeWidget(e,t,o)}),(function(e,n,i,a){s.syncToMarks(e.marks,r,t),s.findNodeMatch(e,n,i,a)||s.updateNextNode(e,n,i,t,a)||s.addNode(e,n,i,t,o),o+=e.nodeSize})),s.syncToMarks($r,r,t),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),Er(this.contentDOM,this.children,t),Bn.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))},e.prototype.localCompositionNode=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(!(t.state.selection instanceof vn)||r<e||o>e+this.node.content.size)){var i=t.root.getSelection(),s=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=Gn(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){var a=s.nodeValue,c=function(t,e,n,r){for(var o=0,i=0;o<t.childCount&&i<=r;){var s=t.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<t.childCount;){var l=t.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(i>=n){var u=c.lastIndexOf(e,r-a);if(u>=0&&u+e.length+a>=n)return a+u}}}return-1}(this.node.content,a,r-e,o-e);return c<0?null:{node:s,pos:c,text:a}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new Mr(this,i,n,o);t.compositionNodes.push(s),this.children=Fr(this.children,r,r+o.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,e,n,r),0))},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!jr(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Ir(this.dom,this.nodeDOM,Rr(this.outerDeco,this.node,e),Rr(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(e.prototype,n),e}(xr);function Or(t,e,n,r,o){return Pr(r,e,t),new Cr(null,t,e,n,r,r,r,o,0)}var Tr=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0}};return e.prototype.parseRule=function(){for(var t=this.nodeDOM.parentNode;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=0,0))},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},e.prototype.markDirty=function(e,n){t.prototype.markDirty.call(this,e,n),this.dom==this.nodeDOM||0!=e&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(e.prototype,n),e}(Cr),Ar=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0}};return e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(t){return 0==this.dirty&&this.dom.nodeName==t},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(xr),Nr=function(t){function e(e,n,r,o,i,s,a,c,l,u){t.call(this,e,n,r,o,i,s,a,l,u),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(Cr);function Er(t,e,n){for(var r=t.firstChild,o=!1,i=0;i<e.length;i++){var s=e[i],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=Vr(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(s instanceof Sr){var c=r?r.previousSibling:t.lastChild;Er(s.contentDOM,s.children,n),r=c?c.nextSibling:t.firstChild}}for(;r;)r=Vr(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}function Dr(t){t&&(this.nodeName=t)}Dr.prototype=Object.create(null);var zr=[new Dr];function Rr(t,e,n){if(0==t.length)return zr;for(var r=n?zr[0]:new Dr,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new Dr(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new Dr(e.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function Ir(t,e,n,r){if(n==zr&&r==zr)return e;for(var o=e,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=t&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).pmIsDeco=!0,c.appendChild(o),a=zr[0]),o=c}Br(o,a||zr[0],s)}return o}function Br(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" ").filter(Boolean):$r,s=n.class?n.class.split(" ").filter(Boolean):$r,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(e.style);)t.style.removeProperty(l[1]);n.style&&(t.style.cssText+=n.style)}}function Pr(t,e,n){return Ir(t,t,zr,Rr(e,n,1!=t.nodeType))}function jr(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Vr(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var Lr=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(t,e){for(var n=t.childCount,r=e.length,o=new Map;n>0&&r>0;r--){var i=e[r-1],s=i.node;if(s){if(s!=t.child(n-1))break;--n,o.set(i,n)}}return{index:n,matched:o}}(t.node.content,t.children)};function Hr(t,e){return t.type.side-e.type.side}function Fr(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],l=a,u=a+=c.size;l>=n||u<=e?i.push(c):(l<e&&i.push(c.slice(0,e-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function Wr(t,e){var n=t.root.getSelection(),r=t.state.doc;if(!n.focusNode)return null;var o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,l=r.resolve(s);if(Xn(n)){for(a=l;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&yn.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(t,e,n){for(var r=0==e,o=e==Gn(t);r||o;){if(t==n)return!0;var i=Fn(t);if(!(t=t.parentNode))return!1;r=r&&0==i,o=o&&i==Gn(t)}}(n.focusNode,n.focusOffset,o.dom))){var u=o.posBefore;c=new yn(s==u?l:r.resolve(u))}}else{var f=t.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;a=r.resolve(f)}return c||(c=Qr(t,a,l,"pointer"==e||t.state.selection.head<l.pos&&!i?1:-1)),c}function qr(t){return t.editable?t.hasFocus():to(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Jr(t,e){var n=t.state.selection;if(Zr(t,n),qr(t)){if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,Fn(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&Bn.ie&&Bn.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{var r,o,i=n.anchor,s=n.head;!Kr||n instanceof vn||(n.$from.parent.inlineContent||(r=Ur(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=Ur(t,n.to))),t.docView.setSelection(i,s,t.root,e),Kr&&(r&&Gr(r),o&&Gr(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),setTimeout((function(){qr(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")}),20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}Lr.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},Lr.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Lr.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=Sr.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},Lr.prototype.findNodeMatch=function(t,e,n,r){var o=this.top.children,i=-1;if(r>=this.preMatch.index){for(var s=this.index;s<o.length;s++)if(o[s].matchesNode(t,e,n)){i=s;break}}else for(var a=this.index,c=Math.min(o.length,a+1);a<c;a++){var l=o[a];if(l.matchesNode(t,e,n)&&!this.preMatch.matched.has(l)){i=a;break}}return!(i<0||(this.destroyBetween(this.index,i),this.index++,0))},Lr.prototype.updateNextNode=function(t,e,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof Cr){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;var c=s.dom;if((!this.lock||!(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))||t.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==t.text&&3!=s.dirty&&jr(e,s.outerDeco))&&s.update(t,e,n,r))return this.destroyBetween(this.index,i),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},Lr.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,Cr.create(this.top,t,e,n,r,o)),this.changed=!0},Lr.prototype.placeWidget=function(t,e,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){var o=new _r(this.top,t,e,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},Lr.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof Sr;)t=t.children[t.children.length-1];t&&t instanceof Tr&&!/\n$/.test(t.node.text)||(Bn.safari&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},Lr.prototype.addHackNode=function(t){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(t))this.index++;else{var e=document.createElement(t);this.top.children.splice(this.index++,0,new Ar(this.top,$r,e,null)),this.changed=!0}};var Kr=Bn.safari||Bn.chrome&&Bn.chrome_version<63;function Ur(t,e){var n=t.docView.domFromPos(e,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(Bn.safari&&i&&"false"==i.contentEditable)return Yr(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return Yr(i);if(s)return Yr(s)}}function Yr(t){return t.contentEditable="true",Bn.safari&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Gr(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Zr(t,e){if(e instanceof yn){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Xr(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Xr(t)}function Xr(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function Qr(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||vn.between(e,n,r)}function to(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function eo(t,e){var n=t.selection,r=n.$anchor,o=n.$head,i=e>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&hn.findFrom(s,e)}function no(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ro(t,e,n){var r=t.state.selection;if(!(r instanceof vn)){if(r instanceof yn&&r.node.isInline)return no(t,new vn(e>0?r.$to:r.$from));var o=eo(t.state,e);return!!o&&no(t,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var i=eo(t.state,e);return!!(i&&i instanceof yn)&&no(t,i)}if(!(Bn.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var l=e<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=t.docView.descAt(l))&&!s.contentDOM)&&(yn.isSelectable(c)?no(t,new yn(e<0?t.state.doc.resolve(a.pos-c.nodeSize):a)):!!Bn.webkit&&no(t,new vn(t.state.doc.resolve(e<0?l:l+c.nodeSize))))}}function oo(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function io(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function so(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,s=!1;for(Bn.gecko&&1==n.nodeType&&r<oo(n)&&io(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(io(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(co(n))break;for(var c=n.previousSibling;c&&io(c);)o=n.parentNode,i=Fn(c),c=c.previousSibling;if(c)r=oo(n=c);else{if((n=n.parentNode)==t.dom)break;r=0}}s?lo(t,e,n,r):o&&lo(t,e,o,i)}}function ao(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=oo(n);;)if(r<s){if(1!=n.nodeType)break;if(!io(n.childNodes[r]))break;o=n,i=++r}else{if(co(n))break;for(var a=n.nextSibling;a&&io(a);)o=a.parentNode,i=Fn(a)+1,a=a.nextSibling;if(a)r=0,s=oo(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&lo(t,e,o,i)}}function co(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function lo(t,e,n,r){if(Xn(e)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection();var i=t.state;setTimeout((function(){t.state==i&&Jr(t)}),50)}function uo(t,e,n){var r=t.state.selection;if(r instanceof vn&&!r.empty||n.indexOf("s")>-1)return!1;if(Bn.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var s=eo(t.state,e);if(s&&s instanceof yn)return no(t,s)}if(!o.parent.inlineContent){var a=e<0?o:i,c=r instanceof wn?hn.near(a,e):hn.findFrom(a,e);return!!c&&no(t,c)}return!1}function fo(t,e){if(!(t.state.selection instanceof vn))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var s=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=t.state.tr;return e<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),t.dispatch(a),!0}return!1}function po(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function ho(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Bn.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||Bn.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function mo(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Qr(t,e.resolve(n.anchor),e.resolve(n.head))}function vo(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function go(t,e){for(var n=[],r=e.content,o=e.openStart,i=e.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||Ce.fromSchema(t.state.schema),c=Mo(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u,f=l.firstChild;f&&1==f.nodeType&&(u=$o[f.nodeName.toLowerCase()]);){for(var p=u.length-1;p>=0;p--){for(var h=c.createElement(u[p]);l.firstChild;)h.appendChild(l.firstChild);l.appendChild(h)}f=l.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function yo(t,e,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!e)return null;var c=e&&(r||a||!n);if(c){if(t.someProp("transformPastedText",(function(t){e=t(e,a||r)})),a)return new _t(gt.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0);var l=t.someProp("clipboardTextParser",(function(t){return t(e,o,r)}));l?s=l:(i=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){i.appendChild(document.createElement("p")).textContent=t})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),i=function(t){var e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Mo().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(t);if((n=o&&$o[o[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join("")),r.innerHTML=t,n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n);var u=i&&i.querySelector("[data-pm-slice]"),f=u&&/^(\d+) (\d+) (.*)/.exec(u.getAttribute("data-pm-slice"));if(!s){var p=t.someProp("clipboardParser")||t.someProp("domParser")||ve.fromSchema(t.state.schema);s=p.parseSlice(i,{preserveWhitespace:!(!c&&!f),context:o})}return s=f?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var o=t.content,i=t.openStart,s=t.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=gt.from(c.create(n[a+1],o)),i++,s++}return new _t(o,i,s)}(function(t,e,n){return e<t.openStart&&(t=new _t(ko(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new _t(ko(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}(s,+f[1],+f[2]),f[3]):_t.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,i=[];if(t.forEach((function(t){if(i){var e,n=r.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&o.length&&wo(n,o,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=xo(i[i.length-1],o.length));var s=bo(t,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:gt.from(i)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(s.content,o),!1),t.someProp("transformPasted",(function(t){s=t(s)})),s}function bo(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,gt.from(t));return t}function wo(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){var i=wo(t,e,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(gt.from(bo(n,t,o+1))))}}function xo(t,e){if(0==e)return t;var n=t.content.replaceChild(t.childCount-1,xo(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(gt.empty,!0);return t.copy(n.append(r))}function ko(t,e,n,r,o,i){var s=e<0?t.firstChild:t.lastChild,a=s.content;return o<r-1&&(a=ko(a,e,n,r,o+1,i)),o>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,t.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(gt.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}var $o={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},_o=null;function Mo(){return _o||(_o=document.implementation.createHTMLDocument("title"))}var So={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Co=Bn.ie&&Bn.ie_version<=11,Oo=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Oo.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},Oo.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var To=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);Bn.ie&&Bn.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Oo,Co&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};To.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},To.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},To.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,So),Co&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},To.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}Co&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},To.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},To.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},To.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},To.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&to(t)){var t;if(this.suppressingSelectionUpdates)return Jr(this.view);if(Bn.ie&&Bn.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&Kn(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},To.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},To.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},To.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&to(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<t.length;a++){var c=this.registerMutation(t[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(i=!0))}if(Bn.gecko&&s.length>1){var l=s.filter((function(t){return"BR"==t.nodeName}));if(2==l.length){var u=l[0],f=l[1];u.parentNode&&u.parentNode.parentNode==f.parentNode?f.remove():u.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),p=this.view,Ao||(Ao=!0,"normal"==getComputedStyle(p.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(r,o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Jr(this.view),this.currentSelection.set(e))}var p},To.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(var r=0;r<t.addedNodes.length;r++)e.push(t.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};var o=t.previousSibling,i=t.nextSibling;if(Bn.ie&&Bn.ie_version<=11&&t.addedNodes.length)for(var s=0;s<t.addedNodes.length;s++){var a=t.addedNodes[s],c=a.previousSibling,l=a.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(o=c),(!l||Array.prototype.indexOf.call(t.addedNodes,l)<0)&&(i=l)}var u=o&&o.parentNode==t.target?Fn(o)+1:0,f=n.localPosFromDOM(t.target,u,-1),p=i&&i.parentNode==t.target?Fn(i):t.target.childNodes.length;return{from:f,to:n.localPosFromDOM(t.target,p,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var Ao=!1,No={},Eo={};function Do(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function zo(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return Ro(t,e)})}))}function Ro(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function Io(t){return{left:t.clientX,top:t.clientY}}function Bo(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function Po(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function jo(t,e,n,r){return Bo(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function Vo(t,e,n,r){return Bo(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||function(t,e,n){if(0!=n.button)return!1;var r=t.state.doc;if(-1==e)return!!r.inlineContent&&(Po(t,vn.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(e),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)Po(t,vn.create(r,a+1,a+1+s.content.size),"pointer");else{if(!yn.isSelectable(s))continue;Po(t,yn.create(r,a),"pointer")}return!0}}(t,n,r)}function Lo(t){return Uo(t)}Eo.keydown=function(t,e){if(t.shiftKey=16==e.keyCode||e.shiftKey,!Wo(t,e))if(229!=e.keyCode&&t.domObserver.forceFlush(),t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),!Bn.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)t.someProp("handleKeyDown",(function(n){return n(t,e)}))||function(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||Bn.mac&&72==n&&"c"==r?fo(t,-1)||so(t):46==n||Bn.mac&&68==n&&"c"==r?fo(t,1)||ao(t):13==n||27==n||(37==n?ro(t,-1,r)||so(t):39==n?ro(t,1,r)||ao(t):38==n?uo(t,-1,r)||so(t):40==n?function(t){if(Bn.safari&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;po(t,o,!0),setTimeout((function(){return po(t,o,!1)}),20)}}}(t)||uo(t,1,r)||ao(t):r==(Bn.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}(t,e)?e.preventDefault():Do(t,"key");else{var n=Date.now();t.lastIOSEnter=n,t.lastIOSEnterFallbackTimeout=setTimeout((function(){t.lastIOSEnter==n&&(t.someProp("handleKeyDown",(function(e){return e(t,Qn(13,"Enter"))})),t.lastIOSEnter=0)}),200)}},Eo.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},Eo.keypress=function(t,e){if(!(Wo(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||Bn.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof vn&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()}}};var Ho=Bn.mac?"metaKey":"ctrlKey";No.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=Lo(t),r=Date.now(),o="singleClick";r-t.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(e,t.lastClick)&&!e[Ho]&&("singleClick"==t.lastClick.type?o="doubleClick":"doubleClick"==t.lastClick.type&&(o="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:o};var i=t.posAtCoords(Io(e));i&&("singleClick"==o?(t.mouseDown&&t.mouseDown.done(),t.mouseDown=new Fo(t,i,e,n)):("doubleClick"==o?jo:Vo)(t,i.pos,i.inside,e)?e.preventDefault():Do(t,"pointer"))};var Fo=function(t,e,n,r){var o,i,s=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[Ho],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),i=e.inside;else{var a=t.state.doc.resolve(e.pos);o=a.parent,i=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,l=c?t.docView.nearestDesc(c,!0):null;this.target=l?l.dom:null;var u=t.state.selection;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||u instanceof yn&&u.from<=i&&u.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Bn.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){s.view.mouseDown==s&&s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Do(t,"pointer")};function Wo(t,e){return!!t.composing||!!(Bn.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}Fo.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},Fo.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Io(t))),this.allowDefault||!e?Do(this.view,"pointer"):function(t,e,n,r,o){return Bo(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(o?function(t,e){if(-1==e)return!1;var n,r,o=t.state.selection;o instanceof yn&&(n=o.node);for(var i=t.state.doc.resolve(e),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(yn.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(Po(t,yn.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&yn.isSelectable(r))&&(Po(t,new yn(n),"pointer"),!0)}(t,n))}(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Bn.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Bn.chrome&&!(this.view.state.selection instanceof vn)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Po(this.view,hn.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):Do(this.view,"pointer")}},Fo.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),Do(this.view,"pointer"),0==t.buttons&&this.done()},No.touchdown=function(t){Lo(t),Do(t,"pointer")},No.contextmenu=function(t){return Lo(t)};var qo=Bn.android?5e3:-1;function Jo(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return Uo(t)}),e))}function Ko(t){for(t.composing=!1;t.compositionNodes.length>0;)t.compositionNodes.pop().markParentsDirty()}function Uo(t,e){if(t.domObserver.forceFlush(),Ko(t),e||t.docView.dirty){var n=Wr(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}Eo.compositionstart=Eo.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),Uo(t,!0),t.markCursor=null;else if(Uo(t),Bn.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}t.composing=!0}Jo(t,qo)},Eo.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,Jo(t,20))};var Yo=Bn.ie&&Bn.ie_version<15||Bn.ios&&Bn.webkit_version<604;function Go(t,e,n,r){var o=yo(t,e,n,t.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",(function(e){return e(t,r,o||_t.empty)})))return!0;if(!o)return!1;var i=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),s=i?t.state.tr.replaceSelectionWith(i,t.shiftKey):t.state.tr.replaceSelection(o);return t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}No.copy=Eo.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var o=Yo?null:e.clipboardData,i=go(t,n.content()),s=i.dom,a=i.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(t,e){if(t.dom.parentNode){var n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),t.focus()}),50)}}(t,s),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Eo.paste=function(t,e){var n=Yo?null:e.clipboardData;n&&Go(t,n.getData("text/plain"),n.getData("text/html"),e)?e.preventDefault():function(t,e){if(t.dom.parentNode){var n=t.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Go(t,r.value,null,e):Go(t,r.textContent,r.innerHTML,e)}),50)}}(t,e)};var Zo=function(t,e){this.slice=t,this.move=e},Xo=Bn.mac?"altKey":"ctrlKey";for(var Qo in No.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var r=t.state.selection,o=r.empty?null:t.posAtCoords(Io(e));if(o&&o.pos>=r.from&&o.pos<=(r instanceof yn?r.to-1:r.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(yn.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var i=t.docView.nearestDesc(e.target,!0);if(!i||!i.node.type.spec.draggable||i==t.docView)return;t.dispatch(t.state.tr.setSelection(yn.create(t.state.doc,i.posBefore)))}var s=t.state.selection.content(),a=go(t,s),c=a.dom,l=a.text;e.dataTransfer.clearData(),e.dataTransfer.setData(Yo?"Text":"text/html",c.innerHTML),e.dataTransfer.effectAllowed="copyMove",Yo||e.dataTransfer.setData("text/plain",l),t.dragging=new Zo(s,!e[Xo])}},No.dragend=function(t){var e=t.dragging;window.setTimeout((function(){t.dragging==e&&(t.dragging=null)}),50)},Eo.dragover=Eo.dragenter=function(t,e){return e.preventDefault()},Eo.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var r=t.posAtCoords(Io(e));if(r){var o=t.state.doc.resolve(r.pos);if(o){var i=n&&n.slice;i?t.someProp("transformPasted",(function(t){i=t(i)})):i=yo(t,e.dataTransfer.getData(Yo?"Text":"text/plain"),Yo?null:e.dataTransfer.getData("text/html"),!1,o);var s=n&&!e[Xo];if(t.someProp("handleDrop",(function(n){return n(t,e,i||_t.empty,s)})))e.preventDefault();else if(i){e.preventDefault();var a=i?Ze(t.state.doc,o.pos,i):o.pos;null==a&&(a=o.pos);var c=t.state.tr;s&&c.deleteSelection();var l=c.mapping.map(a),u=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=c.doc;if(u?c.replaceRangeWith(l,l,i.content.firstChild):c.replaceRange(l,l,i),!c.doc.eq(f)){var p=c.doc.resolve(l);if(u&&yn.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new yn(p));else{var h=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(t,e,n,r){return h=r})),c.setSelection(Qr(t,p,c.doc.resolve(h)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}}}}}},No.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.root.getSelection())&&Jr(t)}),20))},No.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},No.beforeinput=function(t,e){if(Bn.chrome&&Bn.android&&"deleteContentBackward"==e.inputType){var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,Qn(8,"Backspace"))})))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}}),50)}},Eo)No[Qo]=Eo[Qo];function ti(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var ei=function(t,e){this.spec=e||ai,this.side=this.spec.side||0,this.toDOM=t};ei.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new oi(i-n,i-n,this)},ei.prototype.valid=function(){return!0},ei.prototype.eq=function(t){return this==t||t instanceof ei&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&ti(this.spec,t.spec))};var ni=function(t,e){this.spec=e||ai,this.attrs=t};ni.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new oi(o,i,this)},ni.prototype.valid=function(t,e){return e.from<e.to},ni.prototype.eq=function(t){return this==t||t instanceof ni&&ti(this.attrs,t.attrs)&&ti(this.spec,t.spec)},ni.is=function(t){return t.type instanceof ni};var ri=function(t,e){this.spec=e||ai,this.attrs=t};ri.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new oi(o.pos-n,i.pos-n,this)},ri.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index,o=n.offset;return o==e.from&&o+t.child(r).nodeSize==e.to},ri.prototype.eq=function(t){return this==t||t instanceof ri&&ti(this.attrs,t.attrs)&&ti(this.spec,t.spec)};var oi=function(t,e,n){this.from=t,this.to=e,this.type=n},ii={spec:{configurable:!0},inline:{configurable:!0}};oi.prototype.copy=function(t,e){return new oi(t,e,this.type)},oi.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},oi.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},oi.widget=function(t,e,n){return new oi(t,t,new ei(e,n))},oi.inline=function(t,e,n,r){return new oi(t,e,new ni(n,r))},oi.node=function(t,e,n,r){return new oi(t,e,new ri(n,r))},ii.spec.get=function(){return this.type.spec},ii.inline.get=function(){return this.type instanceof ni},Object.defineProperties(oi.prototype,ii);var si=[],ai={},ci=function(t,e){this.local=t&&t.length?t:si,this.children=e&&e.length?e:si};ci.create=function(t,e){return e.length?di(e,t,0,ai):li},ci.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},ci.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,o)}},ci.prototype.map=function(t,e,n){return this==li||0==t.maps.length?this:this.mapInner(t,e,0,0,n||ai)},ci.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||t>c+i||(e>=a[s]+i?a[s+1]=-1:n>=o&&(l=r-n-(e-t))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,f=0;f<a.length;f+=3)if(-1==a[f+1]){var p=n.map(t[f]+i),h=p-o;if(h<0||h>=r.content.size){u=!0;continue}var d=n.map(t[f+1]+i,-1)-o,m=r.content.findIndex(h),v=m.index,g=m.offset,y=r.maybeChild(v);if(y&&g==h&&g+y.nodeSize==d){var b=a[f+2].mapInner(n,y,p+1,t[f]+i+1,s);b!=li?(a[f]=h,a[f+1]=d,a[f+2]=b):(a[f+1]=-2,u=!0)}else u=!0}if(u){var w=di(function(t,e,n,r,o,i,s){function a(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[i].spec)}for(var l=0;l<t.children.length;l+=3)a(t.children[l+2],t.children[l]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=w.local;for(var x=0;x<a.length;x+=3)a[x+1]<0&&(a.splice(x,3),x-=3);for(var k=0,$=0;k<w.children.length;k+=3){for(var _=w.children[k];$<a.length&&a[$]<_;)$+=3;a.splice($,0,w.children[k],w.children[k+1],w.children[k+2])}}return new ci(e&&e.sort(mi),a)}(this.children,i,t,e,n,r,o):i?new ci(i.sort(mi)):li},ci.prototype.add=function(t,e){return e.length?this==li?ci.create(t,e):this.addInner(t,e,0):this},ci.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=pi(e,t,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,di(a,t,c+1,ai)),i+=3}}));for(var s=fi(i?hi(e):e,-n),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new ci(s.length?this.local.concat(s).sort(mi):this.local,r||this.children)},ci.prototype.remove=function(t){return 0==t.length||this==li?this:this.removeInner(t,0)},ci.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+e,a=n[o+1]+e,c=0,l=void 0;c<t.length;c++)(l=t[c])&&l.from>s&&l.to<a&&(t[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=li?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,p=void 0;f<t.length;f++)if(p=t[f])for(var h=0;h<r.length;h++)r[h].eq(p,e)&&(r==this.local&&(r=this.local.slice()),r.splice(h--,1));return n==this.children&&r==this.local?this:r.length||n.length?new ci(r,n):li},ci.prototype.forChild=function(t,e){if(this==li)return this;if(e.isLeaf)return ci.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof ni){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var f=new ci(r.sort(mi));return n?new ui([f,n]):f}return n||li},ci.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof ci)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},ci.prototype.locals=function(t){return vi(this.localsInner(t))},ci.prototype.localsInner=function(t){if(this==li)return si;if(t.inlineContent||!this.local.some(ni.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof ni||e.push(this.local[n]);return e};var li=new ci;ci.empty=li,ci.removeOverlap=vi;var ui=function(t){this.members=t};function fi(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new oi(o.from+e,o.to+e,o.type))}return n}function pi(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,s=void 0;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),t[i]=null);return o}function hi(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function di(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=pi(t,e,s+n);if(a){i=!0;var c=di(a,e,n+s+1,r);c!=li&&o.push(s,s+e.nodeSize,c)}}));for(var s=fi(i?hi(t):t,-n).sort(mi),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new ci(s,o):li}function mi(t,e){return t.from-e.from||t.to-e.to}function vi(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),gi(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),gi(e,o+1,i.copy(r.to,i.to)))}}return e}function gi(t,e,n){for(;e<t.length&&mi(n,t[e])>0;)e++;t.splice(e,0,n)}function yi(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=li&&e.push(r)})),t.cursorWrapper&&e.push(ci.create(t.state.doc,[t.cursorWrapper.deco])),ui.from(e)}ui.prototype.forChild=function(t,e){if(e.isLeaf)return ci.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=li&&(o instanceof ui?n=n.concat(o.members):n.push(o))}return ui.from(n)},ui.prototype.eq=function(t){if(!(t instanceof ui)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},ui.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?vi(n?e:e.sort(mi)):si},ui.from=function(t){switch(t.length){case 0:return li;case 1:return t[0];default:return new ui(t)}};var bi=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=$i(this),this.markCursor=null,this.cursorWrapper=null,ki(this),this.nodeViews=_i(this),this.docView=Or(this.state.doc,xi(this),yi(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.lastIOSEnter=0,t.lastIOSEnterFallbackTimeout=null,t.lastAndroidDelete=0,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new To(t,(function(e,n,r,o){return function(t,e,n,r,o){if(e<0){var i=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,s=Wr(t,i);if(s&&!t.state.selection.eq(s)){var a=t.state.tr.setSelection(s);"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),t.dispatch(a)}}else{var c=t.state.doc.resolve(e),l=c.sharedDepth(n);e=c.before(l+1),n=t.state.doc.resolve(n).after(l+1);var u=t.state.selection,f=function(t,e,n){var r=t.docView.parseRange(e,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=t.root.getSelection(),u=null,f=l.anchorNode;if(f&&t.dom.contains(1==f.nodeType?f:f.parentNode)&&(u=[{node:f,offset:l.anchorOffset}],Xn(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Bn.chrome&&8===t.lastKeyCode)for(var p=s;p>i;p--){var h=o.childNodes[p-1],d=h.pmViewDesc;if("BR"==h.nodeName&&!d){s=p;break}if(!d||d.size)break}var m=t.state.doc,v=t.someProp("domParser")||ve.fromSchema(t.state.schema),g=m.resolve(a),y=null,b=v.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:ho,context:g});if(u&&null!=u[0].pos){var w=u[0].pos,x=u[1]&&u[1].pos;null==x&&(x=w),y={anchor:w+a,head:x+a}}return{doc:b,sel:y,from:a,to:c}}(t,e,n);if(Bn.chrome&&t.cursorWrapper&&f.sel&&f.sel.anchor==t.cursorWrapper.deco.from){var p=t.cursorWrapper.deco.type.toDOM.nextSibling,h=p&&p.nodeValue?p.nodeValue.length:1;f.sel={anchor:f.sel.anchor+h,head:f.sel.anchor+h}}var d,m,v=t.state.doc,g=v.slice(f.from,f.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(d=t.state.selection.to,m="end"):(d=t.state.selection.from,m="start"),t.lastKeyCode=null;var y=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;return"end"==o&&(r-=a+Math.max(0,i-Math.min(a,c))-i),a<i&&t.size<e.size?(c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i):c<i&&(a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i),{start:i,endA:a,endB:c}}(g.content,f.doc.content,f.from,d,m);if(!y){if(!(r&&u instanceof vn&&!u.empty&&u.$head.sameParent(u.$anchor))||t.composing||f.sel&&f.sel.anchor!=f.sel.head){if((Bn.ios&&t.lastIOSEnter>Date.now()-225||Bn.android)&&o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName}))&&t.someProp("handleKeyDown",(function(e){return e(t,Qn(13,"Enter"))})))return void(t.lastIOSEnter=0);if(f.sel){var b=mo(t,t.state.doc,f.sel);b&&!b.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(b))}return}y={start:u.from,endA:u.to,endB:u.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&y.start==y.endB&&t.state.selection instanceof vn&&(y.start>t.state.selection.from&&y.start<=t.state.selection.from+2?y.start=t.state.selection.from:y.endA<t.state.selection.to&&y.endA>=t.state.selection.to-2&&(y.endB+=t.state.selection.to-y.endA,y.endA=t.state.selection.to)),Bn.ie&&Bn.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>f.from&&"  "==f.doc.textBetween(y.start-f.from-1,y.start-f.from+1)&&(y.start--,y.endA--,y.endB--);var w,x=f.doc.resolveNoCache(y.start-f.from),k=f.doc.resolveNoCache(y.endB-f.from),$=x.sameParent(k)&&x.parent.inlineContent;if((Bn.ios&&t.lastIOSEnter>Date.now()-225&&(!$||o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName})))||!$&&x.pos<f.doc.content.size&&(w=hn.findFrom(f.doc.resolve(x.pos+1),1,!0))&&w.head==k.pos)&&t.someProp("handleKeyDown",(function(e){return e(t,Qn(13,"Enter"))})))t.lastIOSEnter=0;else if(t.state.selection.anchor>y.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||vo(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(vo(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||vo(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(v,y.start,y.endA,x,k)&&t.someProp("handleKeyDown",(function(e){return e(t,Qn(8,"Backspace"))})))Bn.android&&Bn.chrome&&t.domObserver.suppressSelectionUpdates();else{Bn.chrome&&Bn.android&&y.toB==y.from&&(t.lastAndroidDelete=Date.now()),Bn.android&&!$&&x.start()!=k.start()&&0==k.parentOffset&&x.depth==k.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==y.endA&&(y.endB-=2,k=f.doc.resolveNoCache(y.endB-f.from),setTimeout((function(){t.someProp("handleKeyDown",(function(e){return e(t,Qn(13,"Enter"))}))}),20));var _,M,S,C,O=y.start,T=y.endA;if($)if(x.pos==k.pos)Bn.ie&&Bn.ie_version<=11&&0==x.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Jr(t)}),20)),_=t.state.tr.delete(O,T),M=v.resolve(y.start).marksAcross(v.resolve(y.endA));else if(y.endA==y.endB&&(C=v.resolve(y.start))&&(S=function(t,e){for(var n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,a=i,c=s,l=0;l<s.length;l++)a=s[l].removeFromSet(a);for(var u=0;u<i.length;u++)c=i[u].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var f=[],p=0;p<e.childCount;p++)f.push(o(e.child(p)));if(gt.from(f).eq(t))return{mark:r,type:n}}(x.parent.content.cut(x.parentOffset,k.parentOffset),C.parent.content.cut(C.parentOffset,y.endA-C.start()))))_=t.state.tr,"add"==S.type?_.addMark(O,T,S.mark):_.removeMark(O,T,S.mark);else if(x.parent.child(x.index()).isText&&x.index()==k.index()-(k.textOffset?0:1)){var A=x.parent.textBetween(x.parentOffset,k.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,O,T,A)})))return;_=t.state.tr.insertText(A,O,T)}if(_||(_=t.state.tr.replace(O,T,f.doc.slice(y.start-f.from,y.endB-f.from))),f.sel){var N=mo(t,_.doc,f.sel);N&&!(Bn.chrome&&Bn.android&&t.composing&&N.empty&&(y.start!=y.endB||t.lastAndroidDelete<Date.now()-100)&&(N.head==O||N.head==_.mapping.map(T)-1)||Bn.ie&&N.empty&&N.head==O)&&_.setSelection(N)}M&&_.ensureMarks(M),t.dispatch(_.scrollIntoView())}}}(t,e,n,r,o)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=No[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||Ro(t,e)||!t.editable&&e.type in Eo||n(t,e)})};for(var n in No)e(n);Bn.safari&&t.dom.addEventListener("input",(function(){return null})),zo(t)}(this),this.pluginViews=[],this.updatePluginViews()},wi={props:{configurable:!0},root:{configurable:!0}};function xi(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[oi.node(0,t.state.doc.content.size,e)]}function ki(t){if(t.markCursor){var e=document.createElement("img");e.setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:e,deco:oi.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function $i(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function _i(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}wi.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},bi.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&zo(this),this._props=t,this.updateStateInner(t.state,!0)},bi.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},bi.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},bi.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1,i=!1;if(t.storedMarks&&this.composing&&(Ko(this),i=!0),this.state=t,e){var s=_i(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),zo(this)}this.editable=$i(this),ki(this);var a=yi(this),c=xi(this),l=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(t.doc,c,a);!u&&t.selection.eq(r.selection)||(i=!0);var f,p,h,d,m,v,g,y,b,w,x="preserve"==l&&i&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:or(t.dom)}}(this);if(i){this.domObserver.stop();var k=u&&(Bn.ie||Bn.chrome)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&(d=r.selection,m=t.selection,v=Math.min(d.$anchor.sharedDepth(d.head),m.$anchor.sharedDepth(m.head)),d.$anchor.start(v)!=m.$anchor.start(v));if(u){var $=Bn.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(t.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Or(t.doc,c,a,this.dom,this)),$&&!this.trackWrites&&(k=!0)}k||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(f=this,p=f.docView.domFromPos(f.state.selection.anchor,0),h=f.root.getSelection(),Kn(p.node,p.offset,h.anchorNode,h.anchorOffset)))?Jr(this,k):(Zr(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==l)this.dom.scrollTop=0;else if("to selection"==l){var _=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof yn?rr(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),_):rr(this,this.coordsAtPos(t.selection.head,1),_))}else x&&(y=(g=x).refDOM,b=g.refTop,ir(g.stack,0==(w=y?y.getBoundingClientRect().top:0)?0:w-b))},bi.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},bi.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},bi.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},bi.prototype.hasFocus=function(){return this.root.activeElement==this.dom},bi.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(sr)return t.focus(sr);var e=or(t);t.focus(null==sr?{get preventScroll(){return sr={preventScroll:!0},!0}}:void 0),sr||(sr=!1,ir(e,0))}(this.dom),Jr(this),this.domObserver.start()},wi.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},bi.prototype.posAtCoords=function(t){return ur(this,t)},bi.prototype.coordsAtPos=function(t,e){return void 0===e&&(e=1),hr(this,t,e)},bi.prototype.domAtPos=function(t,e){return void 0===e&&(e=0),this.docView.domFromPos(t,e)},bi.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},bi.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},bi.prototype.endOfTextblock=function(t,e){return function(t,e,n){return yr==e&&br==n?wr:(yr=e,br=n,wr="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$from:r.$to;return vr(t,e,(function(){for(var e=t.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.dom;break}e=r.dom.parentNode}for(var i=hr(t,o.pos,1),s=e.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=Jn(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top&&("up"==n?l.bottom<i.top+1:l.top>i.bottom-1))return!1}}return!0}))}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=getSelection();return gr.test(r.parent.textContent)&&a.modify?vr(t,e,(function(){var e=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(e),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(t,e,n))}(this,e||this.state,t)},bi.prototype.destroy=function(){this.docView&&(function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout),clearTimeout(t.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],yi(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},bi.prototype.dispatchEvent=function(t){return function(t,e){Ro(t,e)||!No[e.type]||!t.editable&&e.type in Eo||No[e.type](t,e)}(this,t)},bi.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(bi.prototype,wi);for(var Mi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},Si={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Ci="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Oi="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),Ti="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Ai="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Ni="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ei=Ci&&(Ai||+Ci[1]<57)||Ti&&Ai,Di=0;Di<10;Di++)Mi[48+Di]=Mi[96+Di]=String(Di);for(Di=1;Di<=24;Di++)Mi[Di+111]="F"+Di;for(Di=65;Di<=90;Di++)Mi[Di]=String.fromCharCode(Di+32),Si[Di]=String.fromCharCode(Di);for(var zi in Mi)Si.hasOwnProperty(zi)||(Si[zi]=Mi[zi]);var Ri="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function Ii(t){var e,n,r,o,i=t.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(var a=0;a<i.length-1;a++){var c=i[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))e=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);Ri?o=!0:n=!0}}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function Bi(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey&&(t="Shift-"+t),t}function Pi(t){var e=function(t){var e=Object.create(null);for(var n in t)e[Ii(n)]=t[n];return e}(t);return function(t,n){var r,o=function(t){var e=!(Ei&&(t.ctrlKey||t.altKey||t.metaKey)||(Oi||Ni)&&t.shiftKey&&t.key&&1==t.key.length)&&t.key||(t.shiftKey?Si:Mi)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),i=1==o.length&&" "!=o,s=e[Bi(o,n,!i)];if(s&&s(t.state,t.dispatch,t))return!0;if(i&&(n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(r=Mi[n.keyCode])&&r!=o){var a=e[Bi(r,n,!0)];if(a&&a(t.state,t.dispatch,t))return!0}else if(i&&n.shiftKey){var c=e[Bi(o,n,!0)];if(c&&c(t.state,t.dispatch,t))return!0}return!1}}var ji=function(t,e){var n;this.match=t,this.handler="string"==typeof e?(n=e,function(t,e,r,o){var i=n;if(e[1]){var s=e[0].lastIndexOf(e[1]);i+=e[0].slice(s+e[1].length);var a=(r+=s)-o;a>0&&(i=e[0].slice(s-a,s)+i,r=o)}return t.tr.insertText(i,r,o)}):e};function Vi(t,e,n,r,o,i){if(t.composing)return!1;var s=t.state,a=s.doc.resolve(e);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"￼")+r,l=0;l<o.length;l++){var u=o[l].match.exec(c),f=u&&o[l].handler(s,u,e-(u[0].length-r.length),n);if(f)return t.dispatch(f.setMeta(i,{transform:f,from:e,to:n,text:r})),!0}return!1}function Li(t,e,n,r){return new ji(t,(function(t,o,i,s){var a=n instanceof Function?n(o):n,c=t.tr.delete(i,s),l=c.doc.resolve(i).blockRange(),u=l&&Ke(l,e,a);if(!u)return null;c.wrap(l,u);var f=c.doc.resolve(i-1).nodeBefore;return f&&f.type==e&&Ge(c.doc,i-1)&&(!r||r(o,f))&&c.join(i-1),c}))}function Hi(t,e,n){return new ji(t,(function(t,r,o,i){var s=t.doc.resolve(o),a=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e)?t.tr.delete(o,i).setBlockType(o,o,e,a):null}))}function Fi(t,e){return!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0)}function Wi(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0))return!1;var o=Ki(r);if(!o){var i=r.blockRange(),s=i&&Je(i);return null!=s&&(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)}var a=o.nodeBefore;if(!a.type.spec.isolating&&is(t,o,e))return!0;if(0==r.parent.content.size&&(qi(a,"end")||yn.isSelectable(a))){if(e){var c=t.tr.deleteRange(r.before(),r.after());c.setSelection(qi(a,"end")?hn.findFrom(c.doc.resolve(c.mapping.map(o.pos,-1)),-1):yn.create(c.doc,o.pos-a.nodeSize)),e(c.scrollIntoView())}return!0}return!(!a.isAtom||o.depth!=r.depth-1||(e&&e(t.tr.delete(o.pos-a.nodeSize,o.pos).scrollIntoView()),0))}function qi(t,e,n){for(;t;t="start"==e?t.firstChild:t.lastChild){if(t.isTextblock)return!0;if(n&&1!=t.childCount)return!1}return!1}function Ji(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):o.parentOffset>0)return!1;i=Ki(o)}var s=i&&i.nodeBefore;return!(!s||!yn.isSelectable(s)||(e&&e(t.tr.setSelection(yn.create(t.doc,i.pos-s.nodeSize)).scrollIntoView()),0))}function Ki(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Ui(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;var o=Gi(r);if(!o)return!1;var i=o.nodeAfter;if(is(t,o,e))return!0;if(0==r.parent.content.size&&(qi(i,"start")||yn.isSelectable(i))){if(e){var s=t.tr.deleteRange(r.before(),r.after());s.setSelection(qi(i,"start")?hn.findFrom(s.doc.resolve(s.mapping.map(o.pos)),1):yn.create(s.doc,s.mapping.map(o.pos))),e(s.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=r.depth-1||(e&&e(t.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),0))}function Yi(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):o.parentOffset<o.parent.content.size)return!1;i=Gi(o)}var s=i&&i.nodeAfter;return!(!s||!yn.isSelectable(s)||(e&&e(t.tr.setSelection(yn.create(t.doc,i.pos)).scrollIntoView()),0))}function Gi(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){var n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}function Zi(t,e){var n=t.selection,r=n.$from,o=n.$to,i=r.blockRange(o),s=i&&Je(i);return null!=s&&(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)}function Xi(t,e){var n=t.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o)||(e&&e(t.tr.insertText("\n").scrollIntoView()),0))}function Qi(t){for(var e=0;e<t.edgeCount;e++){var n=t.edge(e).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function ts(t,e){var n=t.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=Qi(i.contentMatchAt(s));if(!i.canReplaceWith(s,s,a))return!1;if(e){var c=r.after(),l=t.tr.replaceWith(c,c,a.createAndFill());l.setSelection(hn.near(l.doc.resolve(c),1)),e(l.scrollIntoView())}return!0}function es(t,e){var n=t.selection,r=n.$from,o=n.$to;if(n instanceof wn||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=Qi(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=t.tr.insert(s,i.createAndFill());a.setSelection(vn.create(a.doc,s+1)),e(a.scrollIntoView())}return!0}function ns(t,e){var n=t.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(Ye(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&Je(o);return null!=i&&(e&&e(t.tr.lift(o,i).scrollIntoView()),!0)}function rs(t,e){return e&&e(t.tr.setSelection(new wn(t.doc))),!0}function is(t,e,n){var r,o,i=e.nodeBefore,s=e.nodeAfter;if(i.type.spec.isolating||s.type.spec.isolating)return!1;if(function(t,e,n){var r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(i,i+1)||!o.isTextblock&&!Ge(t.doc,e.pos)||(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),0)))}(t,e,n))return!0;var a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var c=e.pos+s.nodeSize,l=gt.empty,u=r.length-1;u>=0;u--)l=gt.from(r[u].create(null,l));l=gt.from(i.copy(l));var f=t.tr.step(new Fe(e.pos-1,c,e.pos,c,new _t(l,1,0),r.length,!0)),p=c+2*r.length;Ge(f.doc,p)&&f.join(p),n(f.scrollIntoView())}return!0}var h=hn.findFrom(e,1),d=h&&h.$from.blockRange(h.$to),m=d&&Je(d);if(null!=m&&m>=e.depth)return n&&n(t.tr.lift(d,m).scrollIntoView()),!0;if(a&&qi(s,"start",!0)&&qi(i,"end")){for(var v=i,g=[];g.push(v),!v.isTextblock;)v=v.lastChild;for(var y=s,b=1;!y.isTextblock;y=y.firstChild)b++;if(v.canReplace(v.childCount,v.childCount,y.content)){if(n){for(var w=gt.empty,x=g.length-1;x>=0;x--)w=gt.from(g[x].copy(w));n(t.tr.step(new Fe(e.pos-g.length,e.pos+s.nodeSize,e.pos+b,e.pos+s.nodeSize-b,new _t(w,g.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function ss(t,e){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&Ke(a,t,e);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function as(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(e,n,r){for(var o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}new ji(/--$/,"—"),new ji(/\.\.\.$/,"…"),new ji(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new ji(/"$/,"”"),new ji(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new ji(/'$/,"’");var cs=as(Fi,Wi,Ji),ls=as(Fi,Ui,Yi),us={Enter:as(Xi,es,ns,(function(t,e){var n=t.selection,r=n.$from,o=n.$to;if(t.selection instanceof yn&&t.selection.node.isBlock)return!(!r.parentOffset||!Ye(t.doc,r.pos)||(e&&e(t.tr.split(r.pos).scrollIntoView()),0));if(!r.parent.isBlock)return!1;if(e){var i=o.parentOffset==o.parent.content.size,s=t.tr;(t.selection instanceof vn||t.selection instanceof wn)&&s.deleteSelection();var a=0==r.depth?null:Qi(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=i&&a?[{type:a}]:null,l=Ye(s.doc,s.mapping.map(r.pos),1,c);if(c||l||!Ye(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],l=!0),l&&(s.split(s.mapping.map(r.pos),1,c),!i&&!r.parentOffset&&r.parent.type!=a)){var u=s.mapping.map(r.before()),f=s.doc.resolve(u);r.node(-1).canReplaceWith(f.index(),f.index()+1,a)&&s.setNodeMarkup(s.mapping.map(r.before()),a)}e(s.scrollIntoView())}return!0})),"Mod-Enter":ts,Backspace:cs,"Mod-Backspace":cs,Delete:ls,"Mod-Delete":ls,"Mod-a":rs},fs={"Ctrl-h":us.Backspace,"Alt-Backspace":us["Mod-Backspace"],"Ctrl-d":us.Delete,"Ctrl-Alt-Backspace":us["Mod-Delete"],"Alt-Delete":us["Mod-Delete"],"Alt-d":us["Mod-Delete"]};for(var ps in us)fs[ps]=us[ps];function hs(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function ds(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function ms(t,e){const n=ds(e,t.schema),{from:r,to:o}=t.selection;let i=[];t.doc.nodesBetween(r,o,(t=>{i=[...i,t]}));const s=i.reverse().find((t=>t.type.name===n.name));return s?{...s.attrs}:{}}function vs(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function gs(t,e){const n=vs(e,t.schema),{from:r,to:o,empty:i}=t.selection;let s=[];i?s=t.selection.$head.marks():t.doc.nodesBetween(r,o,(t=>{s=[...s,...t.marks]}));const a=s.find((t=>t.type.name===n.name));return a?{...a.attrs}:{}}function ys(t,e){const n=Object.keys(e);return!n.length||!!n.filter((n=>e[n]===t[n])).length}function bs(t,e,n={}){const{from:r,to:o,empty:i}=t.selection,s=e?ds(e,t.schema):null;let a=[];if(t.doc.nodesBetween(r,o,((t,e)=>{if(!t.isText){const n=Math.max(r,e),i=Math.min(o,e+t.nodeSize);a=[...a,{node:t,from:n,to:i}]}})),i)return!!a.filter((t=>!s||s.name===t.node.type.name)).find((t=>ys(t.node.attrs,n)));const c=o-r;return a.filter((t=>!s||s.name===t.node.type.name)).filter((t=>ys(t.node.attrs,n))).reduce(((t,e)=>t+(e.to-e.from)),0)>=c}function ws(t,e,n={}){const{from:r,to:o,empty:i}=t.selection,s=e?vs(e,t.schema):null;if(i)return!!(t.storedMarks||t.selection.$from.marks()).filter((t=>!s||s.name===t.type.name)).find((t=>ys(t.attrs,n)));let a=0,c=[];if(t.doc.nodesBetween(r,o,((t,e)=>{if(t.isText){const n=Math.max(r,e),i=Math.min(o,e+t.nodeSize);a+=i-n,c=[...c,...t.marks.map((t=>({mark:t,from:n,to:i})))]}})),0===a)return!1;const l=c.filter((t=>!s||s.name===t.mark.type.name)).filter((t=>ys(t.mark.attrs,n))).reduce(((t,e)=>t+(e.to-e.from)),0),u=c.filter((t=>!s||t.mark.type!==s&&t.mark.type.excludes(s))).reduce(((t,e)=>t+(e.to-e.from)),0);return(l>0?l+u:l)>=a}function xs(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function ks(t,e,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof t&&null!==t)try{return Array.isArray(t)?gt.fromArray(t.map((t=>e.nodeFromJSON(t)))):e.nodeFromJSON(t)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),ks("",e,n)}if("string"==typeof t){const r=ve.fromSchema(e);return n.slice?r.parseSlice(xs(t),n.parseOptions).content:r.parse(xs(t),n.parseOptions)}return ks("",e,n)}function $s(t,e,n={}){return ks(t,e,{slice:!1,parseOptions:n})}"undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&os.platform();class _s{constructor(t,e){this.editor=t,this.commands=e}createCommands(){const{commands:t,editor:e}=this,{state:n,view:r}=e,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,(...t)=>{const n=e(...t)(i);return o.getMeta("preventDispatch")||r.dispatch(o),n}])))}createChain(t,e=!0){const{commands:n,editor:r}=this,{state:o,view:i}=r,s=[],a=!!t,c=t||o.tr,l={...Object.fromEntries(Object.entries(n).map((([t,n])=>[t,(...t)=>{const r=this.buildProps(c,e),o=n(...t)(r);return s.push(o),l}]))),run:()=>(a||!e||c.getMeta("preventDispatch")||i.dispatch(c),s.every((t=>!0===t)))};return l}createCan(t){const{commands:e,editor:n}=this,{state:r}=n,o=void 0,i=t||r.tr,s=this.buildProps(i,o);return{...Object.fromEntries(Object.entries(e).map((([t,e])=>[t,(...t)=>e(...t)({...s,dispatch:o})]))),chain:()=>this.createChain(i,o)}}buildProps(t,e=!0){const{editor:n,commands:r}=this,{state:o,view:i}=n;o.storedMarks&&t.setStoredMarks(o.storedMarks);const s={tr:t,editor:n,view:i,state:this.chainableState(t,o),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map((([t,e])=>[t,(...t)=>e(...t)(s)])))}};return s}chainableState(t,e){let{selection:n}=t,{doc:r}=t,{storedMarks:o}=t;return{...e,schema:e.schema,plugins:e.plugins,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return n},get doc(){return r},get tr(){return n=t.selection,r=t.doc,o=t.storedMarks,t}}}}function Ms(t,e,n={}){return void 0===t.config[e]&&t.parent?Ms(t.parent,e,n):"function"==typeof t.config[e]?t.config[e].bind({...n,parent:t.parent?Ms(t.parent,e,n):null}):t.config[e]}function Ss(t){return{baseExtensions:t.filter((t=>"extension"===t.type)),nodeExtensions:t.filter((t=>"node"===t.type)),markExtensions:t.filter((t=>"mark"===t.type))}}function Cs(t){const e=[],{nodeExtensions:n,markExtensions:r}=Ss(t),o=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return t.forEach((t=>{const n=Ms(t,"addGlobalAttributes",{name:t.name,options:t.options});n&&n().forEach((t=>{t.types.forEach((n=>{Object.entries(t.attributes).forEach((([t,r])=>{e.push({type:n,name:t,attribute:{...i,...r}})}))}))}))})),o.forEach((t=>{const n={name:t.name,options:t.options},r=Ms(t,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach((([n,r])=>{e.push({type:t.name,name:n,attribute:{...i,...r}})}))})),e}function Os(...t){return t.filter((t=>!!t)).reduce(((t,e)=>{const n={...t};return Object.entries(e).forEach((([t,e])=>{n[t]?n[t]="class"===t?[n[t],e].join(" "):"style"===t?[n[t],e].join("; "):e:n[t]=e})),n}),{})}function Ts(t,e){return e.filter((t=>t.attribute.rendered)).map((e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]})).reduce(((t,e)=>Os(t,e)),{})}function As(t,e){return t.style?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===r)return!1;const o=e.filter((t=>t.attribute.rendered)).reduce(((t,e)=>{const r=e.attribute.parseHTML?e.attribute.parseHTML(n)||{}:{[e.name]:(o=n.getAttribute(e.name),"string"!=typeof o?o:o.match(/^\d*(\.\d+)?$/)?Number(o):"true"===o||"false"!==o&&o)};var o;return{...t,...Object.fromEntries(Object.entries(r).filter((([,t])=>null!=t)))}}),{});return{...r,...o}}}}function Ns(t,e,...n){return"function"==typeof t?e?t.bind(e)(...n):t(...n):t}function Es(t){return Object.fromEntries(Object.entries(t).filter((([t,e])=>("attrs"!==t||!function(t={}){return 0===Object.keys(t).length&&t.constructor===Object}(e))&&null!=e)))}function Ds(t,e){return e.nodes[t]?e.nodes[t]:e.marks[t]?e.marks[t]:null}class zs{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=zs.resolve(t),this.schema=function(t){var e;const n=Cs(t),{nodeExtensions:r,markExtensions:o}=Ss(t),i=null===(e=r.find((t=>Ms(t,"topNode"))))||void 0===e?void 0:e.name,s=Object.fromEntries(r.map((e=>{const r=n.filter((t=>t.type===e.name)),o={name:e.name,options:e.options},i=Es({...t.reduce(((t,n)=>{const r=Ms(n,"extendNodeSchema",o);return{...t,...r?r(e):{}}}),{}),content:Ns(Ms(e,"content",o)),marks:Ns(Ms(e,"marks",o)),group:Ns(Ms(e,"group",o)),inline:Ns(Ms(e,"inline",o)),atom:Ns(Ms(e,"atom",o)),selectable:Ns(Ms(e,"selectable",o)),draggable:Ns(Ms(e,"draggable",o)),code:Ns(Ms(e,"code",o)),defining:Ns(Ms(e,"defining",o)),isolating:Ns(Ms(e,"isolating",o)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),s=Ns(Ms(e,"parseHTML",o));s&&(i.parseDOM=s.map((t=>As(t,r))));const a=Ms(e,"renderHTML",o);return a&&(i.toDOM=t=>a({node:t,HTMLAttributes:Ts(t,r)})),[e.name,i]}))),a=Object.fromEntries(o.map((e=>{const r=n.filter((t=>t.type===e.name)),o={name:e.name,options:e.options},i=Es({...t.reduce(((t,n)=>{const r=Ms(n,"extendMarkSchema",o);return{...t,...r?r(e):{}}}),{}),inclusive:Ns(Ms(e,"inclusive",o)),excludes:Ns(Ms(e,"excludes",o)),group:Ns(Ms(e,"group",o)),spanning:Ns(Ms(e,"spanning",o)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),s=Ns(Ms(e,"parseHTML",o));s&&(i.parseDOM=s.map((t=>As(t,r))));const a=Ms(e,"renderHTML",o);return a&&(i.toDOM=t=>a({mark:t,HTMLAttributes:Ts(t,r)})),[e.name,i]})));return new de({topNode:i,nodes:s,marks:a})}(this.extensions),this.extensions.forEach((t=>{var e;const n={name:t.name,options:t.options,editor:this.editor,type:Ds(t.name,this.schema)};"mark"===t.type&&(null===(e=Ns(Ms(t,"keepOnSplit",n)))||void 0===e||e)&&this.splittableMarks.push(t.name);const r=Ms(t,"onBeforeCreate",n);r&&this.editor.on("beforeCreate",r);const o=Ms(t,"onCreate",n);o&&this.editor.on("create",o);const i=Ms(t,"onUpdate",n);i&&this.editor.on("update",i);const s=Ms(t,"onSelectionUpdate",n);s&&this.editor.on("selectionUpdate",s);const a=Ms(t,"onTransaction",n);a&&this.editor.on("transaction",a);const c=Ms(t,"onFocus",n);c&&this.editor.on("focus",c);const l=Ms(t,"onBlur",n);l&&this.editor.on("blur",l);const u=Ms(t,"onDestroy",n);u&&this.editor.on("destroy",u)}))}static resolve(t){return zs.sort(zs.flatten(t))}static flatten(t){return t.map((t=>{const e=Ms(t,"addExtensions",{name:t.name,options:t.options});return e?[t,...this.flatten(e())]:t})).flat(10)}static sort(t){return t.sort(((t,e)=>{const n=Ms(t,"priority")||100,r=Ms(e,"priority")||100;return n>r?-1:n<r?1:0}))}get commands(){return this.extensions.reduce(((t,e)=>{const n=Ms(e,"addCommands",{name:e.name,options:e.options,editor:this.editor,type:Ds(e.name,this.schema)});return n?{...t,...n()}:t}),{})}get plugins(){return[...this.extensions].reverse().map((t=>{const e={name:t.name,options:t.options,editor:this.editor,type:Ds(t.name,this.schema)},n=[],r=Ms(t,"addKeyboardShortcuts",e);if(r){const t=(o=Object.fromEntries(Object.entries(r()).map((([t,e])=>[t,()=>e({editor:this.editor})]))),new Dn({props:{handleKeyDown:Pi(o)}}));n.push(t)}var o;const i=Ms(t,"addInputRules",e);if(this.editor.options.enableInputRules&&i){const t=i(),e=t.length?[(s={rules:t},a=s.rules,c=new Dn({state:{init:function(){return null},apply:function(t,e){return t.getMeta(this)||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:function(t,e,n,r){return Vi(t,e,n,r,a,c)},handleDOMEvents:{compositionend:function(t){setTimeout((function(){var e=t.state.selection.$cursor;e&&Vi(t,e.pos,e.pos,"",a,c)}))}}},isInputRules:!0}),c)]:[];n.push(...e)}var s,a,c;const l=Ms(t,"addPasteRules",e);if(this.editor.options.enablePasteRules&&l){const t=l();n.push(...t)}const u=Ms(t,"addProseMirrorPlugins",e);if(u){const t=u();n.push(...t)}return n})).flat()}get attributes(){return Cs(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Ss(this.extensions);return Object.fromEntries(e.filter((t=>!!Ms(t,"addNodeView"))).map((e=>{const n=this.attributes.filter((t=>t.type===e.name)),r={name:e.name,options:e.options,editor:t,type:ds(e.name,this.schema)},o=Ms(e,"addNodeView",r);return o?[e.name,(r,i,s,a)=>{const c=Ts(r,n);return o()({editor:t,node:r,getPos:s,decorations:a,HTMLAttributes:c,extension:e})}]:[]})))}get textSerializers(){const{editor:t}=this,{nodeExtensions:e}=Ss(this.extensions);return Object.fromEntries(e.filter((t=>!!Ms(t,"renderText"))).map((e=>{const n=Ms(e,"renderText",{name:e.name,options:e.options,editor:t,type:ds(e.name,this.schema)});return n?[e.name,t=>n(t)]:[]})))}}function Rs(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Is(t,e){const n={...t};return Rs(t)&&Rs(e)&&Object.keys(e).forEach((r=>{Rs(e[r])?r in t?n[r]=Is(t[r],e[r]):Object.assign(n,{[r]:e[r]}):Object.assign(n,{[r]:e[r]})})),n}class Bs{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,this.options=this.config.defaultOptions}static create(t={}){return new Bs(t)}configure(t={}){const e=this.extend();return e.options=Is(this.options,t),e}extend(t={}){const e=new Bs(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,e.options=t.defaultOptions?t.defaultOptions:e.parent.options,e}}const Ps=Bs.create({name:"editable",addProseMirrorPlugins(){return[new Dn({key:new In("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{from:e,to:n}=t.state.selection;return((t,e,n,r,o)=>{let i="",s=!0;return t.state.doc.nodesBetween(e,n,((o,a)=>{var c;const l=t.extensionManager.textSerializers[o.type.name];l?(i+=l({node:o}),s=!1):o.isText?(i+=null===(c=null==o?void 0:o.text)||void 0===c?void 0:c.slice(Math.max(e,a)-a,n-a),s=!1):(o.isLeaf,!s&&o.isBlock&&(i+=r,s=!0))}),0),i})(t,e,n,"\n")}}})]}});var js=Object.freeze({__proto__:null,blur:()=>({view:t})=>(t.dom.blur(),!0)}),Vs=Object.freeze({__proto__:null,clearContent:(t=!1)=>({commands:e})=>e.setContent("",t)}),Ls=Object.freeze({__proto__:null,clearNodes:()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:o}=r;return o.forEach((r=>{t.doc.nodesBetween(r.$from.pos,r.$to.pos,((t,r)=>{if(t.type.isText)return;const o=e.doc.resolve(e.mapping.map(r)),i=e.doc.resolve(e.mapping.map(r+t.nodeSize)),s=o.blockRange(i);if(!s)return;const a=Je(s);if(t.type.isTextblock&&n){const{defaultType:t}=o.parent.contentMatchAt(o.index());e.setNodeMarkup(s.start,t)}(a||0===a)&&n&&e.lift(s,a)}))})),!0}}),Hs=Object.freeze({__proto__:null,command:t=>e=>t(e)}),Fs=Object.freeze({__proto__:null,createParagraphNear:()=>({state:t,dispatch:e})=>es(t,e)}),Ws=Object.freeze({__proto__:null,deleteRange:t=>({tr:e,dispatch:n})=>{const{from:r,to:o}=t;return n&&e.delete(r,o),!0}}),qs=Object.freeze({__proto__:null,deleteSelection:()=>({state:t,dispatch:e})=>Fi(t,e)}),Js=Object.freeze({__proto__:null,enter:()=>({commands:t})=>t.keyboardShortcut("Enter")}),Ks=Object.freeze({__proto__:null,exitCode:()=>({state:t,dispatch:e})=>ts(t,e)});function Us(t,e,n={}){return t.find((t=>t.type===e&&ys(t.attrs,n)))}function Ys(t,e,n={}){return!!Us(t,e,n)}function Gs(t,e,n={}){if(!t||!e)return;const r=t.parent.childAfter(t.parentOffset);if(!r.node)return;const o=Us(r.node.marks,e,n);if(!o)return;let i=t.index(),s=t.start()+r.offset,a=i+1,c=s+r.node.nodeSize;for(Us(r.node.marks,e,n);i>0&&o.isInSet(t.parent.child(i-1).marks);)i-=1,s-=t.parent.child(i).nodeSize;for(;a<t.parent.childCount&&Ys(t.parent.child(a).marks,e,n);)c+=t.parent.child(a).nodeSize,a+=1;return{from:s,to:c}}var Zs=Object.freeze({__proto__:null,extendMarkRange:(t,e={})=>({tr:n,state:r,dispatch:o})=>{const i=vs(t,r.schema),{doc:s,selection:a}=n,{$from:c,from:l,to:u}=a;if(o){const t=Gs(c,i,e);if(t&&t.from<=l&&t.to>=u){const e=vn.create(s,t.from,t.to);n.setSelection(e)}}return!0}}),Xs=Object.freeze({__proto__:null,first:t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1}});function Qs(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}var ta=Object.freeze({__proto__:null,focus:(t=null)=>({editor:e,view:n,tr:r,dispatch:o})=>{if(n.hasFocus()&&null===t||!1===t)return!0;if(o&&null===t&&(!(i=s=e.state.selection)||"object"!=typeof i||Array.isArray(i)||function(t){var e;return"class"===(null===(e=t.constructor)||void 0===e?void 0:e.toString().substring(0,5))}(i)||!(s instanceof vn)))return n.focus(),!0;var i,s;const{from:a,to:c}=function(t,e=null){if(!e)return null;if("start"===e||!0===e)return{from:0,to:0};if("end"===e){const{size:e}=t.doc.content;return{from:e,to:e}}return{from:e,to:e}}(e.state,t)||e.state.selection,{doc:l,storedMarks:u}=r,f=Qs(a,0,l.content.size),p=Qs(c,0,l.content.size),h=vn.create(l,f,p),d=e.state.selection.eq(h);return o&&(r.setSelection(h),d&&u&&r.setStoredMarks(u),n.focus()),!0}}),ea=Object.freeze({__proto__:null,forEach:(t,e)=>n=>t.every(((t,r)=>e(t,{...n,index:r})))}),na=Object.freeze({__proto__:null,insertContent:t=>({tr:e,commands:n})=>n.insertContentAt({from:e.selection.from,to:e.selection.to},t)}),ra=Object.freeze({__proto__:null,insertContentAt:(t,e)=>({tr:n,dispatch:r,editor:o})=>{if(r){const r=ks(e,o.schema,{parseOptions:{preserveWhitespace:"full"}});if("<>"===r.toString())return!0;const{from:i,to:s}="number"==typeof t?{from:t,to:t}:t;n.replaceWith(i,s,r),function(t,e,n){const r=t.steps.length-1;if(r<e)return;const o=t.steps[r];if(!(o instanceof He||o instanceof Fe))return;const i=t.mapping.maps[r];let s=0;i.forEach(((t,e,n,r)=>{0===s&&(s=r)})),t.setSelection(hn.near(t.doc.resolve(s),1))}(n,n.steps.length-1)}return!0}}),oa=Object.freeze({__proto__:null,joinBackward:()=>({state:t,dispatch:e})=>Wi(t,e)}),ia=Object.freeze({__proto__:null,joinForward:()=>({state:t,dispatch:e})=>Ui(t,e)});const sa="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var aa=Object.freeze({__proto__:null,keyboardShortcut:t=>({editor:e,view:n,tr:r,dispatch:o})=>{const i=function(t){const e=t.split(/-(?!$)/);let n,r,o,i,s=e[e.length-1];"Space"===s&&(s=" ");for(let t=0;t<e.length-1;t+=1){const s=e[t];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))n=!0;else if(/^(c|ctrl|control)$/i.test(s))r=!0;else if(/^s(hift)?$/i.test(s))o=!0;else{if(!/^mod$/i.test(s))throw new Error(`Unrecognized modifier name: ${s}`);sa?i=!0:r=!0}}return n&&(s=`Alt-${s}`),r&&(s=`Ctrl-${s}`),i&&(s=`Meta-${s}`),o&&(s=`Shift-${s}`),s}(t).split(/-(?!$)/),s=i.find((t=>!["Alt","Ctrl","Meta","Shift"].includes(t))),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction((()=>{n.someProp("handleKeyDown",(t=>t(n,a)))}));return null==c||c.steps.forEach((t=>{const e=t.map(r.mapping);e&&o&&r.maybeStep(e)})),!0}}),ca=Object.freeze({__proto__:null,lift:(t,e={})=>({state:n,dispatch:r})=>!!bs(n,ds(t,n.schema),e)&&Zi(n,r)}),la=Object.freeze({__proto__:null,liftEmptyBlock:()=>({state:t,dispatch:e})=>ns(t,e)}),ua=Object.freeze({__proto__:null,liftListItem:t=>({state:e,dispatch:n})=>{return(r=ds(t,e.schema),function(t,e){var n=t.selection,o=n.$from,i=n.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==r}));return!!s&&(!e||(o.node(s.depth-1).type==r?function(t,e,n,r){var o=t.tr,i=r.end,s=r.$to.end(r.depth);return i<s&&(o.step(new Fe(i-1,s,i,s,new _t(gt.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Ht(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth)),e(o.lift(r,Je(r)).scrollIntoView()),!0}(t,e,r,s):function(t,e,n){for(var r=t.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter,u=0==n.startIndex,f=n.endIndex==o.childCount,p=c.node(-1),h=c.index(-1);if(!p.canReplace(h+(u?0:1),h+1,l.content.append(f?gt.empty:gt.from(o))))return!1;var d=c.pos,m=d+l.nodeSize;return r.step(new Fe(d-(u?1:0),m+(f?1:0),d+1,m-1,new _t((u?gt.empty:gt.from(o.copy(gt.empty))).append(f?gt.empty:gt.from(o.copy(gt.empty))),u?0:1,f?0:1),u?0:1)),e(r.scrollIntoView()),!0}(t,e,s)))})(e,n);var r}}),fa=Object.freeze({__proto__:null,newlineInCode:()=>({state:t,dispatch:e})=>Xi(t,e)}),pa=Object.freeze({__proto__:null,replace:(t,e={})=>({state:n,commands:r})=>{console.warn("[tiptap warn]: replace() is deprecated. please use insertContent() instead.");const{from:o,to:i}=n.selection,s={from:o,to:i};return r.replaceRange(s,t,e)}}),ha=Object.freeze({__proto__:null,replaceRange:(t,e,n={})=>({tr:r,state:o,dispatch:i})=>{console.warn("[tiptap warn]: replaceRange() is deprecated. please use insertContent() instead.");const s=ds(e,o.schema),{from:a,to:c}=t;return i&&r.replaceRangeWith(a,c,s.create(n)),!0}});function da(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce(((e,r)=>(n.includes(r)||(e[r]=t[r]),e)),{})}var ma=Object.freeze({__proto__:null,resetAttributes:(t,e)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=hs("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(i=ds(t,r.schema)),"mark"===a&&(s=vs(t,r.schema)),o&&n.selection.ranges.forEach((t=>{r.doc.nodesBetween(t.$from.pos,t.$to.pos,((t,r)=>{i&&i===t.type&&n.setNodeMarkup(r,void 0,da(t.attrs,e)),s&&t.marks.length&&t.marks.forEach((o=>{s===o.type&&n.addMark(r,r+t.nodeSize,s.create(da(o.attrs,e)))}))}))})),!0)}}),va=Object.freeze({__proto__:null,scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0)}),ga=Object.freeze({__proto__:null,selectAll:()=>({state:t,dispatch:e})=>rs(t,e)}),ya=Object.freeze({__proto__:null,selectNodeBackward:()=>({state:t,dispatch:e})=>Ji(t,e)}),ba=Object.freeze({__proto__:null,selectNodeForward:()=>({state:t,dispatch:e})=>Yi(t,e)}),wa=Object.freeze({__proto__:null,selectParentNode:()=>({state:t,dispatch:e})=>function(t,e){var n,r=t.selection,o=r.$from,i=r.to,s=o.sharedDepth(i);return 0!=s&&(n=o.before(s),e&&e(t.tr.setSelection(yn.create(t.doc,n))),!0)}(t,e)}),xa=Object.freeze({__proto__:null,setContent:(t,e=!1,n={})=>({tr:r,editor:o,dispatch:i})=>{const{doc:s}=r,a=$s(t,o.schema,n),c=vn.create(s,0,s.content.size);return i&&r.setSelection(c).replaceSelectionWith(a,!1).setMeta("preventUpdate",!e),!0}}),ka=Object.freeze({__proto__:null,setMark:(t,e={})=>({tr:n,state:r,dispatch:o})=>{const{selection:i}=n,{empty:s,ranges:a}=i,c=vs(t,r.schema);if(o)if(s){const t=gs(r,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach((t=>{const o=t.$from.pos,i=t.$to.pos;r.doc.nodesBetween(o,i,((t,r)=>{const s=Math.max(r,o),a=Math.min(r+t.nodeSize,i);t.marks.find((t=>t.type===c))?t.marks.forEach((t=>{c===t.type&&n.addMark(s,a,c.create({...t.attrs,...e}))})):n.addMark(s,a,c.create(e))}))}));return!0}}),$a=Object.freeze({__proto__:null,setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0)}),_a=Object.freeze({__proto__:null,setNode:(t,e={})=>({state:n,dispatch:r})=>{const o=ds(t,n.schema);return(i=o,s=e,function(t,e){var n=t.selection,r=n.from,o=n.to,a=!1;return t.doc.nodesBetween(r,o,(function(e,n){if(a)return!1;if(e.isTextblock&&!e.hasMarkup(i,s))if(e.type==i)a=!0;else{var r=t.doc.resolve(n),o=r.index();a=r.parent.canReplaceWith(o,o+1,i)}})),!!a&&(e&&e(t.tr.setBlockType(r,o,i,s).scrollIntoView()),!0)})(n,r);var i,s}}),Ma=Object.freeze({__proto__:null,setNodeSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,r=Qs(t,0,n.content.size),o=yn.create(n,r);e.setSelection(o)}return!0}}),Sa=Object.freeze({__proto__:null,setTextSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,{from:r,to:o}="number"==typeof t?{from:t,to:t}:t,i=Qs(r,0,n.content.size),s=Qs(o,0,n.content.size),a=vn.create(n,i,s);e.setSelection(a)}return!0}}),Ca=Object.freeze({__proto__:null,sinkListItem:t=>({state:e,dispatch:n})=>{const r=ds(t,e.schema);return(o=r,function(t,e){var n=t.selection,r=n.$from,i=n.$to,s=r.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==o}));if(!s)return!1;var a=s.startIndex;if(0==a)return!1;var c=s.parent,l=c.child(a-1);if(l.type!=o)return!1;if(e){var u=l.lastChild&&l.lastChild.type==c.type,f=gt.from(u?o.create():null),p=new _t(gt.from(o.create(null,gt.from(c.type.create(null,f)))),u?3:1,0),h=s.start,d=s.end;e(t.tr.step(new Fe(h-(u?3:1),d,h,d,p,1,!0)).scrollIntoView())}return!0})(e,n);var o}});function Oa(t,e,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const r=t.find((t=>t.type===e&&t.name===n));return!!r&&r.attribute.keepOnSplit})))}function Ta(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter((t=>null==e?void 0:e.includes(t.type.name)));t.tr.ensureMarks(r)}}var Aa=Object.freeze({__proto__:null,splitBlock:({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:o})=>{const{selection:i,doc:s}=e,{$from:a,$to:c}=i,l=Oa(o.extensionManager.attributes,a.node().type.name,a.node().attrs);if(i instanceof yn&&i.node.isBlock)return!(!a.parentOffset||!Ye(s,a.pos)||(r&&(t&&Ta(n,o.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),0));if(!a.parent.isBlock)return!1;if(r){const r=c.parentOffset===c.parent.content.size;i instanceof vn&&e.deleteSelection();const s=0===a.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let u=r&&s?[{type:s,attrs:l}]:void 0,f=Ye(e.doc,e.mapping.map(a.pos),1,u);if(u||f||!Ye(e.doc,e.mapping.map(a.pos),1,s?[{type:s}]:void 0)||(f=!0,u=s?[{type:s,attrs:l}]:void 0),f&&(e.split(e.mapping.map(a.pos),1,u),s&&!r&&!a.parentOffset&&a.parent.type!==s)){const t=e.mapping.map(a.before()),n=e.doc.resolve(t);a.node(-1).canReplaceWith(n.index(),n.index()+1,s)&&e.setNodeMarkup(e.mapping.map(a.before()),s)}t&&Ta(n,o.extensionManager.splittableMarks),e.scrollIntoView()}return!0}}),Na=Object.freeze({__proto__:null,splitListItem:t=>({tr:e,state:n,dispatch:r,editor:o})=>{var i;const s=ds(t,n.schema),{$from:a,$to:c}=n.selection,l=n.selection.node;if(l&&l.isBlock||a.depth<2||!a.sameParent(c))return!1;const u=a.node(-1);if(u.type!==s)return!1;const f=o.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let t=gt.empty;const n=a.index(-1)?1:a.index(-2)?2:3;for(let e=a.depth-n;e>=a.depth-3;e-=1)t=gt.from(a.node(e).copy(t));const r=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,o=Oa(f,a.node().type.name,a.node().attrs),c=(null===(i=s.contentMatch.defaultType)||void 0===i?void 0:i.createAndFill(o))||void 0;t=t.append(gt.from(s.createAndFill(null,c)||void 0));const l=a.before(a.depth-(n-1));e.replace(l,a.after(-r),new _t(t,4-n,0));let u=-1;e.doc.nodesBetween(l,e.doc.content.size,((t,e)=>{if(u>-1)return!1;t.isTextblock&&0===t.content.size&&(u=e+1)})),u>-1&&e.setSelection(vn.near(e.doc.resolve(u))),e.scrollIntoView()}return!0}const p=c.pos===a.end()?u.contentMatchAt(0).defaultType:null,h=Oa(f,u.type.name,u.attrs),d=Oa(f,a.node().type.name,a.node().attrs);e.delete(a.pos,c.pos);const m=p?[{type:s,attrs:h},{type:p,attrs:d}]:[{type:s,attrs:h}];return!!Ye(e.doc,a.pos,2)&&(r&&e.split(a.pos,2,m).scrollIntoView(),!0)}});function Ea(t,e){const{nodeExtensions:n}=Ss(e),r=n.find((e=>e.name===t));if(!r)return!1;const o=Ns(Ms(r,"group",{name:r.name,options:r.options}));return"string"==typeof o&&o.split(" ").includes("list")}var Da=Object.freeze({__proto__:null,toggleList:(t,e)=>({editor:n,tr:r,state:o,dispatch:i,chain:s,commands:a,can:c})=>{const{extensions:l}=n.extensionManager,u=ds(t,o.schema),f=ds(e,o.schema),{selection:p}=o,{$from:h,$to:d}=p,m=h.blockRange(d);if(!m)return!1;const v=(g=t=>Ea(t.type.name,l),t=>function(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}(t.$from,g))(p);var g;if(m.depth>=1&&v&&m.depth-v.depth<=1){if(v.node.type===u)return a.liftListItem(f);if(Ea(v.node.type.name,l)&&u.validContent(v.node.content)&&i)return r.setNodeMarkup(v.pos,u),!0}return c().wrapInList(u)?a.wrapInList(u):s().clearNodes().wrapInList(u).run()}}),za=Object.freeze({__proto__:null,toggleMark:(t,e={})=>({state:n,commands:r})=>{const o=vs(t,n.schema);return ws(n,o,e)?r.unsetMark(o):r.setMark(o,e)}}),Ra=Object.freeze({__proto__:null,toggleNode:(t,e,n={})=>({state:r,commands:o})=>{const i=ds(t,r.schema),s=ds(e,r.schema);return bs(r,i,n)?o.setNode(s):o.setNode(i,n)}}),Ia=Object.freeze({__proto__:null,toggleWrap:(t,e={})=>({state:n,dispatch:r})=>{const o=ds(t,n.schema);return bs(n,o,e)?Zi(n,r):ss(o,e)(n,r)}}),Ba=Object.freeze({__proto__:null,undoInputRule:()=>({state:t,dispatch:e})=>function(t,e){for(var n=t.plugins,r=0;r<n.length;r++){var o=n[r],i=void 0;if(o.spec.isInputRules&&(i=o.getState(t))){if(e){for(var s=t.tr,a=i.transform,c=a.steps.length-1;c>=0;c--)s.step(a.steps[c].invert(a.docs[c]));if(i.text){var l=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,t.schema.text(i.text,l))}else s.delete(i.from,i.to);e(s)}return!0}}return!1}(t,e)}),Pa=Object.freeze({__proto__:null,unsetAllMarks:()=>({tr:t,state:e,dispatch:n})=>{const{selection:r}=t,{empty:o,ranges:i}=r;return o||n&&Object.entries(e.schema.marks).forEach((([,e])=>{i.forEach((n=>{t.removeMark(n.$from.pos,n.$to.pos,e)}))})),!0}}),ja=Object.freeze({__proto__:null,unsetMark:t=>({tr:e,state:n,dispatch:r})=>{const{selection:o}=e,i=vs(t,n.schema),{$from:s,empty:a,ranges:c}=o;if(r){if(a){let{from:t,to:n}=o;const r=Gs(s,i);r&&(t=r.from,n=r.to),e.removeMark(t,n,i)}else c.forEach((t=>{e.removeMark(t.$from.pos,t.$to.pos,i)}));e.removeStoredMark(i)}return!0}}),Va=Object.freeze({__proto__:null,updateAttributes:(t,e={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null;const a=hs("string"==typeof t?t:t.name,r.schema);return!!a&&("node"===a&&(i=ds(t,r.schema)),"mark"===a&&(s=vs(t,r.schema)),o&&n.selection.ranges.forEach((t=>{const o=t.$from.pos,a=t.$to.pos;r.doc.nodesBetween(o,a,((t,r)=>{i&&i===t.type&&n.setNodeMarkup(r,void 0,{...t.attrs,...e}),s&&t.marks.length&&t.marks.forEach((i=>{if(s===i.type){const c=Math.max(r,o),l=Math.min(r+t.nodeSize,a);n.addMark(c,l,s.create({...i.attrs,...e}))}}))}))})),!0)}}),La=Object.freeze({__proto__:null,wrapIn:(t,e={})=>({state:n,dispatch:r})=>{const o=ds(t,n.schema);return!bs(n,o,e)&&ss(o,e)(n,r)}}),Ha=Object.freeze({__proto__:null,wrapInList:(t,e={})=>({state:n,dispatch:r})=>{return(o=ds(t,n.schema),i=e,function(t,e){var n=t.selection,r=n.$from,s=n.$to,a=r.blockRange(s),c=!1,l=a;if(!a)return!1;if(a.depth>=2&&r.node(a.depth-1).type.compatibleContent(o)&&0==a.startIndex){if(0==r.index(a.depth-1))return!1;var u=t.doc.resolve(a.start-2);l=new Ht(u,u,a.depth),a.endIndex<a.parent.childCount&&(a=new Ht(r,t.doc.resolve(s.end(a.depth)),a.depth)),c=!0}var f=Ke(l,o,i,a);return!!f&&(e&&e(function(t,e,n,r,o){for(var i=gt.empty,s=n.length-1;s>=0;s--)i=gt.from(n[s].type.create(n[s].attrs,i));t.step(new Fe(e.start-(r?2:0),e.end,e.start,e.end,new _t(i,0,0),n.length,!0));for(var a=0,c=0;c<n.length;c++)n[c].type==o&&(a=c+1);for(var l=n.length-a,u=e.start+n.length-(r?2:0),f=e.parent,p=e.startIndex,h=e.endIndex,d=!0;p<h;p++,d=!1)!d&&Ye(t.doc,u,l)&&(t.split(u,l),u+=2*l),u+=f.child(p).nodeSize;return t}(t.tr,a,f,c,o).scrollIntoView()),!0)})(n,r);var o,i}});const Fa=Bs.create({name:"commands",addCommands:()=>({...js,...Vs,...Ls,...Hs,...Fs,...Ws,...qs,...Js,...Ks,...Zs,...Xs,...ta,...ea,...na,...ra,...oa,...ia,...aa,...ca,...la,...ua,...fa,...pa,...ha,...ma,...va,...ga,...ya,...ba,...wa,...xa,...ka,...$a,..._a,...Ma,...Sa,...Ca,...Aa,...Na,...Da,...za,...Ra,...Ia,...Ba,...Pa,...ja,...Va,...La,...Ha})}),Wa=Bs.create({name:"editable",addProseMirrorPlugins(){return[new Dn({key:new In("editable"),props:{editable:()=>this.editor.options.editable}})]}}),qa=Bs.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Dn({key:new In("focusEvents"),props:{attributes:{tabindex:"0"},handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Ja=Bs.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first((({commands:t})=>[()=>t.undoInputRule(),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()])),e=()=>this.editor.commands.first((({commands:t})=>[()=>t.deleteSelection(),()=>t.joinForward(),()=>t.selectNodeForward()]));return{Enter:()=>this.editor.commands.first((({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:()=>t(),"Mod-Backspace":()=>t(),Delete:()=>e(),"Mod-Delete":()=>e()}}});var Ka=Object.freeze({__proto__:null,ClipboardTextSerializer:Ps,Commands:Fa,Editable:Wa,FocusEvents:qa,Keymap:Ja});class Ua extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter((t=>t!==e)):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get commands(){return this.commandManager.createCommands()}chain(){return this.commandManager.createChain()}can(){return this.commandManager.createCan()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',document.getElementsByTagName("head")[0].appendChild(n),n}())}setOptions(t={}){this.options={...this.options,...t}}setEditable(t){this.setOptions({editable:t}),this.view&&this.state&&!this.isDestroyed&&this.view.updateState(this.state)}get isEditable(){return this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n="function"==typeof e?e(t,this.state.plugins):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});this.view.updateState(r)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((t=>!t.key.startsWith(e)))});this.view.updateState(n)}createExtensionManager(){const t=[...Object.entries(Ka).map((([,t])=>t)),...this.options.extensions].filter((t=>["extension","node","mark"].includes(null==t?void 0:t.type)));this.extensionManager=new zs(t,this)}createCommandManager(){this.commandManager=new _s(this,this.extensionManager.commands)}createSchema(){this.schema=this.extensionManager.schema}createView(){this.view=new bi(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Tn.create({doc:$s(this.options.content,this.schema,this.options.parseOptions)})});const t=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(t),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach((t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)})):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this});const r=t.getMeta("focus"),o=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event}),o&&this.emit("blur",{editor:this,event:o.event}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return function(t,e){const n=hs("string"==typeof e?e:e.name,t.schema);return"node"===n?ms(t,e):"mark"===n?gs(t,e):{}}(this.state,t)}getNodeAttributes(t){return console.warn("[tiptap warn]: editor.getNodeAttributes() is deprecated. please use editor.getAttributes() instead."),ms(this.state,t)}getMarkAttributes(t){return console.warn("[tiptap warn]: editor.getMarkAttributes() is deprecated. please use editor.getAttributes() instead."),gs(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,r="string"==typeof t?e:t;return function(t,e,n={}){if(!e)return bs(t,null,n)||ws(t,null,n);const r=hs(e,t.schema);return"node"===r?bs(t,e,n):"mark"===r&&ws(t,e,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function(t,e){const n=Ce.fromSchema(e).serializeFragment(t.content),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}(this.state.doc,this.schema)}get isEmpty(){return function(t){var e;const n=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),r=t.toJSON();return JSON.stringify(n)===JSON.stringify(r)}(this.state.doc)}getCharacterCount(){return this.state.doc.content.size-2}destroy(){var t;this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners(),(t=this.css)&&t.parentNode&&t.parentNode.removeChild(t)}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}class Ya{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,this.options=this.config.defaultOptions}static create(t={}){return new Ya(t)}configure(t={}){const e=this.extend();return e.options=Is(this.options,t),e}extend(t={}){const e=new Ya(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,e.options=t.defaultOptions?t.defaultOptions:e.parent.options,e}}class Ga{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,this.options=this.config.defaultOptions}static create(t={}){return new Ga(t)}configure(t={}){const e=this.extend();return e.options=Is(this.options,t),e}extend(t={}){const e=new Ga(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,e.options=t.defaultOptions?t.defaultOptions:e.parent.options,e}}function Za(t,e,n){return new ji(t,((t,r,o,i)=>{const s=n instanceof Function?n(r):n,{tr:a}=t,c=r[r.length-1],l=r[0];let u=i;if(c){const n=l.search(/\S/),r=o+l.indexOf(c),f=r+c.length;if(function(t,e,n){let r=[];return n.doc.nodesBetween(t,e,((t,e)=>{r=[...r,...t.marks.map((n=>({from:e,to:e+t.nodeSize,mark:n})))]})),r}(o,i,t).filter((t=>{const{excluded:n}=t.mark.type;return n.find((t=>t.name===e.name))})).filter((t=>t.to>r)).length)return null;f<i&&a.delete(f,i),r>o&&a.delete(o+n,r),u=o+n+c.length,a.addMark(o+n,u,e.create(s)),a.removeStoredMark(e)}return a}))}function Xa(t,e,n){const r=(o,i)=>{const s=[];return o.forEach((o=>{if(o.isText&&o.text){const{text:r}=o;let a,c=0;for(;null!==(a=t.exec(r));){const t=Math.max(a.length-2,0),r=Math.max(a.length-1,0);if(null==i?void 0:i.type.allowsMarkType(e)){const i=a.index+a[0].indexOf(a[t]),l=i+a[t].length,u=i+a[t].lastIndexOf(a[r]),f=u+a[r].length,p=n instanceof Function?n(a):n;i>0&&s.push(o.cut(c,i)),s.push(o.cut(u,f).mark(e.create(p).addToSet(o.marks))),c=l}}c<r.length&&s.push(o.cut(c))}else s.push(o.copy(r(o.content,o)))})),gt.fromArray(s)};return new Dn({key:new In("markPasteRule"),props:{transformPasted:t=>new _t(r(t.content),t.openStart,t.openEnd)}})}var Qa=function(t,e){var n=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var r=function(t){return n[e](t)};return t.dom.addEventListener(e,r),{name:e,handler:r}}))};Qa.prototype.destroy=function(){var t=this;this.handlers.forEach((function(e){var n=e.name,r=e.handler;return t.editorView.dom.removeEventListener(n,r)}))},Qa.prototype.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())},Qa.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},Qa.prototype.updateOverlay=function(){var t,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var n=e.nodeBefore,r=e.nodeAfter;if(n||r){var o=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0)).getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:o.left,right:o.right,top:i-this.width/2,bottom:i+this.width/2}}}if(!t){var s=this.editorView.coordsAtPos(this.cursorPos);t={left:s.left-this.width/2,right:s.left+this.width/2,top:s.top,bottom:s.bottom}}var a,c,l=this.editorView.dom.offsetParent;if(this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!l||l==document.body&&"static"==getComputedStyle(l).position)a=-pageXOffset,c=-pageYOffset;else{var u=l.getBoundingClientRect();a=u.left-l.scrollLeft,c=u.top-l.scrollTop}this.element.style.left=t.left-a+"px",this.element.style.top=t.top-c+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"},Qa.prototype.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},Qa.prototype.dragover=function(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY});if(e){var n=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(n=Ze(this.editorView.state.doc,n,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(n),this.scheduleRemoval(5e3)}}},Qa.prototype.dragend=function(){this.scheduleRemoval(20)},Qa.prototype.drop=function(){this.scheduleRemoval(20)},Qa.prototype.dragleave=function(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)};const tc=Bs.create({name:"dropCursor",defaultOptions:{color:"currentColor",width:1,class:null},addProseMirrorPlugins(){return[(t=this.options,void 0===t&&(t={}),new Dn({view:function(e){return new Qa(e,t)}}))];var t}});var ec=function(t){function e(e){t.call(this,e,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));return e.valid(o)?new e(o):t.near(o)},e.prototype.content=function(){return _t.empty},e.prototype.eq=function(t){return t instanceof e&&t.head==this.head},e.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(n.pos))},e.prototype.getBookmark=function(){return new nc(this.anchor)},e.valid=function(t){var e=t.parent;if(e.isTextblock||!function(t){for(var e=t.depth;e>=0;e--){var n=t.index(e);if(0!=n)for(var r=t.node(e).child(n-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}(t)||!function(t){for(var e=t.depth;e>=0;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(t))return!1;var n=e.type.spec.allowGapCursor;if(null!=n)return n;var r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock},e.findFrom=function(t,n,r){t:for(;;){if(!r&&e.valid(t))return t;for(var o=t.pos,i=null,s=t.depth;;s--){var a=t.node(s);if(n>0?t.indexAfter(s)<a.childCount:t.index(s)>0){i=a.child(n>0?t.indexAfter(s):t.index(s)-1);break}if(0==s)return null;o+=n;var c=t.doc.resolve(o);if(e.valid(c))return c}for(;;){var l=n>0?i.firstChild:i.lastChild;if(!l){if(i.isAtom&&!i.isText&&!yn.isSelectable(i)){t=t.doc.resolve(o+i.nodeSize*n),r=!1;continue t}break}i=l,o+=n;var u=t.doc.resolve(o);if(e.valid(u))return u}return null}},e}(hn);ec.prototype.visible=!1,hn.jsonID("gapcursor",ec);var nc=function(t){this.pos=t};nc.prototype.map=function(t){return new nc(t.map(this.pos))},nc.prototype.resolve=function(t){var e=t.resolve(this.pos);return ec.valid(e)?new ec(e):hn.near(e)};var rc=Pi({ArrowLeft:oc("horiz",-1),ArrowRight:oc("horiz",1),ArrowUp:oc("vert",-1),ArrowDown:oc("vert",1)});function oc(t,e){var n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,o){var i=t.selection,s=e>0?i.$to:i.$from,a=i.empty;if(i instanceof vn){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=t.doc.resolve(e>0?s.after():s.before())}var c=ec.findFrom(s,e,a);return!!c&&(r&&r(t.tr.setSelection(new ec(c))),!0)}}function ic(t,e,n){if(!t.editable)return!1;var r=t.state.doc.resolve(e);if(!ec.valid(r))return!1;var o=t.posAtCoords({left:n.clientX,top:n.clientY}).inside;return!(o>-1&&yn.isSelectable(t.state.doc.nodeAt(o))||(t.dispatch(t.state.tr.setSelection(new ec(r))),0))}function sc(t){if(!(t.selection instanceof ec))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",ci.create(t.doc,[oi.widget(t.selection.head,e,{key:"gapcursor"})])}const ac=Bs.create({name:"gapCursor",addProseMirrorPlugins:()=>[new Dn({props:{decorations:sc,createSelectionBetween:function(t,e,n){if(e.pos==n.pos&&ec.valid(n))return new ec(n)},handleClick:ic,handleKeyDown:rc}})],extendNodeSchema(t){var e;return{allowGapCursor:null!==(e=Ns(Ms(t,"allowGapCursor",{name:t.name,options:t.options})))&&void 0!==e?e:null}}}),cc=Ya.create({name:"doc",topNode:!0,content:"block+"}),lc=Ya.create({name:"paragraph",priority:1e3,defaultOptions:{HTMLAttributes:{}},group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({setParagraph:()=>({commands:t})=>t.toggleNode("paragraph","paragraph")}),addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),uc=Ya.create({name:"text",group:"inline"});var fc=200,pc=function(){};pc.prototype.append=function(t){return t.length?(t=pc.from(t),!this.length&&t||t.length<fc&&this.leafAppend(t)||this.length<fc&&t.leafPrepend(this)||this.appendInner(t)):this},pc.prototype.prepend=function(t){return t.length?pc.from(t).append(this):this},pc.prototype.appendInner=function(t){return new dc(this,t)},pc.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?pc.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},pc.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},pc.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},pc.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(e,n){return r.push(t(e,n))}),e,n),r},pc.from=function(t){return t instanceof pc?t:t&&t.length?new hc(t):pc.empty};var hc=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;o>=n;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=fc)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=fc)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(pc);pc.empty=new hc([]);var dc=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(pc);const mc=pc;var vc=function(t,e){this.items=t,this.eventCount=e};vc.prototype.popEvent=function(t,e){var n=this;if(0==this.eventCount)return null;for(var r,o,i=this.items.length;;i--)if(this.items.get(i-1).selection){--i;break}e&&(r=this.remapping(i,this.items.length),o=r.maps.length);var s,a,c=t.tr,l=[],u=[];return this.items.forEach((function(t,e){if(!t.step)return r||(r=n.remapping(i,e+1),o=r.maps.length),o--,void u.push(t);if(r){u.push(new gc(t.map));var f,p=t.step.map(r.slice(o));p&&c.maybeStep(p).doc&&(f=c.mapping.maps[c.mapping.maps.length-1],l.push(new gc(f,null,null,l.length+u.length))),o--,f&&r.appendMap(f,o)}else c.maybeStep(t.step);return t.selection?(s=r?t.selection.map(r.slice(o)):t.selection,a=new vc(n.items.slice(0,i).append(u.reverse().concat(l)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:a,transform:c,selection:s}},vc.prototype.addTransform=function(t,e,n,r){for(var o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null,c=0;c<t.steps.length;c++){var l,u=t.steps[c].invert(t.docs[c]),f=new gc(t.mapping.maps[c],u,e);(l=a&&a.merge(f))&&(f=l,c?o.pop():s=s.slice(0,s.length-1)),o.push(f),e&&(i++,e=null),r||(a=f)}var p,h,d,m=i-n.depth;return m>bc&&(h=m,(p=s).forEach((function(t,e){if(t.selection&&0==h--)return d=e,!1})),s=p.slice(d),i-=m),new vc(s.append(o),i)},vc.prototype.remapping=function(t,e){var n=new ze;return this.items.forEach((function(e,r){var o=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:null;n.appendMap(e.map,o)}),t,e),n},vc.prototype.addMaps=function(t){return 0==this.eventCount?this:new vc(this.items.append(t.map((function(t){return new gc(t)}))),this.eventCount)},vc.prototype.rebased=function(t,e){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-e),o=t.mapping,i=t.steps.length,s=this.eventCount;this.items.forEach((function(t){t.selection&&s--}),r);var a=e;this.items.forEach((function(e){var r=o.getMirror(--a);if(null!=r){i=Math.min(i,r);var c=o.maps[r];if(e.step){var l=t.steps[r].invert(t.docs[r]),u=e.selection&&e.selection.map(o.slice(a+1,r));u&&s++,n.push(new gc(c,l,u))}else n.push(new gc(c))}}),r);for(var c=[],l=e;l<i;l++)c.push(new gc(o.maps[l]));var u=this.items.slice(0,r).append(c).append(n),f=new vc(u,s);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-n.length)),f},vc.prototype.emptyItemCount=function(){var t=0;return this.items.forEach((function(e){e.step||t++})),t},vc.prototype.compress=function(t){void 0===t&&(t=this.items.length);var e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((function(i,s){if(s>=t)r.push(i),i.selection&&o++;else if(i.step){var a=i.step.map(e.slice(n)),c=a&&a.getMap();if(n--,c&&e.appendMap(c,n),a){var l=i.selection&&i.selection.map(e.slice(n));l&&o++;var u,f=new gc(c.invert(),a,l),p=r.length-1;(u=r.length&&r[p].merge(f))?r[p]=u:r.push(f)}}else i.map&&n--}),this.items.length,0),new vc(mc.from(r.reverse()),o)},vc.empty=new vc(mc.empty,0);var gc=function(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r};gc.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var e=t.step.merge(this.step);if(e)return new gc(e.getMap().invert(),e,this.selection)}};var yc=function(t,e,n,r){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r},bc=20;function wc(t){var e=[];return t.forEach((function(t,n,r,o){return e.push(r,o)})),e}function xc(t,e){if(!t)return null;for(var n=[],r=0;r<t.length;r+=2){var o=e.map(t[r],1),i=e.map(t[r+1],-1);o<=i&&n.push(o,i)}return n}function kc(t,e,n,r){var o=Mc(e),i=Sc.get(e).spec.config,s=(r?t.undone:t.done).popEvent(e,o);if(s){var a=s.selection.resolve(s.transform.doc),c=(r?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,o),l=new yc(r?c:s.remaining,r?s.remaining:c,null,0);n(s.transform.setSelection(a).setMeta(Sc,{redo:r,historyState:l}).scrollIntoView())}}var $c=!1,_c=null;function Mc(t){var e=t.plugins;if(_c!=e){$c=!1,_c=e;for(var n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){$c=!0;break}}return $c}var Sc=new In("history"),Cc=new In("closeHistory");const Oc=Bs.create({name:"history",defaultOptions:{depth:100,newGroupDelay:500},addCommands:()=>({undo:()=>({state:t,dispatch:e})=>function(t,e){var n=Sc.getState(t);return!(!n||0==n.done.eventCount||(e&&kc(n,t,e,!1),0))}(t,e),redo:()=>({state:t,dispatch:e})=>function(t,e){var n=Sc.getState(t);return!(!n||0==n.undone.eventCount||(e&&kc(n,t,e,!0),0))}(t,e)}),addProseMirrorPlugins(){return[(t=this.options,t={depth:t&&t.depth||100,newGroupDelay:t&&t.newGroupDelay||500},new Dn({key:Sc,state:{init:function(){return new yc(vc.empty,vc.empty,null,0)},apply:function(e,n,r){return function(t,e,n,r){var o,i=n.getMeta(Sc);if(i)return i.historyState;n.getMeta(Cc)&&(t=new yc(t.done,t.undone,null,0));var s=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(s&&s.getMeta(Sc))return s.getMeta(Sc).redo?new yc(t.done.addTransform(n,null,r,Mc(e)),t.undone,wc(n.mapping.maps[n.steps.length-1]),t.prevTime):new yc(t.done,t.undone.addTransform(n,null,r,Mc(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new yc(t.done.rebased(n,o),t.undone.rebased(n,o),xc(t.prevRanges,n.mapping),t.prevTime):new yc(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),xc(t.prevRanges,n.mapping),t.prevTime);var a=0==t.prevTime||!s&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach((function(t,r){for(var o=0;o<e.length;o+=2)t<=e[o+1]&&r>=e[o]&&(n=!0)})),n}(n,t.prevRanges)),c=s?xc(t.prevRanges,n.mapping):wc(n.mapping.maps[n.steps.length-1]);return new yc(t.done.addTransform(n,a?e.selection.getBookmark():null,r,Mc(e)),vc.empty,c,n.time)}(n,r,e,t)}},config:t}))];var t},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}}}),Tc=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/gm,Ac=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/gm,Nc=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/gm,Ec=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/gm,Dc=Ga.create({name:"bold",defaultOptions:{HTMLAttributes:{}},parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],renderHTML({HTMLAttributes:t}){return["strong",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({setBold:()=>({commands:t})=>t.setMark("bold"),toggleBold:()=>({commands:t})=>t.toggleMark("bold"),unsetBold:()=>({commands:t})=>t.unsetMark("bold")}),addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Za(Tc,this.type),Za(Nc,this.type)]},addPasteRules(){return[Xa(Ac,this.type),Xa(Ec,this.type)]}}),zc=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/gm,Rc=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/gm,Ic=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/gm,Bc=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/gm,Pc=Ga.create({name:"italic",defaultOptions:{HTMLAttributes:{}},parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:t}){return["em",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({setItalic:()=>({commands:t})=>t.setMark("italic"),toggleItalic:()=>({commands:t})=>t.toggleMark("italic"),unsetItalic:()=>({commands:t})=>t.unsetMark("italic")}),addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Za(zc,this.type),Za(Ic,this.type)]},addPasteRules(){return[Xa(Rc,this.type),Xa(Bc,this.type)]}}),jc=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/gm,Vc=Ga.create({name:"code",defaultOptions:{HTMLAttributes:{}},excludes:"_",parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:t}){return["code",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({setCode:()=>({commands:t})=>t.setMark("code"),toggleCode:()=>({commands:t})=>t.toggleMark("code"),unsetCode:()=>({commands:t})=>t.unsetMark("code")}),addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Za(jc,this.type)]},addPasteRules(){return[Xa(jc,this.type)]}}),Lc=/^```(?<language>[a-z]*)? $/,Hc=/^~~~(?<language>[a-z]*)? $/,Fc=Ya.create({name:"codeBlock",defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const n=null===(e=t.firstElementChild)||void 0===e?void 0:e.getAttribute("class");if(!n)return null;const r=new RegExp(`^(${this.options.languageClassPrefix})`);return{language:n.replace(r,"")}},renderHTML:t=>t.language?{class:this.options.languageClassPrefix+t.language}:null}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({HTMLAttributes:t}){return["pre",this.options.HTMLAttributes,["code",t,0]]},addCommands:()=>({setCodeBlock:t=>({commands:e})=>e.setNode("codeBlock",t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode("codeBlock","paragraph",t)}),addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&!(!n&&e.parent.textContent.length)&&this.editor.commands.clearNodes()}}},addInputRules(){return[Hi(Lc,this.type,(({groups:t})=>t)),Hi(Hc,this.type,(({groups:t})=>t))]}}),Wc=Ya.create({name:"heading",defaultOptions:{levels:[1,2,3,4,5,6],HTMLAttributes:{}},content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map((t=>({tag:`h${t}`,attrs:{level:t}})))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Os(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode("heading",t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode("heading","paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce(((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})})),{})},addInputRules(){return this.options.levels.map((t=>Hi(new RegExp(`^(#{1,${t}})\\s$`),this.type,{level:t})))}}),qc=Ya.create({name:"hardBreak",defaultOptions:{HTMLAttributes:{}},inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:t}){return["br",Os(this.options.HTMLAttributes,t)]},addCommands(){return{setHardBreak:()=>({commands:t})=>t.first([()=>t.exitCode(),()=>t.insertContent({type:this.name})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Jc=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/gm,Kc=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/gm,Uc=Ga.create({name:"strike",defaultOptions:{HTMLAttributes:{}},parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML({HTMLAttributes:t}){return["s",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({setStrike:()=>({commands:t})=>t.setMark("strike"),toggleStrike:()=>({commands:t})=>t.toggleMark("strike"),unsetStrike:()=>({commands:t})=>t.unsetMark("strike")}),addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Za(Jc,this.type)]},addPasteRules(){return[Xa(Kc,this.type)]}}),Yc=/^\s*>\s$/gm,Gc=Ya.create({name:"blockquote",defaultOptions:{HTMLAttributes:{}},content:"block*",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:t}){return["blockquote",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({setBlockquote:()=>({commands:t})=>t.wrapIn("blockquote"),toggleBlockquote:()=>({commands:t})=>t.toggleWrap("blockquote"),unsetBlockquote:()=>({commands:t})=>t.lift("blockquote")}),addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Li(Yc,this.type)]}}),Zc=Ya.create({name:"horizontalRule",defaultOptions:{HTMLAttributes:{}},group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:t}){return["hr",Os(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command((({tr:t,dispatch:e})=>{var n;if(e){const{parent:e,pos:r}=t.selection.$from,o=r+1;if(!t.doc.nodeAt(o)){const r=null===(n=e.type.contentMatch.defaultType)||void 0===n?void 0:n.create();r&&(t.insert(o,r),t.setSelection(vn.create(t.doc,o)))}t.scrollIntoView()}return!0})).run()}},addInputRules(){return[(t=/^(?:---|—-|___\s|\*\*\*\s)$/,e=this.type,new ji(t,((t,r,o,i)=>{const s=n instanceof Function?n(r):n,{tr:a}=t;return r[0]&&a.replaceWith(o-1,i,e.create(s)),a})))];var t,e,n}}),Xc=/^\s*([-+*])\s$/,Qc=Ya.create({name:"bulletList",defaultOptions:{HTMLAttributes:{}},group:"block list",content:"listItem+",parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:t}){return["ul",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({toggleBulletList:()=>({commands:t})=>t.toggleList("bulletList","listItem")}),addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Li(Xc,this.type)]}}),tl=/^(\d+)\.\s$/,el=Ya.create({name:"orderedList",defaultOptions:{HTMLAttributes:{}},group:"block list",content:"listItem+",addAttributes:()=>({start:{default:1,parseHTML:t=>({start:t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1})}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return 1===e?["ol",Os(this.options.HTMLAttributes,n),0]:["ol",Os(this.options.HTMLAttributes,t),0]},addCommands:()=>({toggleOrderedList:()=>({commands:t})=>t.toggleList("orderedList","listItem")}),addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Li(tl,this.type,(t=>({order:+t[1]})),((t,e)=>e.childCount+e.attrs.order===+t[1]))]}}),nl=Ya.create({name:"listItem",defaultOptions:{HTMLAttributes:{}},content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",Os(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem("listItem"),Tab:()=>this.editor.commands.sinkListItem("listItem"),"Shift-Tab":()=>this.editor.commands.liftListItem("listItem")}}}),rl=Bs.create({name:"starterKit",addExtensions(){var t,e,n,r,o,i,s,a,c,l,u,f,p,h,d,m,v,g;const y=[];return!1!==this.options.blockquote&&y.push(Gc.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bold&&y.push(Dc.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.bulletList&&y.push(Qc.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&y.push(Vc.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&y.push(Fc.configure(null===(o=this.options)||void 0===o?void 0:o.codeBlock)),!1!==this.options.document&&y.push(cc.configure(null===(i=this.options)||void 0===i?void 0:i.document)),!1!==this.options.dropcursor&&y.push(tc.configure(null===(s=this.options)||void 0===s?void 0:s.dropcursor)),!1!==this.options.gapcursor&&y.push(ac.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&y.push(qc.configure(null===(c=this.options)||void 0===c?void 0:c.hardBreak)),!1!==this.options.heading&&y.push(Wc.configure(null===(l=this.options)||void 0===l?void 0:l.heading)),!1!==this.options.history&&y.push(Oc.configure(null===(u=this.options)||void 0===u?void 0:u.history)),!1!==this.options.horizontalRule&&y.push(Zc.configure(null===(f=this.options)||void 0===f?void 0:f.horizontalRule)),!1!==this.options.italic&&y.push(Pc.configure(null===(p=this.options)||void 0===p?void 0:p.italic)),!1!==this.options.listItem&&y.push(nl.configure(null===(h=this.options)||void 0===h?void 0:h.listItem)),!1!==this.options.orderedList&&y.push(el.configure(null===(d=this.options)||void 0===d?void 0:d.orderedList)),!1!==this.options.paragraph&&y.push(lc.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&y.push(Uc.configure(null===(v=this.options)||void 0===v?void 0:v.strike)),!1!==this.options.text&&y.push(uc.configure(null===(g=this.options)||void 0===g?void 0:g.text)),y}}),ol=[];function il(e,n=t){let r;const o=[];function i(t){if(s(e,t)&&(e=t,r)){const t=!ol.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),ol.push(n,e)}if(t){for(let t=0;t<ol.length;t+=2)ol[t][0](ol[t+1]);ol.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(s,a=t){const c=[s,a];return o.push(c),1===o.length&&(r=n(i)||t),s(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}const sl="#3e3e3f";function al(e){let n,r,o,i,s,a,c,l,u;return{c(){n=_("svg"),r=_("defs"),o=_("clipPath"),i=_("path"),s=_("g"),a=_("path"),l=_("path"),u=_("path"),T(i,"d","M31.5 517.639H297v64.824H31.5z"),T(o,"clipPathUnits","userSpaceOnUse"),T(a,"d","M294.1907 545.1761c0-4.484-3.635-8.118-8.119-8.118-4.483 0-8.118 3.634-8.118 8.118s3.635 8.118 8.118 8.118c4.484 0 8.119-3.634 8.119-8.118"),T(a,"fill",c=ul?"hsl(120deg 60% 70%)":"white"),T(l,"d","M294.1907 545.1761c0-4.484-3.635-8.118-8.119-8.118-4.483 0-8.118 3.634-8.118 8.118s3.635 8.118 8.118 8.118c4.484 0 8.119-3.634 8.119-8.118z"),T(l,"fill","none"),T(l,"stroke","#393536"),T(l,"stroke-width","1.873"),T(l,"stroke-miterlimit","10"),T(u,"d","M285.1126 540.1478l-4.225 3.228 1.084 1.42 2.807-2.146 5.06 6.624 1.419-1.084z"),T(u,"fill","#393536"),T(s,"transform","matrix(.35278 0 0 -.35278 -97.7255 195.5202)"),T(n,"x","15px"),T(n,"y","6px"),T(n,"width","12px"),T(n,"viewBox","0 0 6.3888 6.3885"),T(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){w(t,n,e),b(n,r),b(r,o),b(o,i),b(n,s),b(s,a),b(s,l),b(s,u)},p:t,d(t){t&&x(n)}}}function cl(e){let n,r,o,i,s,a,c,l,u;return{c(){n=_("svg"),r=_("defs"),o=_("clipPath"),i=_("path"),s=_("g"),a=_("path"),l=_("path"),u=_("path"),T(i,"d","M31.5 517.64H297v64.82H31.5z"),T(o,"clipPathUnits","userSpaceOnUse"),T(a,"d","M294.16 545.2a8.12 8.12 0 10-16.24 0 8.12 8.12 0 0016.24 0"),T(a,"fill",c=ul?"hsl(0deg 100% 65%)":"white"),T(l,"d","M294.16 545.2a8.12 8.12 0 10-16.24 0 8.12 8.12 0 0016.24 0z"),T(l,"fill","none"),T(l,"stroke","#393536"),T(l,"stroke-width","1.87"),T(l,"stroke-miterlimit","10"),T(u,"d","M290.59 542.19l-1.44-1.5-3.11 2.82-3.12-2.82-1.43 1.5 3 2.73-3 2.72 1.33 1.6 3.22-2.92 3.21 2.93 1.34-1.61-3-2.72z"),T(u,"fill","#393536"),T(s,"transform","matrix(.35278 0 0 -.35278 -97.71 195.53)"),T(n,"x","15px"),T(n,"y","6px"),T(n,"width","12px"),T(n,"viewBox","0 0 6.39 6.39"),T(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){w(t,n,e),b(n,r),b(r,o),b(o,i),b(n,s),b(s,a),b(s,l),b(s,u)},p:t,d(t){t&&x(n)}}}function ll(e){let n,r,o,i,s,a,c,l,u,f,p,h,d,m,v,g,y,k=!0===e[1]&&al(),$=!1===e[1]&&cl();return{c(){n=_("svg"),r=_("defs"),o=_("clipPath"),i=_("path"),s=_("g"),a=_("path"),c=_("path"),l=_("path"),u=_("path"),f=_("path"),p=_("path"),h=_("text"),d=M(e[0]),k&&k.c(),y=C(),$&&$.c(),T(i,"d","M50.4 400.07h306v104.48h-306z"),T(o,"clipPathUnits","userSpaceOnUse"),T(a,"d","M133.26 466.57l-34.13 36.74a3.86 3.86 0 01-5.66 0l-34.14-36.74a3.86 3.86 0 01.02-5.28l34.14-36.13a3.86 3.86 0 015.61 0l34.14 36.13a3.86 3.86 0 01.02 5.28"),T(a,"fill","#414042"),T(c,"d","M99.18 463.33l13.9 6c.64.28 1.1.75 1.26 1.34.18.59.07 1.23-.32 1.8l-16.45 24.89c-.36.55-.81.85-1.27.85-.46 0-.91-.3-1.28-.85l-16.45-24.89a2.14 2.14 0 01-.32-1.8c.17-.59.62-1.06 1.25-1.34l13.91-6c.74-.32 1.8-.5 2.89-.5s2.14.18 2.88.5"),T(c,"fill","#e6e7e8"),T(l,"d","M128.81 462.68c-.1.5-.49.9-1.1 1.18l-7.48 3.27a7.6 7.6 0 01-2.9.51 7.57 7.57 0 01-2.86-.5l-13.9-6a4.97 4.97 0 01-2.73-4.15v-26.48c0-.7.17-.96.22-1 .1 0 .4.13.83.58l29.37 31.08c.45.49.65 1.02.55 1.51"),T(l,"fill","#77787b"),T(u,"d","M120.85 469.32l7.26-3.18-25.22 27.15 13.2-19.96c.97-1.47 3.15-3.31 4.76-4.01"),T(u,"fill","#939598"),T(f,"d","M92.03 461.14l-13.91 6c-.74.32-1.78.5-2.86.5-1.1 0-2.15-.19-2.9-.51l-7.48-3.28c-.61-.26-1-.68-1.1-1.17-.1-.49.1-1.02.55-1.5l29.37-31.09c.42-.45.72-.57.83-.57.05.03.22.28.22 1v26.47c0 1.61-1.25 3.51-2.72 4.15"),T(f,"fill","#77787b"),T(p,"d","M71.74 469.32c1.61.7 3.8 2.54 4.77 4l13.2 19.97-25.23-27.15z"),T(p,"fill","#939598"),T(s,"transform","matrix(.35278 0 0 -.35278 -20.56 178)"),T(h,"x",m=e[2][e[0]].x),T(h,"y",v=e[2][e[0]].y),T(h,"font-size",g=e[0]>=10?"8.5px":"10px"),T(h,"font-family","sans-serif"),T(h,"fill",sl),T(h,"font-weight","bold"),T(h,"textLength","8.5px"),T(h,"text-anchor","middle"),T(n,"height","100%"),T(n,"viewBox","0 0 26.81 28.43"),T(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){w(t,n,e),b(n,r),b(r,o),b(o,i),b(n,s),b(s,a),b(s,c),b(s,l),b(s,u),b(s,f),b(s,p),b(n,h),b(h,d),k&&k.m(n,null),b(n,y),$&&$.m(n,null)},p(t,[e]){1&e&&N(d,t[0]),1&e&&m!==(m=t[2][t[0]].x)&&T(h,"x",m),1&e&&v!==(v=t[2][t[0]].y)&&T(h,"y",v),1&e&&g!==(g=t[0]>=10?"8.5px":"10px")&&T(h,"font-size",g),!0===t[1]?k?k.p(t,e):(k=al(),k.c(),k.m(n,y)):k&&(k.d(1),k=null),!1===t[1]?$?$.p(t,e):($=cl(),$.c(),$.m(n,null)):$&&($.d(1),$=null)},i:t,o:t,d(t){t&&x(n),k&&k.d(),$&&$.d()}}}const ul=!0;function fl(t,e,n){let{number:r}=e,{isHit:o}=e;return t.$$set=t=>{"number"in t&&n(0,r=t.number),"isHit"in t&&n(1,o=t.isHit)},[r,o,{0:{x:"13.5px",y:"13px"},1:{x:"13.5px",y:"13px"},2:{x:"13.5px",y:"13px"},3:{x:"13.5px",y:"13px"},4:{x:"13.5px",y:"13px"},5:{x:"13.5px",y:"13px"},6:{x:"13.5px",y:"13px"},7:{x:"13.5px",y:"13.5px"},8:{x:"13.5px",y:"13px"},9:{x:"13.5px",y:"13px"},10:{x:"13.2px",y:"13.4px"}}]}const pl=class extends pt{constructor(t){super(),ft(this,t,fl,ll,s,{number:0,isHit:1})}};function hl(e){let n,r,o,i,s,a,c,l,u,f,p;return{c(){n=_("svg"),r=_("defs"),o=_("clipPath"),i=_("path"),s=_("g"),a=_("path"),c=_("path"),l=_("path"),u=_("path"),f=_("text"),p=M(e[0]),T(i,"d","M50.4 400h306v104.5h-306z"),T(o,"clipPathUnits","userSpaceOnUse"),T(a,"d","M285.8 424h41c.6 0 1 0 1.5.3l21 9.3c1.3.6 2.2 1.9 2.2 3.3v40.6c0 2-1.6 3.6-3.6 3.6H309c-.5 0-1-.1-1.3-.3l-23.2-9a3.6 3.6 0 01-2.3-3.3v-41c0-2 1.6-3.6 3.5-3.6"),T(a,"fill","#414042"),T(c,"d","M323.6 467.8h-34.5a2.5 2.5 0 01-2.5-2.5v-34.6c0-1.3 1-2.5 2.5-2.5h34.5c1.4 0 2.5 1.2 2.5 2.5v34.6c0 1.4-1 2.5-2.5 2.5"),T(c,"fill","#e6e7e8"),T(l,"d","M347.9 440.5v34.1c0 1-.5 1.5-1.2 1.5a2 2 0 01-.8-.2l-15-6.4a4.6 4.6 0 01-2.6-3.8V431c0-.9.4-1.4 1.1-1.4l.8.1 15.2 6.8c1.3.6 2.5 2.4 2.5 3.9"),T(l,"fill","#77787b"),T(u,"d","M323.6 470c1.7 0 4.4.5 6 1.2l14.8 6.3h-32.1c-1.7 0-4.4-.5-6-1.1l-16.6-6.4z"),T(u,"fill","#bcbec0"),T(s,"transform","matrix(.35278 0 0 -.35278 -99.6 169.7)"),T(f,"x","8.5px"),T(f,"y","15px"),T(f,"font-size","10px"),T(f,"font-family","sans-serif"),T(f,"fill",sl),T(f,"font-weight","bold"),T(f,"textLength","30%"),T(f,"text-anchor","middle"),T(n,"height","100%"),T(n,"viewBox","0 0 24.4 20.2"),T(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){w(t,n,e),b(n,r),b(r,o),b(o,i),b(n,s),b(s,a),b(s,c),b(s,l),b(s,u),b(n,f),b(f,p)},p(t,[e]){1&e&&N(p,t[0])},i:t,o:t,d(t){t&&x(n)}}}function dl(t,e,n){let{number:r}=e;return t.$$set=t=>{"number"in t&&n(0,r=t.number)},[r]}const ml=class extends pt{constructor(t){super(),ft(this,t,dl,hl,s,{number:0})}};function vl(t){let e,n,r,o,s;const a=t[2].default,c=f(a,t,t[1],null);return{c(){e=$("div"),c&&c.c(),e.hidden=!0},m(i,a){w(i,e,a),c&&c.m(e,null),r=!0,o||(s=m(n=gl.call(null,e,t[0])),o=!0)},p(t,[e]){c&&c.p&&(!r||2&e)&&h(c,a,t,t[1],r?e:-1,null,null),n&&i(n.update)&&1&e&&n.update.call(null,t[0])},i(t){r||(it(c,t),r=!0)},o(t){st(c,t),r=!1},d(t){t&&x(e),c&&c.d(t),o=!1,s()}}}function gl(t,e="body"){let n;async function r(r){if("string"==typeof(e=r)){if(n=document.querySelector(e),null===n&&(await U(),n=document.querySelector(e)),null===n)throw new Error(`No element found matching css selector: "${e}"`)}else{if(!(e instanceof HTMLElement))throw new TypeError(`Unknown portal target type: ${null===e?"null":typeof e}. Allowed types: string (CSS selector) or HTMLElement.`);n=e}n.appendChild(t),t.hidden=!1}return r(e),{update:r,destroy:function(){t.parentNode&&t.parentNode.removeChild(t)}}}function yl(t,e,n){let{$$slots:r={},$$scope:o}=e,{target:i="body"}=e;return t.$$set=t=>{"target"in t&&n(0,i=t.target),"$$scope"in t&&n(1,o=t.$$scope)},[i,o,r]}const bl=class extends pt{constructor(t){super(),ft(this,t,yl,vl,s,{target:0})}};function wl(t){let e,n;return e=new bl({props:{$$slots:{default:[xl]},$$scope:{ctx:t}}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};32829&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function xl(t){let e,n;const r=t[13].default,o=f(r,t,t[15],null);return{c(){e=$("div"),o&&o.c(),T(e,"class","popup svelte-hhnpdb"),D(e,"left",t[2]+"px"),D(e,"top",t[4]+"px"),D(e,"--triangleOffset",t[5]+"px"),R(e,"visible",t[3])},m(r,i){w(r,e,i),o&&o.m(e,null),t[14](e),n=!0},p(t,i){o&&o.p&&(!n||32768&i)&&h(o,r,t,t[15],n?i:-1,null,null),(!n||4&i)&&D(e,"left",t[2]+"px"),(!n||16&i)&&D(e,"top",t[4]+"px"),(!n||32&i)&&D(e,"--triangleOffset",t[5]+"px"),8&i&&R(e,"visible",t[3])},i(t){n||(it(o,t),n=!0)},o(t){st(o,t),n=!1},d(n){n&&x(e),o&&o.d(n),t[14](null)}}}function kl(t){let e,n,r=t[1]&&wl(t);return{c(){r&&r.c(),e=C()},m(t,o){r&&r.m(t,o),w(t,e,o),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),2&n&&it(r,1)):(r=wl(t),r.c(),it(r,1),r.m(e.parentNode,e)):r&&(rt(),st(r,1,1,(()=>{r=null})),ot())},i(t){n||(it(r),n=!0)},o(t){st(r),n=!1},d(t){r&&r.d(t),t&&x(e)}}}function $l(t,e,n){let r,o,i,s,a,c,l,u,f,{$$slots:p={},$$scope:h}=e,{anchor:d}=e,{offsetY:m=0}=e,v=!1,g=!1;return t.$$set=t=>{"anchor"in t&&n(6,d=t.anchor),"offsetY"in t&&n(7,m=t.offsetY),"$$scope"in t&&n(15,h=t.$$scope)},t.$$.update=()=>{64&t.$$.dirty&&(null==d||d.addEventListener("mouseenter",(()=>n(1,v=!0))),null==d||d.addEventListener("mouseleave",(()=>n(1,v=!1))),null==d||d.addEventListener("wheel",(()=>n(1,v=!1))),null==d||d.addEventListener("mousedown",(()=>n(1,v=!1)))),67&t.$$.dirty&&(v?requestAnimationFrame((()=>{n(8,u=null==d?void 0:d.getBoundingClientRect()),n(9,f=null==l?void 0:l.getBoundingClientRect()),n(3,g=!0)})):n(3,g=!1)),768&t.$$.dirty&&n(10,r=(null==u?void 0:u.x)+(null==u?void 0:u.width)/2-(null==f?void 0:f.width)/2),512&t.$$.dirty&&n(12,i=document.body.getBoundingClientRect().width-5-(null==f?void 0:f.width)),7168&t.$$.dirty&&n(2,s=Math.min(Math.max(r,o),i)),896&t.$$.dirty&&n(4,a=(null==u?void 0:u.y)-(null==f?void 0:f.height)+m),1028&t.$$.dirty&&n(5,c=r-s)},n(11,o=document.body.getBoundingClientRect().x+5),[l,v,s,g,a,c,d,m,u,f,r,o,i,p,function(t){H[t?"unshift":"push"]((()=>{l=t,n(0,l)}))},h]}const _l=class extends pt{constructor(t){super(),ft(this,t,$l,kl,s,{anchor:6,offsetY:7})}};function Ml(t){let e;return{c(){e=$("span"),e.textContent="(Max 10)",T(e,"class","maxed svelte-4okdns")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Sl(t){let e;return{c(){e=$("div"),e.innerHTML='<svg viewBox="-10 -10 120 120" xmlns="http://www.w3.org/2000/svg"><path stroke="rgba(255,77,77,0.85)" stroke-width="20" stroke-linecap="round" d="M4.15 4.15l92 92m0-92l-92 92"></path></svg>',T(e,"class","cross svelte-4okdns")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Cl(t){let e,n,r,o,i;return{c(){e=$("span"),n=$("i"),r=M("("),o=M(t[1]),i=M(" Momentum)"),T(e,"class","svelte-4okdns")},m(t,s){w(t,e,s),b(e,n),b(n,r),b(n,o),b(n,i)},p(t,e){2&e&&N(o,t[1])},d(t){t&&x(e)}}}function Ol(t){let e,n,r,o,i,s,a,c,l,u,f,p,h,d,m,v,g,y,k,_,C,O,A,E=t[0].stat.value+"",D=t[0].stat.name+"",z=t[0].adds+"",R=t[0].isMaxed&&Ml(),I=t[0].actionDiceNegated&&Sl();a=new ml({props:{number:t[0].actionDie}});let B=t[0].actionDiceNegated&&Cl(t);return{c(){e=$("div"),R&&R.c(),n=S(),r=$("div"),o=$("div"),i=$("div"),I&&I.c(),s=S(),ct(a.$$.fragment),c=S(),B&&B.c(),l=S(),u=$("span"),u.textContent="+",f=S(),p=$("div"),h=$("span"),d=M(E),m=S(),v=$("span"),g=M(D),y=S(),k=$("span"),k.textContent="+",_=S(),C=$("span"),O=M(z),T(i,"class","d6 svelte-4okdns"),T(o,"class","d6Wrapper svelte-4okdns"),T(u,"class","plus svelte-4okdns"),T(h,"class","value svelte-4okdns"),T(v,"class","type svelte-4okdns"),T(p,"class","stat svelte-4okdns"),T(k,"class","plus svelte-4okdns"),T(C,"class","adds svelte-4okdns"),T(r,"class","calculation svelte-4okdns"),T(e,"class","explanation svelte-4okdns")},m(t,x){w(t,e,x),R&&R.m(e,null),b(e,n),b(e,r),b(r,o),b(o,i),I&&I.m(i,null),b(i,s),lt(a,i,null),b(o,c),B&&B.m(o,null),b(r,l),b(r,u),b(r,f),b(r,p),b(p,h),b(h,d),b(p,m),b(p,v),b(v,g),b(r,y),b(r,k),b(r,_),b(r,C),b(C,O),A=!0},p(t,r){t[0].isMaxed?R||(R=Ml(),R.c(),R.m(e,n)):R&&(R.d(1),R=null),t[0].actionDiceNegated?I||(I=Sl(),I.c(),I.m(i,s)):I&&(I.d(1),I=null);const c={};1&r&&(c.number=t[0].actionDie),a.$set(c),t[0].actionDiceNegated?B?B.p(t,r):(B=Cl(t),B.c(),B.m(o,null)):B&&(B.d(1),B=null),(!A||1&r)&&E!==(E=t[0].stat.value+"")&&N(d,E),(!A||1&r)&&D!==(D=t[0].stat.name+"")&&N(g,D),(!A||1&r)&&z!==(z=t[0].adds+"")&&N(O,z)},i(t){A||(it(a.$$.fragment,t),A=!0)},o(t){st(a.$$.fragment,t),A=!1},d(t){t&&x(e),R&&R.d(),I&&I.d(),ut(a),B&&B.d()}}}function Tl(t){let e,n,r,o,i,s,a,c,l,u,f,p,h,d=t[0].value+"";return p=new _l({props:{anchor:t[2],offsetY:-10,$$slots:{default:[Ol]},$$scope:{ctx:t}}}),{c(){e=$("div"),n=_("svg"),r=_("defs"),o=_("clipPath"),i=_("path"),s=_("g"),a=_("path"),c=_("text"),l=M(d),f=S(),ct(p.$$.fragment),T(i,"d","M31.5 517.64H297v64.82H31.5z"),T(o,"clipPathUnits","userSpaceOnUse"),T(a,"d","M195.9 549.63a11.7 11.7 0 10-23.4 0 11.7 11.7 0 0023.4 0z"),T(a,"stroke","#393536"),T(a,"stroke-width","1.87"),T(a,"stroke-miterlimit","10"),T(s,"transform","matrix(1.33333 0 0 -1.33333 -228.76 749.7)"),T(s,"fill","#fff"),T(c,"x",u=t[0].value>=10?"16":"17"),T(c,"y","24.5"),T(c,"font-size","20"),T(c,"font-family","sans-serif"),T(c,"fill",sl),T(c,"font-weight","bold"),T(c,"text-anchor","middle"),T(c,"textLength","60%"),T(n,"height","100%"),T(n,"viewBox","0 0 33.69 33.69"),T(n,"xmlns","http://www.w3.org/2000/svg"),T(e,"class","wrapper svelte-4okdns")},m(u,d){w(u,e,d),b(e,n),b(n,r),b(r,o),b(o,i),b(n,s),b(s,a),b(n,c),b(c,l),t[3](e),w(u,f,d),lt(p,u,d),h=!0},p(t,[e]){(!h||1&e)&&d!==(d=t[0].value+"")&&N(l,d),(!h||1&e&&u!==(u=t[0].value>=10?"16":"17"))&&T(c,"x",u);const n={};4&e&&(n.anchor=t[2]),19&e&&(n.$$scope={dirty:e,ctx:t}),p.$set(n)},i(t){h||(it(p.$$.fragment,t),h=!0)},o(t){st(p.$$.fragment,t),h=!1},d(n){n&&x(e),t[3](null),n&&x(f),ut(p,n)}}}function Al(t,e,n){let r,{actionScore:o}=e,{momentum:i}=e;return t.$$set=t=>{"actionScore"in t&&n(0,o=t.actionScore),"momentum"in t&&n(1,i=t.momentum)},[o,i,r,function(t){H[t?"unshift":"push"]((()=>{r=t,n(2,r)}))}]}const Nl=class extends pt{constructor(t){super(),ft(this,t,Al,Tl,s,{actionScore:0,momentum:1})}};function El(t){let e;return{c(){e=$("div"),e.innerHTML='<span class="match svelte-lhxz9s">Match!</span> \n      <span class="equals svelte-lhxz9s">=</span>',T(e,"class","matchWrapper svelte-lhxz9s")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Dl(t){let e,n,r,o,i,s,a,c,l,u,f,p,h;r=new Nl({props:{actionScore:t[0].actionScore,momentum:t[0].momentumAtRoll}}),c=new pl({props:{number:t[0].challengeDice[0].value,isHit:t[0].challengeDice[0].isHit}});let d=t[0].isMatch&&El();return p=new pl({props:{number:t[0].challengeDice[1].value,isHit:t[0].challengeDice[1].isHit}}),{c(){e=$("div"),n=$("div"),ct(r.$$.fragment),o=S(),i=$("span"),i.textContent="vs",s=S(),a=$("div"),ct(c.$$.fragment),l=S(),d&&d.c(),u=S(),f=$("div"),ct(p.$$.fragment),T(n,"class","actionScoreWrapper svelte-lhxz9s"),T(i,"class","vs svelte-lhxz9s"),T(a,"class","challengeDiceWrapper svelte-lhxz9s"),T(f,"class","challengeDiceWrapper svelte-lhxz9s"),T(e,"class","wrapper svelte-lhxz9s")},m(t,m){w(t,e,m),b(e,n),lt(r,n,null),b(e,o),b(e,i),b(e,s),b(e,a),lt(c,a,null),b(e,l),d&&d.m(e,null),b(e,u),b(e,f),lt(p,f,null),h=!0},p(t,[n]){const o={};1&n&&(o.actionScore=t[0].actionScore),1&n&&(o.momentum=t[0].momentumAtRoll),r.$set(o);const i={};1&n&&(i.number=t[0].challengeDice[0].value),1&n&&(i.isHit=t[0].challengeDice[0].isHit),c.$set(i),t[0].isMatch?d||(d=El(),d.c(),d.m(e,u)):d&&(d.d(1),d=null);const s={};1&n&&(s.number=t[0].challengeDice[1].value),1&n&&(s.isHit=t[0].challengeDice[1].isHit),p.$set(s)},i(t){h||(it(r.$$.fragment,t),it(c.$$.fragment,t),it(p.$$.fragment,t),h=!0)},o(t){st(r.$$.fragment,t),st(c.$$.fragment,t),st(p.$$.fragment,t),h=!1},d(t){t&&x(e),ut(r),ut(c),d&&d.d(),ut(p)}}}function zl(t,e,n){let{roll:r}=e;return t.$$set=t=>{"roll"in t&&n(0,r=t.roll)},[r]}const Rl=class extends pt{constructor(t){super(),ft(this,t,zl,Dl,s,{roll:0})}};var Il=n(486),Bl=n.n(Il);const Pl=["edge","heart","iron","shadow","wits"],jl=t=>t.modifiers.reduce(((t,e)=>e.apply(t)),t.baseValue),Vl=(t,e)=>(n,r)=>void 0!==t&&r<t?`Minimum ${t}`:void 0!==e&&r>e?`Maximum ${e}`:void 0,Ll={Troublesome:{name:"Troublesome",ticksPerProgress:12},Dangerous:{name:"Dangerous",ticksPerProgress:8},Formidable:{name:"Formidable",ticksPerProgress:4},Extreme:{name:"Extreme",ticksPerProgress:2},Epic:{name:"Epic",ticksPerProgress:1}},Hl=t=>[...Object.values(t.debilities.burdens),...Object.values(t.debilities.conditions),...Object.values(t.debilities.banes)].filter((t=>t)).length,Fl=t=>({id:t.id,name:t.name,experience:t.experience,bonds:t.bonds,stats:{iron:{name:"Iron",baseValue:t.stats.ironBaseValue,modifiers:[],validator:void 0,increaseValidator:void 0,decreaseValidator:void 0},heart:{name:"Heart",baseValue:t.stats.heartBaseValue,modifiers:[],validator:void 0,increaseValidator:void 0,decreaseValidator:void 0},edge:{name:"Edge",baseValue:t.stats.edgeBaseValue,modifiers:[],validator:void 0,increaseValidator:void 0,decreaseValidator:void 0},shadow:{name:"Shadow",baseValue:t.stats.shadowBaseValue,modifiers:[],validator:void 0,increaseValidator:void 0,decreaseValidator:void 0},wits:{name:"Wits",baseValue:t.stats.witsBaseValue,modifiers:[],validator:void 0,increaseValidator:void 0,decreaseValidator:void 0}},statuses:{health:{name:"Health",baseValue:t.statuses.healthBaseValue,modifiers:[],validator:Vl(0,5),increaseValidator:(t,e)=>{if(t.debilities.conditions.wounded)return"Wounded: Cannot increase Health."},decreaseValidator:void 0},spirit:{name:"Spirit",baseValue:t.statuses.spiritBaseValue,modifiers:[],validator:Vl(0,5),increaseValidator:(t,e)=>{if(t.debilities.conditions.shaken)return"Shaken: Cannot increase Spirit."},decreaseValidator:void 0},supply:{name:"Supply",baseValue:t.statuses.supplyBaseValue,modifiers:[],validator:Vl(0,5),increaseValidator:(t,e)=>{if(t.debilities.conditions.unprepared)return"Unprepared: Cannot increase Supply."},decreaseValidator:void 0}},momentum:{current:{name:"Momentum",baseValue:t.momentum.currentBaseValue,validator:(t,e)=>Vl(jl(t.momentum.min),jl(t.momentum.max))(t,e),modifiers:[]},max:{name:"Max Momentum",baseValue:t.momentum.maxBaseValue,validator:Vl(-6,10),modifiers:[]},min:{name:"Min Momentum",baseValue:t.momentum.minBaseValue,modifiers:[]},reset:{name:"Momentum Reset",baseValue:t.momentum.resetBaseValue,validator:Vl(-6,10),modifiers:[]}},vows:t.vows,debilities:t.debilities}),Wl=Fl({id:"mock",name:"Kuno",experience:2,stats:{edgeBaseValue:3,heartBaseValue:2,ironBaseValue:2,shadowBaseValue:1,witsBaseValue:1},statuses:{supplyBaseValue:3,spiritBaseValue:5,healthBaseValue:4},bonds:{ticks:9,rank:Ll.Epic,name:"Bonds"},vows:[{name:"Avenge my brother",ticks:2,rank:Ll.Epic},{name:"Find a new home for the refugees",ticks:16,rank:Ll.Dangerous}],debilities:{banes:{corrupted:!1,maimed:!1},burdens:{cursed:!1,tormented:!1},conditions:{encumbered:!1,shaken:!1,unprepared:!1,wounded:!1}},momentum:{resetBaseValue:10,minBaseValue:-6,maxBaseValue:10,currentBaseValue:10}}),ql=({getModifier:t,check:e,getStat:n})=>r=>{const o=n(r),i=t(r),s=o.modifiers.some((t=>t.id===i.id)),a=e(r);return s&&!a?(o.modifiers=o.modifiers.filter((t=>t.id!==i.id)),!0):!(s||!a||(o.modifiers.push(i),0))},Jl=[ql({getModifier:t=>({id:"debilities_max_momentum",getDescription:()=>`Debilities: -${Hl(t)} Max Momentum`,apply:e=>e-Hl(t)}),getStat:t=>t.momentum.max,check:t=>Hl(t)>0}),ql({getModifier:t=>({id:"debilities_1_momentum_reset",getDescription:()=>"Debilities: -1 Momentum Reset",apply:t=>t-1}),getStat:t=>t.momentum.reset,check:t=>1===Hl(t)}),ql({getModifier:t=>({id:"debilities_2+_momentum_reset",getDescription:()=>"Debilities: -2 Momentum Reset",apply:t=>t-2}),getStat:t=>t.momentum.reset,check:t=>Hl(t)>=2}),ql({getModifier:t=>({id:"wounded_health_increase",getDescription:()=>"Wounded: Cannot increase Health",apply:t=>t}),getStat:t=>t.statuses.health,check:t=>t.debilities.conditions.wounded}),ql({getModifier:t=>({id:"shaken_spirit_increase",getDescription:()=>"Shaken: Cannot increase Spirit",apply:t=>t}),getStat:t=>t.statuses.spirit,check:t=>t.debilities.conditions.shaken}),ql({getModifier:t=>({id:"unprepared_supply_increase",getDescription:()=>"Unprepared: Cannot increase Supply",apply:t=>t}),getStat:t=>t.statuses.supply,check:t=>t.debilities.conditions.unprepared})];let Kl={[Wl.id]:(t=>{let e=il(t);return e.subscribe((t=>{let n=!1;for(const e of Jl)n=n||e(t);n&&e.set(t)})),e})(Wl)};const Ul=t=>Kl[t];function Yl(t){let e,n,r,o,s,a;return n=new Mu({props:{roll:t[0].props.roll,updateRoll:t[4],character:t[3],updateCharacter:t[5],canBurnMomentum:t[0].id===t[2]?.id}}),{c(){e=$("div"),ct(n.$$.fragment)},m(i,c){w(i,e,c),lt(n,e,null),o=!0,s||(a=m(r=Du.call(null,e,{props:t[0].props,type:Ou.ActionRollCard})),s=!0)},p(t,[e]){const o={};1&e&&(o.roll=t[0].props.roll),8&e&&(o.character=t[3]),5&e&&(o.canBurnMomentum=t[0].id===t[2]?.id),n.$set(o),r&&i(r.update)&&1&e&&r.update.call(null,{props:t[0].props,type:Ou.ActionRollCard})},i(t){o||(it(n.$$.fragment,t),o=!0)},o(t){st(n.$$.fragment,t),o=!1},d(t){t&&x(e),ut(n),s=!1,a()}}}function Gl(e,n,r){let o,i,s=t;u(e,eu,(t=>r(6,o=t))),e.$$.on_destroy.push((()=>s()));let a,l,{logItem:f}=n;return e.$$set=t=>{"logItem"in t&&r(0,f=t.logItem)},e.$$.update=()=>{64&e.$$.dirty&&r(2,l=[...o].reverse().find((t=>t.type===Ou.ActionRollCard))),1&e.$$.dirty&&(r(1,a=Ul(f.props.characterId)),s(),s=c(a,(t=>r(3,i=t))))},[f,a,l,i,t=>{eu.replaceItem(f.id,Object.assign(Object.assign({},f),{props:Object.assign(Object.assign({},f.props),{roll:t})}))},t=>{Ul(t.id).set(t)},o]}const Zl=class extends pt{constructor(t){super(),ft(this,t,Gl,Yl,s,{logItem:0})}};let Xl=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let r=63&n[t];e+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return e};var Ql;!function(t){t[t.ActionRoll=0]="ActionRoll"}(Ql||(Ql={}));const tu=il([]),eu=Object.assign(Object.assign({},tu),{addItem:t=>{tu.update((e=>[...e,t]))},replaceItem:(t,e)=>{tu.update((n=>{const r=n.findIndex((e=>e.id===t));return-1===r?n:[...n.slice(0,r),e,...n.slice(r+1)]}))}}),nu=t=>{switch(t){case Ql.ActionRoll:return Zl;default:throw new Error(`Invalid LogItemType "${t}".`)}};var ru;!function(t){t.StrongHit="Strong Hit",t.WeakHit="Weak Hit",t.Miss="Miss"}(ru||(ru={}));const ou=()=>Bl().random(1,10),iu=(t,e)=>t&&e?ru.StrongHit:t||e?ru.WeakHit:ru.Miss,su=(t,e,n,r)=>{const o=((t,e,n,r)=>{const o=ou(),i=ou(),s=Bl().random(1,6),a=jl(n.momentum.current),c=a===-s,l=(c?0:s)+jl(t)+e,u=Math.min(l,10),f=u>o,p=u>i,h=iu(f,p),d=o===i,m=l>u;return{move:r,stat:{value:jl(t),name:t.name},actionScore:{actionDiceNegated:c,value:u,actionDie:s,stat:{value:jl(t),name:t.name},adds:e,isMaxed:m},momentumAtRoll:a,momentumBurned:!1,result:h,isMatch:d,challengeDice:[{value:o,isHit:f},{value:i,isHit:p}]}})(t.stats[e],n,t,r),i=(s=Ql.ActionRoll,a={roll:o,characterId:t.id},{id:Xl(),type:s,dateCreated:new Date,props:a});var s,a;return eu.addItem(i),i},au=t=>t.charAt(0).toUpperCase()+t.slice(1),cu=(t,e=!0)=>!e||t<=0?String(t):`+${t}`,lu=t=>t.toLowerCase().endsWith("s")?t+"'":t+"'s";function uu(e){let n,r,o;return{c(){n=$("button"),n.textContent="Burn momentum",T(n,"class","burnMomentum svelte-1uz00ih")},m(t,i){w(t,n,i),e[9](n),r||(o=O(n,"click",e[5]),r=!0)},p:t,d(t){t&&x(n),e[9](null),r=!1,o()}}}function fu(t){let e,n,r,o,i,s=t[0].momentumAtRoll+"";return{c(){e=$("span"),n=$("i"),r=M("("),o=M(s),i=M(" Momentum burned)"),T(e,"class","svelte-1uz00ih")},m(t,s){w(t,e,s),b(e,n),b(n,r),b(n,o),b(n,i)},p(t,e){1&e&&s!==(s=t[0].momentumAtRoll+"")&&N(o,s)},d(t){t&&x(e)}}}function pu(t){let e,n,r,o,i,s,a=cu(t[0].momentumAtRoll)+"";return{c(){e=$("span"),n=M("Burn momentum ("),r=M(a),o=M(") for a "),i=M(t[3]),s=M(".")},m(t,a){w(t,e,a),b(e,n),b(e,r),b(e,o),b(e,i),b(e,s)},p(t,e){1&e&&a!==(a=cu(t[0].momentumAtRoll)+"")&&N(r,a),8&e&&N(i,t[3])},d(t){t&&x(e)}}}function hu(t){let e,n,r,o,i,s,a,c,l,u,f,p=t[0].result+"";e=new Rl({props:{roll:t[0]}});let h=t[4]&&t[1]&&!t[0].momentumBurned&&uu(t),d=t[0].momentumBurned&&fu(t);return u=new _l({props:{anchor:t[2],offsetY:-10,$$slots:{default:[pu]},$$scope:{ctx:t}}}),{c(){ct(e.$$.fragment),n=S(),r=$("div"),o=$("span"),i=M(p),s=S(),a=$("div"),h&&h.c(),c=S(),d&&d.c(),l=S(),ct(u.$$.fragment),T(o,"class","result svelte-1uz00ih"),T(a,"class","momentumWrapper svelte-1uz00ih"),T(r,"class","resultWrapper svelte-1uz00ih")},m(t,p){lt(e,t,p),w(t,n,p),w(t,r,p),b(r,o),b(o,i),b(r,s),b(r,a),h&&h.m(a,null),b(a,c),d&&d.m(a,null),w(t,l,p),lt(u,t,p),f=!0},p(t,[n]){const r={};1&n&&(r.roll=t[0]),e.$set(r),(!f||1&n)&&p!==(p=t[0].result+"")&&N(i,p),t[4]&&t[1]&&!t[0].momentumBurned?h?h.p(t,n):(h=uu(t),h.c(),h.m(a,c)):h&&(h.d(1),h=null),t[0].momentumBurned?d?d.p(t,n):(d=fu(t),d.c(),d.m(a,null)):d&&(d.d(1),d=null);const o={};4&n&&(o.anchor=t[2]),1033&n&&(o.$$scope={dirty:n,ctx:t}),u.$set(o)},i(t){f||(it(e.$$.fragment,t),it(u.$$.fragment,t),f=!0)},o(t){st(e.$$.fragment,t),st(u.$$.fragment,t),f=!1},d(t){ut(e,t),t&&x(n),t&&x(r),h&&h.d(),d&&d.d(),t&&x(l),ut(u,t)}}}function du(t,e,n){let r,o,i,{roll:s}=e,{character:a}=e,{updateRoll:c}=e,{updateCharacter:l}=e,{canBurnMomentum:u}=e;return t.$$set=t=>{"roll"in t&&n(0,s=t.roll),"character"in t&&n(6,a=t.character),"updateRoll"in t&&n(7,c=t.updateRoll),"updateCharacter"in t&&n(8,l=t.updateCharacter),"canBurnMomentum"in t&&n(1,u=t.canBurnMomentum)},t.$$.update=()=>{if(1&t.$$.dirty){const t=(t=>{let e;const n=t.momentumAtRoll>t.challengeDice[0].value,r=t.momentumAtRoll>t.challengeDice[1].value;return e=n&&r?ru.StrongHit:n||r?ru.WeakHit:ru.Miss,{resultIfBurnMomentum:e,canUpgradeResult:t.result===ru.Miss&&e!==ru.Miss||t.result===ru.WeakHit&&e===ru.StrongHit}})(s);n(3,o=t.resultIfBurnMomentum),n(4,i=t.canUpgradeResult)}},[s,u,r,o,i,()=>{const{newRoll:t,newCharacter:e}=((t,e)=>{let n=Bl().cloneDeep(t);n.momentumBurned=!0,n.challengeDice=[{value:n.challengeDice[0].value,isHit:n.challengeDice[0].isHit||n.momentumAtRoll>n.challengeDice[0].value},{value:n.challengeDice[1].value,isHit:n.challengeDice[1].isHit||n.momentumAtRoll>n.challengeDice[1].value}],n.result=iu(n.challengeDice[0].isHit,n.challengeDice[1].isHit);const r=Bl().cloneDeep(e);return r.momentum.current.baseValue=jl(r.momentum.reset),{newRoll:n,newCharacter:r}})(s,a);l(e),c(t)},a,c,l,function(t){H[t?"unshift":"push"]((()=>{r=t,n(2,r)}))}]}const mu=class extends pt{constructor(t){super(),ft(this,t,du,hu,s,{roll:0,character:6,updateRoll:7,updateCharacter:8,canBurnMomentum:1})}};function vu(t){let e,n;const r=t[2].default,o=f(r,t,t[1],null);return{c(){e=$("div"),o&&o.c(),T(e,"class","separator svelte-m80xy1"),R(e,"vertical",t[0])},m(t,r){w(t,e,r),o&&o.m(e,null),n=!0},p(t,[i]){o&&o.p&&(!n||2&i)&&h(o,r,t,t[1],n?i:-1,null,null),1&i&&R(e,"vertical",t[0])},i(t){n||(it(o,t),n=!0)},o(t){st(o,t),n=!1},d(t){t&&x(e),o&&o.d(t)}}}function gu(t,e,n){let{$$slots:r={},$$scope:o}=e,{vertical:i=!1}=e;return t.$$set=t=>{"vertical"in t&&n(0,i=t.vertical),"$$scope"in t&&n(1,o=t.$$scope)},[i,o,r]}const yu=class extends pt{constructor(t){super(),ft(this,t,gu,vu,s,{vertical:0})}};function bu(t){let e,n,r,o,i,s=t[0].move+"";return{c(){e=$("i"),n=M(s),r=M("\n        ("),o=M(t[5]),i=M(")")},m(t,s){w(t,e,s),b(e,n),w(t,r,s),w(t,o,s),w(t,i,s)},p(t,e){1&e&&s!==(s=t[0].move+"")&&N(n,s),32&e&&N(o,t[5])},d(t){t&&x(e),t&&x(r),t&&x(o),t&&x(i)}}}function wu(t){let e;return{c(){e=M(t[5])},m(t,n){w(t,e,n)},p(t,n){32&n&&N(e,t[5])},d(t){t&&x(e)}}}function xu(t){let e,n,r,o,i,s,a,c=t[0].resultText+"";return r=new yu({props:{$$slots:{default:[ku]},$$scope:{ctx:t}}}),{c(){e=$("div"),n=$("div"),ct(r.$$.fragment),o=S(),i=$("span"),s=M(c),T(n,"class","dividerWrapper svelte-1plkt6n"),T(e,"class","result svelte-1plkt6n")},m(t,c){w(t,e,c),b(e,n),lt(r,n,null),b(e,o),b(e,i),b(i,s),a=!0},p(t,e){const n={};64&e&&(n.$$scope={dirty:e,ctx:t}),r.$set(n),(!a||1&e)&&c!==(c=t[0].resultText+"")&&N(s,c)},i(t){a||(it(r.$$.fragment,t),a=!0)},o(t){st(r.$$.fragment,t),a=!1},d(t){t&&x(e),ut(r)}}}function ku(t){let e;return{c(){e=M("Result")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function $u(t){let e,n,r,o,i,s,a,c,l,u,f,p=t[1].name+"",h=void 0!==t[0].move&&bu(t),d=void 0===t[0].move&&wu(t);l=new mu({props:{roll:t[0],character:t[1],updateRoll:t[2],updateCharacter:t[3],canBurnMomentum:t[4]}});let m=void 0!==t[0].resultText&&xu(t);return{c(){e=$("div"),n=$("div"),r=$("span"),o=M(p),i=M("\n      rolls\n      "),h&&h.c(),s=S(),d&&d.c(),a=S(),c=$("div"),ct(l.$$.fragment),u=S(),m&&m.c(),T(r,"class","name svelte-1plkt6n"),T(n,"class","header svelte-1plkt6n"),T(c,"class","content svelte-1plkt6n"),T(e,"class","actionRollCard svelte-1plkt6n")},m(t,p){w(t,e,p),b(e,n),b(n,r),b(r,o),b(r,i),h&&h.m(r,null),b(r,s),d&&d.m(r,null),b(e,a),b(e,c),lt(l,c,null),b(e,u),m&&m.m(e,null),f=!0},p(t,[n]){(!f||2&n)&&p!==(p=t[1].name+"")&&N(o,p),void 0!==t[0].move?h?h.p(t,n):(h=bu(t),h.c(),h.m(r,s)):h&&(h.d(1),h=null),void 0===t[0].move?d?d.p(t,n):(d=wu(t),d.c(),d.m(r,null)):d&&(d.d(1),d=null);const i={};1&n&&(i.roll=t[0]),2&n&&(i.character=t[1]),4&n&&(i.updateRoll=t[2]),8&n&&(i.updateCharacter=t[3]),16&n&&(i.canBurnMomentum=t[4]),l.$set(i),void 0!==t[0].resultText?m?(m.p(t,n),1&n&&it(m,1)):(m=xu(t),m.c(),it(m,1),m.m(e,null)):m&&(rt(),st(m,1,1,(()=>{m=null})),ot())},i(t){f||(it(l.$$.fragment,t),it(m),f=!0)},o(t){st(l.$$.fragment,t),st(m),f=!1},d(t){t&&x(e),h&&h.d(),d&&d.d(),ut(l),m&&m.d()}}}function _u(t,e,n){let r,{roll:o}=e,{character:i}=e,{updateRoll:s}=e,{updateCharacter:a}=e,{canBurnMomentum:c=!1}=e;return t.$$set=t=>{"roll"in t&&n(0,o=t.roll),"character"in t&&n(1,i=t.character),"updateRoll"in t&&n(2,s=t.updateRoll),"updateCharacter"in t&&n(3,a=t.updateCharacter),"canBurnMomentum"in t&&n(4,c=t.canBurnMomentum)},t.$$.update=()=>{1&t.$$.dirty&&n(5,r=`+${o.stat.name.toLowerCase()}`)},[o,i,s,a,c,r]}const Mu=class extends pt{constructor(t){super(),ft(this,t,_u,$u,s,{roll:0,character:1,updateRoll:2,updateCharacter:3,canBurnMomentum:4})}};function Su(t){let e,n;return e=new Mu({props:{roll:t[0],character:t[2]}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,[n]){const r={};1&n&&(r.roll=t[0]),4&n&&(r.character=t[2]),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Cu(e,n,r){let o,i=t;e.$$.on_destroy.push((()=>i()));let s,{roll:a}=n,{characterId:l}=n;return e.$$set=t=>{"roll"in t&&r(0,a=t.roll),"characterId"in t&&r(3,l=t.characterId)},e.$$.update=()=>{8&e.$$.dirty&&(r(1,s=Ul(l)),i(),i=c(s,(t=>r(2,o=t))))},[a,s,o,l]}var Ou;!function(t){t[t.ActionRollCard=0]="ActionRollCard"}(Ou||(Ou={}));const Tu=il(void 0),Au={[Ou.ActionRollCard]:"action-roll-card"},Nu={[Ou.ActionRollCard]:class extends pt{constructor(t){super(),ft(this,t,Cu,Su,s,{roll:0,characterId:3})}}},Eu=t=>Au[t],Du=(t,{type:e,props:n})=>{const r=()=>{Tu.set({type:e,props:n})},o=()=>{Tu.set(void 0)};return t.style.userSelect="none",t.setAttribute("draggable","true"),t.addEventListener("dragstart",r),t.addEventListener("dragend",o),{destroy(){t.style.userSelect=void 0,t.setAttribute("draggable","false"),t.removeEventListener("dragstart",r),t.removeEventListener("dragend",o)},update({type:t,props:r}){e=t,n=r}}},zu=Bs.create({addProseMirrorPlugins(){return[new Dn({props:{handleDOMEvents:{drop:(t,e)=>{if(void 0===l(Tu))return!1;const{type:n,props:r}=l(Tu),o=Eu(n),i=((t,e)=>{switch(t){case Ou.ActionRollCard:return JSON.stringify({roll:e.roll,characterId:e.characterId});default:throw new Error(`Invalid DraggableElementType "${t}".`)}})(n,r),s=this.editor.view.posAtCoords({left:e.clientX,top:e.clientY}).pos;return this.editor.chain().focus().insertContentAt(s,`<${o} jsonProps='${i}' />`).run(),!0}}}})]}}),Ru=t=>{const e=(t=>Nu[t])(t),n=Eu(t);return Ya.create({name:e.name,group:"inline",inline:!0,draggable:!0,addAttributes:()=>({jsonProps:{}}),parseHTML:()=>[{tag:n}],renderHTML:({HTMLAttributes:t})=>[n,Os(t)],addNodeView:()=>({node:n})=>{const r=document.createElement("span");r.style.display="inline-flex",r.style.verticalAlign="bottom";const o=((t,e)=>{switch(t){case Ou.ActionRollCard:const n=JSON.parse(e);return{roll:n.roll,characterId:n.characterId};default:throw new Error(`Invalid DraggableElementType "${t}".`)}})(t,n.attrs.jsonProps),i=new e({target:r,props:o});return{dom:r,destroy:()=>{i.$destroy()}}}})};function Iu(t){let e,n,r,i,s,a,c,l,u,f,p;return{c(){e=$("button"),e.textContent="H1",n=S(),r=$("button"),r.textContent="H2",i=S(),s=$("button"),s.textContent="H3",a=S(),c=$("button"),c.textContent="H4",l=S(),u=$("button"),u.textContent="P",T(e,"class","svelte-1gez4ow"),R(e,"active",t[1].isActive("heading",{level:1})),T(r,"class","svelte-1gez4ow"),R(r,"active",t[1].isActive("heading",{level:2})),T(s,"class","svelte-1gez4ow"),R(s,"active",t[1].isActive("heading",{level:3})),T(c,"class","svelte-1gez4ow"),R(c,"active",t[1].isActive("heading",{level:4})),T(u,"class","svelte-1gez4ow"),R(u,"active",t[1].isActive("paragraph"))},m(o,h){w(o,e,h),w(o,n,h),w(o,r,h),w(o,i,h),w(o,s,h),w(o,a,h),w(o,c,h),w(o,l,h),w(o,u,h),f||(p=[O(e,"click",t[2].h1),O(r,"click",t[2].h2),O(s,"click",t[2].h3),O(c,"click",t[2].h4),O(u,"click",t[2].paragraph)],f=!0)},p(t,n){2&n&&R(e,"active",t[1].isActive("heading",{level:1})),2&n&&R(r,"active",t[1].isActive("heading",{level:2})),2&n&&R(s,"active",t[1].isActive("heading",{level:3})),2&n&&R(c,"active",t[1].isActive("heading",{level:4})),2&n&&R(u,"active",t[1].isActive("paragraph"))},d(t){t&&x(e),t&&x(n),t&&x(r),t&&x(i),t&&x(s),t&&x(a),t&&x(c),t&&x(l),t&&x(u),f=!1,o(p)}}}function Bu(e){let n,r,o,i,s=void 0!==e[1]&&Iu(e);return{c(){n=$("div"),r=$("div"),s&&s.c(),o=S(),i=$("div"),T(r,"id","menu"),T(r,"class","svelte-1gez4ow"),T(i,"id","document"),T(i,"class","svelte-1gez4ow"),T(n,"id","editor"),T(n,"class","svelte-1gez4ow")},m(t,a){w(t,n,a),b(n,r),s&&s.m(r,null),b(n,o),b(n,i),e[3](i)},p(t,[e]){void 0!==t[1]?s?s.p(t,e):(s=Iu(t),s.c(),s.m(r,null)):s&&(s.d(1),s=null)},i:t,o:t,d(t){t&&x(n),s&&s.d(),e[3](null)}}}function Pu(t,e,n){let r,o;P((()=>{n(1,o=new Ua({element:r,extensions:[rl,Ru(Ou.ActionRollCard),zu],content:localStorage.getItem("document")||"",autofocus:!0,onTransaction:()=>{n(1,o)},onUpdate:()=>{const t=o.getHTML();localStorage.setItem("document",t)}}));const t=document.createElement("div");t.className="spacer",r.appendChild(t)})),j((()=>{o&&o.destroy()}));const i={paragraph:()=>o.chain().focus().setParagraph().run(),h1:()=>o.chain().focus().toggleHeading({level:1}).run(),h2:()=>o.chain().focus().toggleHeading({level:2}).run(),h3:()=>o.chain().focus().toggleHeading({level:3}).run(),h4:()=>o.chain().focus().toggleHeading({level:4}).run()};return[r,o,i,function(t){H[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}const ju=class extends pt{constructor(t){super(),ft(this,t,Pu,Bu,s,{})}};function Vu(t,e=!1){return(t=t.slice(t.startsWith("/#")?2:0,t.endsWith("/*")?-2:void 0)).startsWith("/")||(t="/"+t),"/"===t&&(t=""),e&&!t.endsWith("/")&&(t+="/"),t}function Lu(t,e){t=Vu(t,!0),e=Vu(e,!0);let n=[],r={},o=!0,i=t.split("/").map((t=>t.startsWith(":")?(n.push(t.slice(1)),"([^\\/]+)"):t)).join("\\/"),s=e.match(new RegExp(`^${i}$`));return s||(o=!1,s=e.match(new RegExp(`^${i}`))),s?(n.forEach(((t,e)=>r[t]=s[e+1])),{exact:o,params:r,part:s[0].slice(0,-1)}):null}function Hu(t,e,n){if(""===n)return t;if("/"===n[0])return n;let r=t=>t.split("/").filter((t=>""!==t)),o=r(t);return"/"+(e?r(e):[]).map(((t,e)=>o[e])).join("/")+"/"+n}function Fu(t,e,n,r){let o=[e,"data-"+e].reduce(((e,r)=>{let o=t.getAttribute(r);return n&&t.removeAttribute(r),null===o?e:o}),!1);return!r&&""===o||o||r||!1}function Wu(t){let e=t.split("&").map((t=>t.split("="))).reduce(((t,e)=>{let n=e[0];if(!n)return t;let r=!(e.length>1)||e[e.length-1];return"string"==typeof r&&r.includes(",")&&(r=r.split(",")),void 0===t[n]?t[n]=[r]:t[n].push(r),t}),{});return Object.entries(e).reduce(((t,e)=>(t[e[0]]=e[1].length>1?e[1]:e[1][0],t)),{})}function qu(t,e){return t?e+t:""}function Ju(t){throw new Error("[Tinro] "+t)}var Ku,Uu,Yu,Gu={HISTORY:1,HASH:2,MEMORY:3,OFF:4,run(t,e,n,r){return t===this.HISTORY?e&&e():t===this.HASH?n&&n():r&&r()},getDefault(){return window&&"srcdoc"!==window.location.pathname?this.HISTORY:this.MEMORY}},Zu=function(){let t,e=Gu.getDefault(),n=n=>t&&t(Xu(e)),r=t=>{t&&(e=t),window.onhashchange=window.onpopstate=Ku=null,e!==Gu.OFF&&Gu.run(e,(t=>window.onpopstate=n),(t=>window.onhashchange=n))&&n()};return{mode:r,get:t=>Xu(e),go(t,r){(function(t,e,n){!n&&(Uu=Yu);let r=t=>history[(n?"replace":"push")+"State"]({},"",t);Gu.run(t,(t=>r(e)),(t=>r(`#${e}`)),(t=>Ku=e))})(e,t,r),n()},start(e){t=e,r()},stop(){t=null,r(Gu.OFF)},set(t){this.go((t=>{let n=Object.assign(Xu(e),t);return n.path+qu(function(t){return Object.entries(t).map((([t,e])=>e?!0===e?t:`${t}=${Array.isArray(e)?e.join(","):e}`:null)).filter((t=>t)).join("&")}(n.query),"?")+qu(n.hash,"#")})(t),!t.path)},methods(){return function(t){let e=()=>t.get().query,n=e=>t.set({query:e}),r=t=>n(t(e())),o=e=>t.set({hash:e});return{hash:{get:()=>t.get().hash,set:o,clear:()=>o("")},query:{replace:n,clear:()=>n(""),get:t=>t?e()[t]:e(),set(t,e){r((n=>(n[t]=e,n)))},delete(t){r((e=>(e[t]&&delete e[t],e)))}}}}(this)}}}();function Xu(t){let e=window.location,n=Gu.run(t,(t=>e.pathname+e.search+e.hash),(t=>String(e.hash.slice(1)||"/")),(t=>Ku||"/")),r=n.match(/^([^?#]+)(?:\?([^#]+))?(?:\#(.+))?$/);return Yu=n,{url:n,from:Uu,path:r[1]||"",query:Wu(r[2]||""),hash:r[3]||""}}var Qu=function(){let{subscribe:t}=il(Zu.get(),(t=>{Zu.start(t);let e=function(t){let e=e=>{let n=e.target.closest("a[href]"),r=n&&Fu(n,"target",!1,"_self"),o=n&&Fu(n,"tinro-ignore"),i=e.ctrlKey||e.metaKey||e.altKey||e.shiftKey;if("_self"==r&&!o&&!i&&n){let r=n.getAttribute("href").replace(/^\/#/,"");/^\/\/|^[a-zA-Z]+:/.test(r)||(e.preventDefault(),t(r.startsWith("/")?r:n.href.replace(window.location.origin,"")))}};return addEventListener("click",e),()=>removeEventListener("click",e)}(Zu.go);return()=>{Zu.stop(),e()}}));return{subscribe:t,goto:Zu.go,params:ef,meta:of,useHashNavigation:t=>Zu.mode(t?Gu.HASH:Gu.HISTORY),mode:{hash:()=>Zu.mode(Gu.HASH),history:()=>Zu.mode(Gu.HISTORY),memory:()=>Zu.mode(Gu.MEMORY)},location:Zu.methods()}}();function tf(t){let e=Fu(t,"href"),n=Fu(t,"exact",!0),r=Fu(t,"active-class",!0,"active");return{destroy:Qu.subscribe((o=>{let i=Lu(e,o.path);i&&(i.exact&&n||!n)?t.classList.add(r):t.classList.remove(r)}))}}function ef(){return V("tinro").meta.params}var nf="tinro",rf=sf({pattern:"",matched:!0});function of(){return B().$$.context.has("tinro")?V(nf).meta:Ju("meta() function must be run inside any `<Route>` child component only")}function sf(t){let e={router:{},exact:!1,pattern:null,meta:null,parent:null,fallback:!1,redirect:!1,firstmatch:!1,breadcrumb:null,matched:!1,childs:new Set,activeChilds:new Set,fallbacks:new Set,async showFallbacks(){if(!this.fallback&&(await U(),this.childs.size>0&&0==this.activeChilds.size||0==this.childs.size&&this.fallbacks.size>0)){let t=this;for(;0==t.fallbacks.size;)if(t=t.parent,!t)return;t&&t.fallbacks.forEach((t=>{if(t.redirect){let e=Hu("/",t.parent.pattern,t.redirect);Qu.goto(e,!0)}else t.show()}))}},start(){this.router.un||(this.router.un=Qu.subscribe((t=>{this.router.location=t,null!==this.pattern&&this.match()})))},match(){this.showFallbacks()}};return Object.assign(e,t),e.start(),e}const af=t=>({params:2&t,meta:4&t}),cf=t=>({params:t[1],meta:t[2]});function lf(t){let e;const n=t[9].default,r=f(n,t,t[8],cf);return{c(){r&&r.c()},m(t,n){r&&r.m(t,n),e=!0},p(t,o){r&&r.p&&(!e||262&o)&&h(r,n,t,t[8],e?o:-1,af,cf)},i(t){e||(it(r,t),e=!0)},o(t){st(r,t),e=!1},d(t){r&&r.d(t)}}}function uf(t){let e,n,r=t[0]&&lf(t);return{c(){r&&r.c(),e=C()},m(t,o){r&&r.m(t,o),w(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&it(r,1)):(r=lf(t),r.c(),it(r,1),r.m(e.parentNode,e)):r&&(rt(),st(r,1,1,(()=>{r=null})),ot())},i(t){n||(it(r),n=!0)},o(t){st(r),n=!1},d(t){r&&r.d(t),t&&x(e)}}}function ff(t,e,n){let{$$slots:r={},$$scope:o}=e,{path:i="/*"}=e,{fallback:s=!1}=e,{redirect:a=!1}=e,{firstmatch:c=!1}=e,{breadcrumb:l=null}=e,u=!1,f={},p={};const h=function(t){let e=V(nf)||rf;(e.exact||e.fallback)&&Ju(`${t.fallback?"<Route fallback>":`<Route path="${t.path}">`}  can't be inside ${e.fallback?"<Route fallback>":`<Route path="${e.path||"/"}"> with exact path`}`);let n=t.fallback?"fallbacks":"childs",r=il({}),o=sf({fallback:t.fallback,parent:e,update(t){o.exact=!t.path.endsWith("/*"),o.pattern=Vu(`${o.parent.pattern||""}${t.path}`),o.redirect=t.redirect,o.firstmatch=t.firstmatch,o.breadcrumb=t.breadcrumb,o.match()},register:()=>(o.parent[n].add(o),()=>{o.parent[n].delete(o),o.router.un&&o.router.un()}),show:()=>{t.onShow(),!o.fallback&&o.parent.activeChilds.add(o)},hide:()=>{t.onHide(),!o.fallback&&o.parent.activeChilds.delete(o)},match:async()=>{o.matched=!1;let{path:e,url:n,from:i,query:s}=o.router.location,a=Lu(o.pattern,e);if(!o.fallback&&a&&o.redirect&&(!o.exact||o.exact&&a.exact)){let t=Hu(e,o.parent.pattern,o.redirect);return Qu.goto(t,!0)}o.meta=a&&{from:i,url:n,query:s,match:a.part,pattern:o.pattern,breadcrumbs:o.parent.meta&&o.parent.meta.breadcrumbs.slice()||[],params:a.params,subscribe:r.subscribe},o.breadcrumb&&o.meta&&o.meta.breadcrumbs.push({name:o.breadcrumb,path:a.part}),r.set(o.meta),!a||o.fallback||!(!o.exact||o.exact&&a.exact)||o.parent.firstmatch&&o.parent.matched?o.hide():(t.onMeta(o.meta),o.parent.matched=!0,o.show()),a&&o.showFallbacks()}});return i=o,B().$$.context.set("tinro",i),P((()=>o.register())),o;var i}({fallback:s,onShow(){n(0,u=!0)},onHide(){n(0,u=!1)},onMeta(t){n(2,p=t),n(1,f=p.params)}});return t.$$set=t=>{"path"in t&&n(3,i=t.path),"fallback"in t&&n(4,s=t.fallback),"redirect"in t&&n(5,a=t.redirect),"firstmatch"in t&&n(6,c=t.firstmatch),"breadcrumb"in t&&n(7,l=t.breadcrumb),"$$scope"in t&&n(8,o=t.$$scope)},t.$$.update=()=>{232&t.$$.dirty&&h.update({path:i,redirect:a,firstmatch:c,breadcrumb:l})},[u,f,p,i,s,a,c,l,o,r]}const pf=class extends pt{constructor(t){super(),ft(this,t,ff,uf,s,{path:3,fallback:4,redirect:5,firstmatch:6,breadcrumb:7})}};var hf={prefix:"fas",iconName:"crystal-ball",icon:[448,512,[],"e362","M376 416H71.35l-32.94 43.78c-4.426 6.199-6.424 13.05-6.424 19.68C31.99 496.4 45.07 512 64.04 512h320c18.96 0 32.05-15.61 32.05-32.22c0-6.49-1.998-13.16-6.424-19.09L376 416zM380.1 384C421.8 343.4 448 286.9 448 224.9c0-123.8-100.3-223.1-224-223.1S0 100.2 0 224c0 62.88 26.12 119.4 67.88 159.1L380.1 384zM227.7 202.9l49.41-20.62l.4062-.375l20.59-49.31C299.1 130.5 301.7 128.9 304 128.9c2.281 0 4.969 1.625 5.969 3.688l20.72 49.63l49.63 20.69C382.3 203.9 384 206.6 384 207.9c0 3.125-1.656 5.812-3.688 6l-49.63 20.75l-20.72 49.63C308.1 286.3 306.3 288 304 288c-2.312-.0625-4.906-.8125-5.906-2.812L277.4 235.5l-49.63-20.69c-2-1-3.656-3.688-3.656-5.938C224.1 206.7 225.7 203.9 227.7 202.9zM115.1 125.3l29.78-12.44l12.41-29.81c.5938-1.188 1.281-2.188 3.594-2.188c2.281 0 2.094 1 2.688 2.188l12.44 29.81l29.78 12.38C207 125.9 208 127.5 208 128.9c0 1.312-1 2.938-2.188 3.562l-28.91 11.5L164.5 173.8C163 175.9 161.4 176.9 160.9 176.9s-2.969-1-3.594-2.25L144.9 144.8L115.1 132.4C113.9 131.8 112.9 130.3 112.9 128.9S113.9 125.9 115.1 125.3z"]},df={prefix:"fas",iconName:"dice-d6",icon:[448,512,[],"f6d1","M7.994 153.5c1.326 0 2.687 .3508 3.975 1.119L208 271.5v223.8c0 9.741-7.656 16.71-16.01 16.71c-2.688 0-5.449-.7212-8.05-2.303l-152.2-92.47C12.13 405.3 0 383.3 0 359.5v-197.7C0 156.1 3.817 153.5 7.994 153.5zM426.2 117.2c0 2.825-1.352 5.647-4.051 7.248L224 242.6L25.88 124.4C23.19 122.8 21.85 119.1 21.85 117.2c0-2.8 1.32-5.603 3.965-7.221l165.1-100.9C201.7 3.023 212.9 0 224 0s22.27 3.023 32.22 9.07l165.1 100.9C424.8 111.6 426.2 114.4 426.2 117.2zM440 153.5C444.2 153.5 448 156.1 448 161.8v197.7c0 23.75-12.12 45.75-31.78 57.69l-152.2 92.5C261.5 511.3 258.7 512 256 512C247.7 512 240 505 240 495.3V271.5l196-116.9C437.3 153.8 438.7 153.5 440 153.5z"]},mf={prefix:"fas",iconName:"list",icon:[512,512,["list-squares"],"f03a","M80 48h-64C7.156 48 0 55.16 0 64v64c0 8.844 7.156 16 16 16h64C88.84 144 96 136.8 96 128V64C96 55.16 88.84 48 80 48zM80 208h-64C7.156 208 0 215.2 0 224v64c0 8.844 7.156 16 16 16h64C88.84 304 96 296.8 96 288V224C96 215.2 88.84 208 80 208zM80 368h-64C7.156 368 0 375.2 0 384v64c0 8.844 7.156 16 16 16h64C88.84 464 96 456.8 96 448v-64C96 375.2 88.84 368 80 368zM192 128h288c17.67 0 32-14.33 32-31.1S497.7 64 480 64H192C174.3 64 160 78.33 160 95.1S174.3 128 192 128zM480 384H192c-17.67 0-32 14.33-32 32s14.33 32 32 32h288c17.67 0 32-14.33 32-32S497.7 384 480 384zM480 224H192C174.3 224 160 238.3 160 256s14.33 32 32 32h288c17.67 0 32-14.33 32-32S497.7 224 480 224z"]},vf={prefix:"fas",iconName:"trash",icon:[448,512,[],"f1f8","M53.21 467c1.562 24.84 23.02 45 47.9 45h245.8c24.88 0 46.33-20.16 47.9-45L416 128H32L53.21 467zM432 32H320l-11.58-23.16c-2.709-5.42-8.25-8.844-14.31-8.844H153.9c-6.061 0-11.6 3.424-14.31 8.844L128 32H16c-8.836 0-16 7.162-16 16V80c0 8.836 7.164 16 16 16h416c8.838 0 16-7.164 16-16V48C448 39.16 440.8 32 432 32z"]},gf={prefix:"fas",iconName:"user",icon:[448,512,[129489,61447,62144],"1f464","M224 256c70.7 0 128-57.31 128-128s-57.3-128-128-128C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3C77.61 304 0 381.6 0 477.3c0 19.14 15.52 34.67 34.66 34.67h378.7C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304z"]},yf={prefix:"fas",iconName:"xmark",icon:[320,512,[128473,10005,10006,10060,61453,"close","multiply","remove","times"],"d7","M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"]};function bf(t){let e;return{c(){e=_("path"),T(e,"d","M52.5 425.2l-.4.1c-5.8 4.4-11.4 9.3-16.5 14.5-.4.4-.3 1-.1 1.5.2.5.6.8.8.8l.3-.1a145 145 0 0116.7-14.6c.5-.4.3-1 .2-1.2-.1-.6-.6-1-1-1"),T(e,"fill","#2e2a2b")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function wf(t){let e;return{c(){e=_("path"),T(e,"d","M38.4 423.3c-.3 0-.5.2-.7.5-.1.3 0 .7.2 1.1l3.9 4.8c3.6 4.3 7.4 8.8 9.7 13.8.4.7.9.8 1 .8.3 0 .6-.1.7-.3v-1c-2.5-5.2-6.4-10-10.2-14.6l-3.8-4.6c-.2-.3-.5-.5-.8-.5"),T(e,"fill","#2e2a2b")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function xf(t){let e;return{c(){e=_("path"),T(e,"d","M43.9 421.2l-.6.2-.2.9c.2 7 .1 14-.3 21.2 0 .5.2.9.4 1 .2.3.6.5.9.5 0 0 .4 0 .4-.7.5-7.2.6-14.6.3-22 0-.7-.5-1-1-1"),T(e,"fill","#2e2a2b")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function kf(t){let e;return{c(){e=_("path"),T(e,"d","M33.8 429.5c-.1 0-.4 0-.4.5 0 .7.5 1.7 1.2 1.8 7.3 1 14.7 1.9 22 2.7h.2c.1 0 .4 0 .4-.5 0-.8-.5-1.7-1.1-1.8a2247 2247 0 01-22.3-2.7"),T(e,"fill","#2e2a2b")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function $f(e){let n,r,o,s,a,c,l,u,f,p,h,d=e[0]>=1&&bf(),m=e[0]>=2&&wf(),v=e[0]>=3&&xf(),g=e[0]>=4&&kf();return{c(){n=_("svg"),r=_("defs"),o=_("clipPath"),s=_("path"),a=_("g"),c=_("path"),d&&d.c(),l=C(),m&&m.c(),u=C(),v&&v.c(),f=C(),g&&g.c(),T(s,"d","M31.5 420.5h27v26.3h-27z"),T(o,"clipPathUnits","userSpaceOnUse"),T(c,"d","M56 422.3H33.6v22.4H56z"),T(c,"fill","white"),T(c,"stroke","#444141"),T(c,"stroke-width","1.7"),T(c,"stroke-miterlimit","10"),T(a,"transform","matrix(1.33333, 0, 0, -1.33333, -42.987354, 587.929871)"),T(n,"viewBox","0.5 -6 33 33"),T(n,"xmlns","http://www.w3.org/2000/svg"),T(n,"class","svelte-piofr8"),R(n,"clickable",void 0!==e[1])},m(t,y){w(t,n,y),b(n,r),b(r,o),b(o,s),b(n,a),b(a,c),d&&d.m(a,null),b(a,l),m&&m.m(a,null),b(a,u),v&&v.m(a,null),b(a,f),g&&g.m(a,null),p||(h=O(n,"click",(function(){i(void 0!==e[1]&&e[1]())&&(void 0!==e[1]&&e[1]()).apply(this,arguments)})),p=!0)},p(t,[r]){(e=t)[0]>=1?d||(d=bf(),d.c(),d.m(a,l)):d&&(d.d(1),d=null),e[0]>=2?m||(m=wf(),m.c(),m.m(a,u)):m&&(m.d(1),m=null),e[0]>=3?v||(v=xf(),v.c(),v.m(a,f)):v&&(v.d(1),v=null),e[0]>=4?g||(g=kf(),g.c(),g.m(a,null)):g&&(g.d(1),g=null),2&r&&R(n,"clickable",void 0!==e[1])},i:t,o:t,d(t){t&&x(n),d&&d.d(),m&&m.d(),v&&v.d(),g&&g.d(),p=!1,h()}}}function _f(t,e,n){let{progress:r}=e,{onClick:o}=e;return t.$$set=t=>{"progress"in t&&n(0,r=t.progress),"onClick"in t&&n(1,o=t.onClick)},[r,o]}const Mf=class extends pt{constructor(t){super(),ft(this,t,_f,$f,s,{progress:0,onClick:1})}};function Sf(t,e,n){const r=t.slice();return r[5]=e[n],r[7]=n,r}function Cf(t){let e,n;function r(){return t[4](t[7])}return e=new Mf({props:{progress:t[2](t[0].ticks,t[7]),onClick:r}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(n,o){t=n;const i={};1&o&&(i.progress=t[2](t[0].ticks,t[7])),2&o&&(i.onClick=r),e.$set(i)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Of(t){let e,n,r=Array(10),o=[];for(let e=0;e<r.length;e+=1)o[e]=Cf(Sf(t,r,e));const i=t=>st(o[t],1,1,(()=>{o[t]=null}));return{c(){e=$("div");for(let t=0;t<o.length;t+=1)o[t].c();T(e,"class","progress-track svelte-i9g29p")},m(t,r){w(t,e,r);for(let t=0;t<o.length;t+=1)o[t].m(e,null);n=!0},p(t,[n]){if(7&n){let s;for(r=Array(10),s=0;s<r.length;s+=1){const i=Sf(t,r,s);o[s]?(o[s].p(i,n),it(o[s],1)):(o[s]=Cf(i),o[s].c(),it(o[s],1),o[s].m(e,null))}for(rt(),s=r.length;s<o.length;s+=1)i(s);ot()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)it(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)st(o[t]);n=!1},d(t){t&&x(e),k(o,t)}}}function Tf(t,e,n){let r,{progressTrack:o}=e,{onTicksChange:i}=e;const s=(t,e)=>Math.min(Math.max(t-4*e,0),4);return t.$$set=t=>{"progressTrack"in t&&n(0,o=t.progressTrack),"onTicksChange"in t&&n(3,i=t.onTicksChange)},t.$$.update=()=>{9&t.$$.dirty&&n(1,r=t=>{const e=s(o.ticks,t);let n=o.ticks;4===e?n-=Math.max(o.rank.ticksPerProgress,4):n+=o.rank.ticksPerProgress,i(n)})},[o,r,s,i,t=>r(t)]}const Af=class extends pt{constructor(t){super(),ft(this,t,Tf,Of,s,{progressTrack:0,onTicksChange:3})}};function Nf(t,e,n){const r=t.slice();return r[25]=e[n],r}function Ef(t){let e,n;return{c(){e=$("span"),n=M(t[8]),T(e,"class","errorText svelte-1y271l1")},m(t,r){w(t,e,r),b(e,n)},p(t,e){256&e&&N(n,t[8])},d(t){t&&x(e)}}}function Df(t){let e,n;return e=new _l({props:{anchor:t[11],offsetY:-10,$$slots:{default:[Rf]},$$scope:{ctx:t}}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};2048&n&&(r.anchor=t[11]),268435457&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function zf(t){let e,n,r=t[25].getDescription()+"";return{c(){e=$("span"),n=M(r),T(e,"class","svelte-1y271l1")},m(t,r){w(t,e,r),b(e,n)},p(t,e){1&e&&r!==(r=t[25].getDescription()+"")&&N(n,r)},d(t){t&&x(e)}}}function Rf(t){let e,n=t[0].modifiers,r=[];for(let e=0;e<n.length;e+=1)r[e]=zf(Nf(t,n,e));return{c(){e=$("div");for(let t=0;t<r.length;t+=1)r[t].c();T(e,"class","modifiers svelte-1y271l1")},m(t,n){w(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(1&o){let i;for(n=t[0].modifiers,i=0;i<n.length;i+=1){const s=Nf(t,n,i);r[i]?r[i].p(s,o):(r[i]=zf(s),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(t){t&&x(e),k(r,t)}}}function If(t){let e,n,r,i,s,a,c,l,u,f,p,h,d,m,v,g,y,k,_,A,E,D,z=(t[5]??t[0].name)+"",I=void 0!==t[8]&&Ef(t),B=t[12]&&Df(t);return{c(){e=$("div"),n=$("div"),r=$("button"),i=M("-"),a=S(),c=$("div"),l=$("input"),f=S(),p=$("span"),h=M(z),d=S(),m=$("button"),v=M("+"),y=S(),I&&I.c(),k=S(),B&&B.c(),_=C(),T(r,"class","decrease svelte-1y271l1"),r.disabled=s=void 0!==t[10],R(r,"visible",t[2]),l.value=t[7],l.disabled=u=!t[3],T(l,"class","svelte-1y271l1"),T(p,"class","name svelte-1y271l1"),R(p,"clickable",void 0!==t[6]),T(c,"class","stat svelte-1y271l1"),R(c,"modified",t[12]),T(m,"class","increase svelte-1y271l1"),m.disabled=g=void 0!==t[9],R(m,"visible",t[2]),T(n,"class","wrapper svelte-1y271l1"),T(e,"class","statInput svelte-1y271l1"),R(e,"vertical",t[4]),R(e,"error",void 0!==t[8])},m(o,s){w(o,e,s),b(e,n),b(n,r),b(r,i),b(n,a),b(n,c),b(c,l),b(c,f),b(c,p),b(p,h),b(n,d),b(n,m),b(m,v),b(e,y),I&&I.m(e,null),t[21](e),w(o,k,s),B&&B.m(o,s),w(o,_,s),A=!0,E||(D=[O(r,"click",t[16]),O(l,"input",t[13]),O(l,"keydown",t[17]),O(l,"blur",t[18]),O(p,"click",t[19]),O(m,"click",t[20])],E=!0)},p(t,[n]){(!A||1024&n&&s!==(s=void 0!==t[10]))&&(r.disabled=s),4&n&&R(r,"visible",t[2]),(!A||128&n&&l.value!==t[7])&&(l.value=t[7]),(!A||8&n&&u!==(u=!t[3]))&&(l.disabled=u),(!A||33&n)&&z!==(z=(t[5]??t[0].name)+"")&&N(h,z),64&n&&R(p,"clickable",void 0!==t[6]),4096&n&&R(c,"modified",t[12]),(!A||512&n&&g!==(g=void 0!==t[9]))&&(m.disabled=g),4&n&&R(m,"visible",t[2]),void 0!==t[8]?I?I.p(t,n):(I=Ef(t),I.c(),I.m(e,null)):I&&(I.d(1),I=null),16&n&&R(e,"vertical",t[4]),256&n&&R(e,"error",void 0!==t[8]),t[12]?B?(B.p(t,n),4096&n&&it(B,1)):(B=Df(t),B.c(),it(B,1),B.m(_.parentNode,_)):B&&(rt(),st(B,1,1,(()=>{B=null})),ot())},i(t){A||(it(B),A=!0)},o(t){st(B),A=!1},d(n){n&&x(e),I&&I.d(),t[21](null),n&&x(k),B&&B.d(n),n&&x(_),E=!1,o(D)}}}const Bf=/^[+-]?[0-9]*$/;function Pf(t,e,n){let r,o,i,s,a,c,l,u,f,{stat:p}=e,{character:h}=e,{onBaseValueChange:d}=e,{showButtons:m=!1}=e,{canEdit:v=!0}=e,{showSign:g=!0}=e,{vertical:y=!1}=e,{label:b}=e,{onClick:w}=e;return t.$$set=t=>{"stat"in t&&n(0,p=t.stat),"character"in t&&n(14,h=t.character),"onBaseValueChange"in t&&n(1,d=t.onBaseValueChange),"showButtons"in t&&n(2,m=t.showButtons),"canEdit"in t&&n(3,v=t.canEdit),"showSign"in t&&n(15,g=t.showSign),"vertical"in t&&n(4,y=t.vertical),"label"in t&&n(5,b=t.label),"onClick"in t&&n(6,w=t.onClick)},t.$$.update=()=>{32769&t.$$.dirty&&(r=cu(jl(p),g)),32769&t.$$.dirty&&n(7,s=cu(jl(p),g)),16385&t.$$.dirty&&n(8,a=((t,e)=>{if(void 0!==t.validator)return t.validator(e,jl(t))})(p,h)),16385&t.$$.dirty&&n(9,c=((t,e)=>{if(void 0!==t.validator){const n=t.validator(e,jl(t)+1);if(void 0!==n)return n}if(void 0!==t.increaseValidator){const n=t.increaseValidator(e,jl(t)+1);if(void 0!==n)return n}})(p,h)),16385&t.$$.dirty&&n(10,l=((t,e)=>{if(void 0!==t.validator){const n=t.validator(e,jl(t)-1);if(void 0!==n)return n}if(void 0!==t.decreaseValidator){const n=t.decreaseValidator(e,jl(t)-1);if(void 0!==n)return n}})(p,h)),1&t.$$.dirty&&n(12,f=p.modifiers.length>0)},[p,d,m,v,y,b,w,s,a,c,l,u,f,t=>{n(7,s=t.target.value),Bf.test(s)?(r=s,o=t.target.selectionStart,i=t.target.selectionEnd):(n(7,s=r),requestAnimationFrame((()=>{t.target.selectionStart=o,t.target.selectionEnd=i})))},h,g,()=>d(p.baseValue-1),t=>{switch(t.key){case"Enter":return t.target.blur(),void t.preventDefault();case"ArrowUp":return void 0===c&&d(p.baseValue+1),void t.preventDefault();case"ArrowDown":return void 0===l&&d(p.baseValue-1),void t.preventDefault()}},()=>{const t=Number(s);Number.isNaN(t)?d(0):d(t)},()=>void 0!==w&&w(p),()=>d(p.baseValue+1),function(t){H[t?"unshift":"push"]((()=>{u=t,n(11,u)}))}]}const jf=class extends pt{constructor(t){super(),ft(this,t,Pf,If,s,{stat:0,character:14,onBaseValueChange:1,showButtons:2,canEdit:3,showSign:15,vertical:4,label:5,onClick:6})}};function Vf(t){let e,n,r,o;function i(t,e){return"string"==typeof t[8][4]?Hf:Lf}let s=i(t),a=s(t);return{c(){e=_("svg"),n=_("g"),r=_("g"),a.c(),T(r,"transform",t[10]),T(n,"transform","translate(256 256)"),T(e,"id",t[1]),T(e,"class",t[0]),T(e,"style",t[9]),T(e,"viewBox",o=`0 0 ${t[8][0]} ${t[8][1]}`),T(e,"aria-hidden","true"),T(e,"role","img"),T(e,"xmlns","http://www.w3.org/2000/svg")},m(t,o){w(t,e,o),b(e,n),b(n,r),a.m(r,null)},p(t,n){s===(s=i(t))&&a?a.p(t,n):(a.d(1),a=s(t),a&&(a.c(),a.m(r,null))),1024&n&&T(r,"transform",t[10]),2&n&&T(e,"id",t[1]),1&n&&T(e,"class",t[0]),512&n&&T(e,"style",t[9]),256&n&&o!==(o=`0 0 ${t[8][0]} ${t[8][1]}`)&&T(e,"viewBox",o)},d(t){t&&x(e),a.d()}}}function Lf(t){let e,n,r,o,i,s,a,c;return{c(){e=_("path"),i=_("path"),T(e,"d",n=t[8][4][0]),T(e,"fill",r=t[4]||t[2]||"currentColor"),T(e,"fill-opacity",o=0!=t[7]?t[5]:t[6]),T(e,"transform","translate(-256 -256)"),T(i,"d",s=t[8][4][1]),T(i,"fill",a=t[3]||t[2]||"currentColor"),T(i,"fill-opacity",c=0!=t[7]?t[6]:t[5]),T(i,"transform","translate(-256 -256)")},m(t,n){w(t,e,n),w(t,i,n)},p(t,l){256&l&&n!==(n=t[8][4][0])&&T(e,"d",n),20&l&&r!==(r=t[4]||t[2]||"currentColor")&&T(e,"fill",r),224&l&&o!==(o=0!=t[7]?t[5]:t[6])&&T(e,"fill-opacity",o),256&l&&s!==(s=t[8][4][1])&&T(i,"d",s),12&l&&a!==(a=t[3]||t[2]||"currentColor")&&T(i,"fill",a),224&l&&c!==(c=0!=t[7]?t[6]:t[5])&&T(i,"fill-opacity",c)},d(t){t&&x(e),t&&x(i)}}}function Hf(t){let e,n,r;return{c(){e=_("path"),T(e,"d",n=t[8][4]),T(e,"fill",r=t[2]||t[3]||"currentColor"),T(e,"transform","translate(-256 -256)")},m(t,n){w(t,e,n)},p(t,o){256&o&&n!==(n=t[8][4])&&T(e,"d",n),12&o&&r!==(r=t[2]||t[3]||"currentColor")&&T(e,"fill",r)},d(t){t&&x(e)}}}function Ff(e){let n,r=e[8][4]&&Vf(e);return{c(){r&&r.c(),n=C()},m(t,e){r&&r.m(t,e),w(t,n,e)},p(t,[e]){t[8][4]?r?r.p(t,e):(r=Vf(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&x(n)}}}function Wf(t,e,n){let r,o,i,{class:s=""}=e,{id:a=""}=e,{style:c=""}=e,{icon:l}=e,{fw:u=!1}=e,{flip:f=!1}=e,{pull:p=""}=e,{rotate:h=""}=e,{size:d=""}=e,{color:m=""}=e,{primaryColor:v=""}=e,{secondaryColor:g=""}=e,{primaryOpacity:y=1}=e,{secondaryOpacity:b=.4}=e,{swapOpacity:w=!1}=e;return t.$$set=t=>{"class"in t&&n(0,s=t.class),"id"in t&&n(1,a=t.id),"style"in t&&n(11,c=t.style),"icon"in t&&n(12,l=t.icon),"fw"in t&&n(13,u=t.fw),"flip"in t&&n(14,f=t.flip),"pull"in t&&n(15,p=t.pull),"rotate"in t&&n(16,h=t.rotate),"size"in t&&n(17,d=t.size),"color"in t&&n(2,m=t.color),"primaryColor"in t&&n(3,v=t.primaryColor),"secondaryColor"in t&&n(4,g=t.secondaryColor),"primaryOpacity"in t&&n(5,y=t.primaryOpacity),"secondaryOpacity"in t&&n(6,b=t.secondaryOpacity),"swapOpacity"in t&&n(7,w=t.swapOpacity)},t.$$.update=()=>{if(4096&t.$$.dirty&&n(8,r=l&&l.icon||[0,0,"",[],""]),174080&t.$$.dirty){let t,e;const r="1em";let i,s,a,l="-.125em";const f="visible";u&&(a="center",e="1.25em"),p&&(t=p),d&&("lg"==d?(s="1.33333em",i=".75em",l="-.225em"):s="xs"==d?".75em":"sm"==d?".875em":d.replace("x","em"));const h={float:t,width:e,height:r,"line-height":i,"font-size":s,"text-align":a,"vertical-align":l,overflow:f};let m="";for(const t in h)h[t]&&(m+=`${t}:${h[t]};`);n(9,o=m+c)}if(81920&t.$$.dirty){let t="";if(f){let e=1,n=1;"horizontal"==f?e=-1:"vertical"==f?n=-1:e=n=-1,t+=` scale(${e} ${n})`}h&&(t+=` rotate(${h} 0 0)`),n(10,i=t)}},[s,a,m,v,g,y,b,w,r,o,i,c,l,u,f,p,h,d]}const qf=class extends pt{constructor(t){super(),ft(this,t,Wf,Ff,s,{class:0,id:1,style:11,icon:12,fw:13,flip:14,pull:15,rotate:16,size:17,color:2,primaryColor:3,secondaryColor:4,primaryOpacity:5,secondaryOpacity:6,swapOpacity:7})}};function Jf(t){let e,n,r,o,s;return n=new qf({props:{icon:yf,size:"lg"}}),{c(){e=$("div"),ct(n.$$.fragment),T(e,"class","closeButton svelte-906qcl")},m(a,c){w(a,e,c),lt(n,e,null),r=!0,o||(s=O(e,"click",(function(){i(t[0])&&t[0].apply(this,arguments)})),o=!0)},p(e,n){t=e},i(t){r||(it(n.$$.fragment,t),r=!0)},o(t){st(n.$$.fragment,t),r=!1},d(t){t&&x(e),ut(n),o=!1,s()}}}function Kf(t){let e,n,r,o,s,a,c,l,u,p,d,m,v,g=(t[1]??"")+"",y=void 0!==t[0]&&Jf(t);const k=t[2].default,_=f(k,t,t[3],null);return{c(){e=$("div"),n=S(),r=$("div"),o=$("div"),s=$("div"),a=$("h2"),c=M(g),l=S(),y&&y.c(),u=S(),p=$("div"),_&&_.c(),T(e,"class","overlay svelte-906qcl"),T(a,"class","title svelte-906qcl"),T(s,"class","header svelte-906qcl"),T(p,"class","body svelte-906qcl"),T(o,"class","modal svelte-906qcl"),T(r,"class","wrapper svelte-906qcl")},m(f,h){w(f,e,h),w(f,n,h),w(f,r,h),b(r,o),b(o,s),b(s,a),b(a,c),b(s,l),y&&y.m(s,null),b(o,u),b(o,p),_&&_.m(p,null),d=!0,m||(v=O(e,"click",(function(){i(t[0])&&t[0].apply(this,arguments)})),m=!0)},p(e,n){t=e,(!d||2&n)&&g!==(g=(t[1]??"")+"")&&N(c,g),void 0!==t[0]?y?(y.p(t,n),1&n&&it(y,1)):(y=Jf(t),y.c(),it(y,1),y.m(s,null)):y&&(rt(),st(y,1,1,(()=>{y=null})),ot()),_&&_.p&&(!d||8&n)&&h(_,k,t,t[3],d?n:-1,null,null)},i(t){d||(it(y),it(_,t),d=!0)},o(t){st(y),st(_,t),d=!1},d(t){t&&x(e),t&&x(n),t&&x(r),y&&y.d(),_&&_.d(t),m=!1,v()}}}function Uf(t){let e,n;return e=new bl({props:{$$slots:{default:[Kf]},$$scope:{ctx:t}}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,[n]){const r={};11&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Yf(t,e,n){let{$$slots:r={},$$scope:o}=e,{onClose:i}=e,{title:s}=e;return t.$$set=t=>{"onClose"in t&&n(0,i=t.onClose),"title"in t&&n(1,s=t.title),"$$scope"in t&&n(3,o=t.$$scope)},[i,s,r,o]}const Gf=class extends pt{constructor(t){super(),ft(this,t,Yf,Uf,s,{onClose:0,title:1})}};function Zf(t){let e,n;return e=new Gf({props:{title:`Roll ${au(t[0])}`,closable:!0,onClose:t[6],open:void 0!==t[0],$$slots:{default:[Xf]},$$scope:{ctx:t}}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.title=`Roll ${au(t[0])}`),1&n&&(r.onClose=t[6]),1&n&&(r.open=void 0!==t[0]),135&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Xf(t){let e,n,r,i,s,a,c,l,u,f,p,h,d,m,v,g,y,k,_,C,D,z,R=lu(t[1].name)+"",I=au(t[0])+"",B=cu(jl(t[1].stats[t[0]]))+"";return k=new qf({props:{icon:df}}),{c(){e=$("div"),n=$("div"),r=$("span"),i=M(R),s=S(),a=M(I),c=M(":\n          "),l=M(B),u=S(),f=$("div"),p=$("span"),p.textContent="Adds",h=S(),d=$("div"),m=$("input"),v=S(),g=$("div"),y=$("button"),ct(k.$$.fragment),_=M(" Roll"),T(n,"class","smallBottomPadding svelte-xkq092"),T(p,"class","header"),T(m,"type","number"),T(f,"class","addsWrapper bigBottomPadding svelte-xkq092"),T(y,"class","svelte-xkq092"),T(g,"class","rollWrapper svelte-xkq092"),T(e,"class","wrapper svelte-xkq092")},m(o,x){w(o,e,x),b(e,n),b(n,r),b(r,i),b(r,s),b(r,a),b(r,c),b(r,l),b(e,u),b(e,f),b(f,p),b(f,h),b(f,d),b(d,m),E(m,t[2]),b(e,v),b(e,g),b(g,y),lt(k,y,null),b(y,_),C=!0,D||(z=[O(m,"input",t[5]),O(y,"click",t[3])],D=!0)},p(t,e){(!C||2&e)&&R!==(R=lu(t[1].name)+"")&&N(i,R),(!C||1&e)&&I!==(I=au(t[0])+"")&&N(a,I),(!C||3&e)&&B!==(B=cu(jl(t[1].stats[t[0]]))+"")&&N(l,B),4&e&&A(m.value)!==t[2]&&E(m,t[2])},i(t){C||(it(k.$$.fragment,t),C=!0)},o(t){st(k.$$.fragment,t),C=!1},d(t){t&&x(e),ut(k),D=!1,o(z)}}}function Qf(t){let e,n,r=void 0!==t[0]&&Zf(t);return{c(){r&&r.c(),e=C()},m(t,o){r&&r.m(t,o),w(t,e,o),n=!0},p(t,[n]){void 0!==t[0]?r?(r.p(t,n),1&n&&it(r,1)):(r=Zf(t),r.c(),it(r,1),r.m(e.parentNode,e)):r&&(rt(),st(r,1,1,(()=>{r=null})),ot())},i(t){n||(it(r),n=!0)},o(t){st(r),n=!1},d(t){r&&r.d(t),t&&x(e)}}}function tp(t,e,n){let{statName:r}=e,{character:o}=e,{onClose:i}=e,s=0;return t.$$set=t=>{"statName"in t&&n(0,r=t.statName),"character"in t&&n(1,o=t.character),"onClose"in t&&n(4,i=t.onClose)},[r,o,s,()=>{su(o,r,s),i(),Qu.goto("/log")},i,function(){s=A(this.value),n(2,s)},()=>n(0,r=void 0)]}const ep=class extends pt{constructor(t){super(),ft(this,t,tp,Qf,s,{statName:0,character:1,onClose:4})}};function np(t,e,n){const r=t.slice();return r[19]=e[n].groupKey,r[20]=e[n].debilities,r[21]=e,r[22]=n,r}function rp(t,e,n){const r=t.slice();return r[23]=e[n],r[24]=e,r[25]=n,r}function op(t,e,n){const r=t.slice();return r[26]=e[n],r[27]=e,r[28]=n,r}function ip(t,e,n){const r=t.slice();return r[29]=e[n],r}function sp(t,e,n){const r=t.slice();return r[32]=e[n],r}function ap(t,e,n){const r=t.slice();return r[35]=e[n],r}function cp(t){let e;return{c(){e=M("Stats")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function lp(t){let e,n;function r(...e){return t[6](t[35],...e)}function o(){return t[7](t[35])}return e=new jf({props:{stat:t[1].stats[t[35]],onBaseValueChange:r,character:t[1],showButtons:!1,showSign:!0,canEdit:!0,onClick:o}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(n,i){t=n;const s={};2&i[0]&&(s.stat=t[1].stats[t[35]]),2&i[0]&&(s.onBaseValueChange=r),2&i[0]&&(s.character=t[1]),1&i[0]&&(s.onClick=o),e.$set(s)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function up(t){let e;return{c(){e=M("Status")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function fp(t){let e,n;function r(...e){return t[8](t[32],...e)}return e=new jf({props:{stat:t[1].statuses[t[32]],onBaseValueChange:r,character:t[1],showButtons:!0,showSign:!0,canEdit:!0}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(n,o){t=n;const i={};2&o[0]&&(i.stat=t[1].statuses[t[32]]),2&o[0]&&(i.onBaseValueChange=r),2&o[0]&&(i.character=t[1]),e.$set(i)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function pp(t){let e;return{c(){e=M("Momentum")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function hp(t){let e;return{c(){e=M("Bonds")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function dp(t){let e;return{c(){e=M("Vows")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function mp(e){let n,r,o,i=e[29].name+"";return{c(){n=$("option"),r=M(i),n.__value=o=e[29],n.value=n.__value},m(t,e){w(t,n,e),b(n,r)},p:t,d(t){t&&x(n)}}}function vp(t){let e,n,r,i,s,a,c,l,u,f,p;function h(){t[14].call(r,t[27],t[28])}let d=Object.values(Ll),m=[];for(let e=0;e<d.length;e+=1)m[e]=mp(ip(t,d,e));function v(){t[15].call(s,t[27],t[28])}function g(...e){return t[16](t[26],t[27],t[28],...e)}return c=new Af({props:{progressTrack:t[26],onTicksChange:g}}),{c(){e=$("div"),n=$("div"),r=$("input"),i=S(),s=$("select");for(let t=0;t<m.length;t+=1)m[t].c();a=S(),ct(c.$$.fragment),l=S(),T(r,"class","svelte-17gsah3"),void 0===t[26].rank&&Y(v),T(n,"class","header svelte-17gsah3"),T(e,"class","vow svelte-17gsah3")},m(o,d){w(o,e,d),b(e,n),b(n,r),E(r,t[26].name),b(n,i),b(n,s);for(let t=0;t<m.length;t+=1)m[t].m(s,null);z(s,t[26].rank),b(e,a),lt(c,e,null),b(e,l),u=!0,f||(p=[O(r,"input",h),O(s,"change",v)],f=!0)},p(e,n){if(t=e,2&n[0]&&r.value!==t[26].name&&E(r,t[26].name),0&n){let e;for(d=Object.values(Ll),e=0;e<d.length;e+=1){const r=ip(t,d,e);m[e]?m[e].p(r,n):(m[e]=mp(r),m[e].c(),m[e].m(s,null))}for(;e<m.length;e+=1)m[e].d(1);m.length=d.length}2&n[0]&&z(s,t[26].rank);const o={};2&n[0]&&(o.progressTrack=t[26]),2&n[0]&&(o.onTicksChange=g),c.$set(o)},i(t){u||(it(c.$$.fragment,t),u=!0)},o(t){st(c.$$.fragment,t),u=!1},d(t){t&&x(e),k(m,t),ut(c),f=!1,o(p)}}}function gp(t){let e;return{c(){e=M("Debilities")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function yp(t){let e,n,r,o,i,s,a,c,l=au(t[23])+"";function u(){t[17].call(r,t[19],t[23])}return{c(){e=$("div"),n=$("label"),r=$("input"),o=S(),i=M(l),T(r,"type","checkbox"),T(e,"class","debility svelte-17gsah3"),T(e,"id",s=`debility_group_${t[23]}`)},m(s,l){w(s,e,l),b(e,n),b(n,r),r.checked=t[1].debilities[t[19]][t[23]],b(n,o),b(n,i),a||(c=O(r,"change",u),a=!0)},p(e,n){t=e,10&n[0]&&(r.checked=t[1].debilities[t[19]][t[23]])},d(t){t&&x(e),a=!1,c()}}}function bp(t){let e,n,r,o,i,s,a,c=au(t[19])+"",l=t[20],u=[];for(let e=0;e<l.length;e+=1)u[e]=yp(rp(t,l,e));return{c(){e=$("div"),n=$("label"),r=M(c),i=S();for(let t=0;t<u.length;t+=1)u[t].c();s=S(),T(n,"for",o=`debility_group_${t[19]}`),T(n,"class","svelte-17gsah3"),T(e,"class","debilities-group svelte-17gsah3"),T(e,"id",a=`debility_group_${t[19]}`)},m(t,o){w(t,e,o),b(e,n),b(n,r),b(e,i);for(let t=0;t<u.length;t+=1)u[t].m(e,null);b(e,s)},p(t,n){if(10&n[0]){let r;for(l=t[20],r=0;r<l.length;r+=1){const o=rp(t,l,r);u[r]?u[r].p(o,n):(u[r]=yp(o),u[r].c(),u[r].m(e,s))}for(;r<u.length;r+=1)u[r].d(1);u.length=l.length}},d(t){t&&x(e),k(u,t)}}}function wp(t){let e,n;return e=new ep({props:{statName:t[0],character:t[1],onClose:t[18]}}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};1&n[0]&&(r.statName=t[0]),2&n[0]&&(r.character=t[1]),1&n[0]&&(r.onClose=t[18]),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function xp(t){let e,n,r,i,s,a,c,l,u,f,p,h,d,m,v,g,y,_,M,N,D,z,R,I,B,P,j,V,L,H,F,W,q,J,K,U,Y,G,Z,X,Q,tt,et,nt,at,ft,pt,ht;d=new yu({props:{$$slots:{default:[cp]},$$scope:{ctx:t}}});let dt=Pl,mt=[];for(let e=0;e<dt.length;e+=1)mt[e]=lp(ap(t,dt,e));const vt=t=>st(mt[t],1,1,(()=>{mt[t]=null}));y=new yu({props:{$$slots:{default:[up]},$$scope:{ctx:t}}});let gt=["health","spirit","supply"],yt=[];for(let e=0;e<3;e+=1)yt[e]=fp(sp(t,gt,e));const bt=t=>st(yt[t],1,1,(()=>{yt[t]=null}));D=new yu({props:{$$slots:{default:[pp]},$$scope:{ctx:t}}}),I=new jf({props:{stat:t[1].momentum.current,onBaseValueChange:t[9],character:t[1],showButtons:!0,showSign:!0,canEdit:!0,label:"Current"}}),P=new yu({props:{vertical:!0}}),V=new jf({props:{stat:t[1].momentum.max,onBaseValueChange:t[10],character:t[1],showButtons:!1,showSign:!0,canEdit:!0,label:"Max"}}),H=new jf({props:{stat:t[1].momentum.reset,onBaseValueChange:t[11],character:t[1],showButtons:!1,showSign:!0,canEdit:!0,label:"Reset",onClick:t[12]}}),W=new yu({props:{$$slots:{default:[hp]},$$scope:{ctx:t}}}),K=new Af({props:{progressTrack:t[1].bonds,onTicksChange:t[13]}}),Y=new yu({props:{$$slots:{default:[dp]},$$scope:{ctx:t}}});let wt=t[1].vows,xt=[];for(let e=0;e<wt.length;e+=1)xt[e]=vp(op(t,wt,e));const kt=t=>st(xt[t],1,1,(()=>{xt[t]=null}));Q=new yu({props:{$$slots:{default:[gp]},$$scope:{ctx:t}}});let $t=t[3],_t=[];for(let e=0;e<$t.length;e+=1)_t[e]=bp(np(t,$t,e));let Mt=t[0]&&wp(t);return{c(){e=$("div"),n=$("div"),r=$("div"),i=$("label"),i.textContent="Character",s=S(),a=$("input"),c=S(),l=$("div"),u=$("label"),u.textContent="Experience",f=S(),p=$("input"),h=S(),ct(d.$$.fragment),m=S(),v=$("div");for(let t=0;t<mt.length;t+=1)mt[t].c();g=S(),ct(y.$$.fragment),_=S(),M=$("div");for(let t=0;t<3;t+=1)yt[t].c();N=S(),ct(D.$$.fragment),z=S(),R=$("div"),ct(I.$$.fragment),B=S(),ct(P.$$.fragment),j=S(),ct(V.$$.fragment),L=S(),ct(H.$$.fragment),F=S(),ct(W.$$.fragment),q=S(),J=$("div"),ct(K.$$.fragment),U=S(),ct(Y.$$.fragment),G=S(),Z=$("div");for(let t=0;t<xt.length;t+=1)xt[t].c();X=S(),ct(Q.$$.fragment),tt=S(),et=$("div");for(let t=0;t<_t.length;t+=1)_t[t].c();nt=S(),Mt&&Mt.c(),at=C(),T(i,"for","name"),T(a,"class","svelte-17gsah3"),T(r,"class","name svelte-17gsah3"),T(r,"id","name"),T(u,"for","experience"),T(p,"type","number"),T(p,"class","svelte-17gsah3"),T(l,"class","experience svelte-17gsah3"),T(l,"id","experience"),T(n,"class","header svelte-17gsah3"),T(v,"class","stats stats-wrapper svelte-17gsah3"),T(M,"class","statuses stats-wrapper svelte-17gsah3"),T(R,"class","momentum stats-wrapper svelte-17gsah3"),T(J,"class","bonds svelte-17gsah3"),T(et,"class","debilities svelte-17gsah3"),T(e,"class","character svelte-17gsah3")},m(o,x){w(o,e,x),b(e,n),b(n,r),b(r,i),b(r,s),b(r,a),E(a,t[1].name),b(n,c),b(n,l),b(l,u),b(l,f),b(l,p),E(p,t[1].experience),b(e,h),lt(d,e,null),b(e,m),b(e,v);for(let t=0;t<mt.length;t+=1)mt[t].m(v,null);b(e,g),lt(y,e,null),b(e,_),b(e,M);for(let t=0;t<3;t+=1)yt[t].m(M,null);b(e,N),lt(D,e,null),b(e,z),b(e,R),lt(I,R,null),b(R,B),lt(P,R,null),b(R,j),lt(V,R,null),b(R,L),lt(H,R,null),b(e,F),lt(W,e,null),b(e,q),b(e,J),lt(K,J,null),b(e,U),lt(Y,e,null),b(e,G),b(e,Z);for(let t=0;t<xt.length;t+=1)xt[t].m(Z,null);b(e,X),lt(Q,e,null),b(e,tt),b(e,et);for(let t=0;t<_t.length;t+=1)_t[t].m(et,null);w(o,nt,x),Mt&&Mt.m(o,x),w(o,at,x),ft=!0,pt||(ht=[O(a,"input",t[4]),O(p,"input",t[5])],pt=!0)},p(t,e){2&e[0]&&a.value!==t[1].name&&E(a,t[1].name),2&e[0]&&A(p.value)!==t[1].experience&&E(p,t[1].experience);const n={};if(128&e[1]&&(n.$$scope={dirty:e,ctx:t}),d.$set(n),3&e[0]){let n;for(dt=Pl,n=0;n<dt.length;n+=1){const r=ap(t,dt,n);mt[n]?(mt[n].p(r,e),it(mt[n],1)):(mt[n]=lp(r),mt[n].c(),it(mt[n],1),mt[n].m(v,null))}for(rt(),n=dt.length;n<mt.length;n+=1)vt(n);ot()}const r={};if(128&e[1]&&(r.$$scope={dirty:e,ctx:t}),y.$set(r),2&e[0]){let n;for(gt=["health","spirit","supply"],n=0;n<3;n+=1){const r=sp(t,gt,n);yt[n]?(yt[n].p(r,e),it(yt[n],1)):(yt[n]=fp(r),yt[n].c(),it(yt[n],1),yt[n].m(M,null))}for(rt(),n=3;n<3;n+=1)bt(n);ot()}const o={};128&e[1]&&(o.$$scope={dirty:e,ctx:t}),D.$set(o);const i={};2&e[0]&&(i.stat=t[1].momentum.current),2&e[0]&&(i.onBaseValueChange=t[9]),2&e[0]&&(i.character=t[1]),I.$set(i);const s={};2&e[0]&&(s.stat=t[1].momentum.max),2&e[0]&&(s.onBaseValueChange=t[10]),2&e[0]&&(s.character=t[1]),V.$set(s);const c={};2&e[0]&&(c.stat=t[1].momentum.reset),2&e[0]&&(c.onBaseValueChange=t[11]),2&e[0]&&(c.character=t[1]),2&e[0]&&(c.onClick=t[12]),H.$set(c);const l={};128&e[1]&&(l.$$scope={dirty:e,ctx:t}),W.$set(l);const u={};2&e[0]&&(u.progressTrack=t[1].bonds),2&e[0]&&(u.onTicksChange=t[13]),K.$set(u);const f={};if(128&e[1]&&(f.$$scope={dirty:e,ctx:t}),Y.$set(f),2&e[0]){let n;for(wt=t[1].vows,n=0;n<wt.length;n+=1){const r=op(t,wt,n);xt[n]?(xt[n].p(r,e),it(xt[n],1)):(xt[n]=vp(r),xt[n].c(),it(xt[n],1),xt[n].m(Z,null))}for(rt(),n=wt.length;n<xt.length;n+=1)kt(n);ot()}const h={};if(128&e[1]&&(h.$$scope={dirty:e,ctx:t}),Q.$set(h),10&e[0]){let n;for($t=t[3],n=0;n<$t.length;n+=1){const r=np(t,$t,n);_t[n]?_t[n].p(r,e):(_t[n]=bp(r),_t[n].c(),_t[n].m(et,null))}for(;n<_t.length;n+=1)_t[n].d(1);_t.length=$t.length}t[0]?Mt?(Mt.p(t,e),1&e[0]&&it(Mt,1)):(Mt=wp(t),Mt.c(),it(Mt,1),Mt.m(at.parentNode,at)):Mt&&(rt(),st(Mt,1,1,(()=>{Mt=null})),ot())},i(t){if(!ft){it(d.$$.fragment,t);for(let t=0;t<dt.length;t+=1)it(mt[t]);it(y.$$.fragment,t);for(let t=0;t<3;t+=1)it(yt[t]);it(D.$$.fragment,t),it(I.$$.fragment,t),it(P.$$.fragment,t),it(V.$$.fragment,t),it(H.$$.fragment,t),it(W.$$.fragment,t),it(K.$$.fragment,t),it(Y.$$.fragment,t);for(let t=0;t<wt.length;t+=1)it(xt[t]);it(Q.$$.fragment,t),it(Mt),ft=!0}},o(t){st(d.$$.fragment,t),mt=mt.filter(Boolean);for(let t=0;t<mt.length;t+=1)st(mt[t]);st(y.$$.fragment,t),yt=yt.filter(Boolean);for(let t=0;t<3;t+=1)st(yt[t]);st(D.$$.fragment,t),st(I.$$.fragment,t),st(P.$$.fragment,t),st(V.$$.fragment,t),st(H.$$.fragment,t),st(W.$$.fragment,t),st(K.$$.fragment,t),st(Y.$$.fragment,t),xt=xt.filter(Boolean);for(let t=0;t<xt.length;t+=1)st(xt[t]);st(Q.$$.fragment,t),st(Mt),ft=!1},d(t){t&&x(e),ut(d),k(mt,t),ut(y),k(yt,t),ut(D),ut(I),ut(P),ut(V),ut(H),ut(W),ut(K),ut(Y),k(xt,t),ut(Q),k(_t,t),t&&x(nt),Mt&&Mt.d(t),t&&x(at),pt=!1,o(ht)}}}function kp(t,e,n){let r;const o=Ul("mock");let i;u(t,o,(t=>n(1,r=t)));const s=[{groupKey:"conditions",debilities:["wounded","shaken","unprepared","encumbered"]},{groupKey:"banes",debilities:["corrupted","maimed"]},{groupKey:"burdens",debilities:["cursed","tormented"]}];return[i,r,o,s,function(){r.name=this.value,o.set(r)},function(){r.experience=A(this.value),o.set(r)},(t,e)=>d(o,r.stats[t].baseValue=e,r),t=>n(0,i=t),(t,e)=>d(o,r.statuses[t].baseValue=e,r),t=>d(o,r.momentum.current.baseValue=t,r),t=>d(o,r.momentum.max.baseValue=t,r),t=>d(o,r.momentum.reset.baseValue=t,r),()=>{d(o,r.momentum.current.baseValue=jl(r.momentum.reset),r)},t=>d(o,r.bonds.ticks=t,r),function(t,e){t[e].name=this.value,o.set(r)},function(t,e){t[e].rank=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),o.set(r)},(t,e,n,i)=>d(o,e[n].ticks=i,r),function(t,e){r.debilities[t][e]=this.checked,o.set(r),n(3,s)},()=>n(0,i=void 0)]}const $p=class extends pt{constructor(t){super(),ft(this,t,kp,xp,s,{},[-1,-1])}};function _p(t,e,n){const r=t.slice();return r[10]=e[n],r}function Mp(t,e){let n,r,o,i,s,a,c,l,u;function f(){return e[5](e[10])}o=new qf({props:{icon:vf}});var p=nu(e[10].type);function h(t){return{props:{logItem:t[10]}}}return p&&(s=new p(h(e))),{key:t,first:null,c(){n=$("div"),r=$("span"),ct(o.$$.fragment),i=S(),s&&ct(s.$$.fragment),a=S(),T(r,"class","delete-icon"),T(n,"class","log-item svelte-1yweirf"),R(n,"highlight",e[4](e[10])),this.first=n},m(t,e){w(t,n,e),b(n,r),lt(o,r,null),b(n,i),s&&lt(s,n,null),b(n,a),c=!0,l||(u=O(r,"click",f),l=!0)},p(t,r){e=t;const o={};if(4&r&&(o.logItem=e[10]),p!==(p=nu(e[10].type))){if(s){rt();const t=s;st(t.$$.fragment,1,0,(()=>{ut(t,1)})),ot()}p?(s=new p(h(e)),ct(s.$$.fragment),it(s.$$.fragment,1),lt(s,n,a)):s=null}else p&&s.$set(o);20&r&&R(n,"highlight",e[4](e[10]))},i(t){c||(it(o.$$.fragment,t),s&&it(s.$$.fragment,t),c=!0)},o(t){st(o.$$.fragment,t),s&&st(s.$$.fragment,t),c=!1},d(t){t&&x(n),ut(o),s&&ut(s),l=!1,u()}}}function Sp(t){let e,n,r,o,i=[],s=new Map,a=t[2];const c=t=>t[10].id;for(let e=0;e<a.length;e+=1){let n=_p(t,a,e),r=c(n);s.set(r,i[e]=Mp(r,n))}return{c(){e=$("div");for(let t=0;t<i.length;t+=1)i[t].c();T(e,"class","log svelte-1yweirf")},m(s,a){w(s,e,a);for(let t=0;t<i.length;t+=1)i[t].m(e,null);t[6](e),n=!0,r||(o=O(e,"scroll",t[3]),r=!0)},p(t,[n]){22&n&&(a=t[2],rt(),i=function(t,e,n,r,o,i,s,a,c,l,u,f){let p=t.length,h=i.length,d=p;const m={};for(;d--;)m[t[d].key]=d;const v=[],g=new Map,y=new Map;for(d=h;d--;){const t=f(o,i,d),r=n(t);let a=s.get(r);a?a.p(t,e):(a=l(r,t),a.c()),g.set(r,v[d]=a),r in m&&y.set(r,Math.abs(d-m[r]))}const b=new Set,w=new Set;function x(t){it(t,1),t.m(a,u),s.set(t.key,t),u=t.first,h--}for(;p&&h;){const e=v[h-1],n=t[p-1],r=e.key,o=n.key;e===n?(u=e.first,p--,h--):g.has(o)?!s.has(r)||b.has(r)?x(e):w.has(o)?p--:y.get(r)>y.get(o)?(w.add(r),x(e)):(b.add(o),p--):(c(n,s),p--)}for(;p--;){const e=t[p];g.has(e.key)||c(e,s)}for(;h;)x(v[h-1]);return v}(i,n,c,0,t,a,s,e,at,Mp,null,_p),ot())},i(t){if(!n){for(let t=0;t<a.length;t+=1)it(i[t]);n=!0}},o(t){for(let t=0;t<i.length;t+=1)st(i[t]);n=!1},d(n){n&&x(e);for(let t=0;t<i.length;t+=1)i[t].d();t[6](null),r=!1,o()}}}function Cp(t,e,n){let r,o,i;u(t,eu,(t=>n(2,o=t)));let s=!0;const a=new ResizeObserver((()=>{s&&n(0,i.scrollTop=i.scrollHeight,i)}));return P((()=>{a.observe(i)})),j((()=>{a.unobserve(i)})),n(1,r=t=>{confirm("Are you sure you want to delete this log entry?")&&eu.update((e=>e.filter((e=>e.id!==t))))}),[i,r,o,()=>{s=i.scrollTop===i.scrollHeight-i.offsetHeight},t=>{const e=new Date-t.dateCreated;return e<1e3&&e>0},t=>r(t.id),function(t){H[t?"unshift":"push"]((()=>{i=t,n(0,i)}))}]}const Op=class extends pt{constructor(t){super(),ft(this,t,Cp,Sp,s,{})}};function Tp(e){let n;return{c(){n=M("Oracles")},m(t,e){w(t,n,e)},p:t,i:t,o:t,d(t){t&&x(n)}}}const Ap=class extends pt{constructor(t){super(),ft(this,t,null,Tp,s,{})}};var Np;Np||(Np={});const Ep={},Dp=t=>Ep[t];function zp(t){let e,n,r;var o=Dp(t[0]);function i(t){return{props:{onClose:t[4],character:t[1]}}}return o&&(e=new o(i(t))),{c(){e&&ct(e.$$.fragment),n=C()},m(t,o){e&&lt(e,t,o),w(t,n,o),r=!0},p(t,r){const s={};if(2&r&&(s.character=t[1]),o!==(o=Dp(t[0]))){if(e){rt();const t=e;st(t.$$.fragment,1,0,(()=>{ut(t,1)})),ot()}o?(e=new o(i(t)),ct(e.$$.fragment),it(e.$$.fragment,1),lt(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&it(e.$$.fragment,t),r=!0)},o(t){e&&st(e.$$.fragment,t),r=!1},d(t){t&&x(n),e&&ut(e,t)}}}function Rp(t){let e,n,r,o,i,s,a,c,l,u,f,p=void 0!==t[0]&&zp(t);return{c(){e=$("div"),n=$("span"),n.textContent="Adventure Moves",r=S(),o=$("ul"),i=$("li"),s=$("button"),s.textContent="Face Danger",a=S(),p&&p.c(),c=C(),T(e,"class","wrapper svelte-69czze")},m(h,d){w(h,e,d),b(e,n),b(e,r),b(e,o),b(o,i),b(i,s),w(h,a,d),p&&p.m(h,d),w(h,c,d),l=!0,u||(f=O(s,"click",t[5]),u=!0)},p(t,[e]){void 0!==t[0]?p?(p.p(t,e),1&e&&it(p,1)):(p=zp(t),p.c(),it(p,1),p.m(c.parentNode,c)):p&&(rt(),st(p,1,1,(()=>{p=null})),ot())},i(t){l||(it(p),l=!0)},o(t){st(p),l=!1},d(t){t&&x(e),t&&x(a),p&&p.d(t),t&&x(c),u=!1,f()}}}function Ip(t,e,n){let r;const o=Ul("mock");let i;u(t,o,(t=>n(1,r=t)));const s=t=>{n(0,i=t)};return[i,r,o,s,()=>{n(0,i=void 0)},()=>s(Np.FaceDanger)]}const Bp=class extends pt{constructor(t){super(),ft(this,t,Ip,Rp,s,{})}};function Pp(t){let e,n;return e=new Op({}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function jp(t){let e,n;return e=new $p({}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Vp(t){let e,n;return e=new Bp({}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Lp(t){let e,n;return e=new Ap({}),{c(){ct(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ut(e,t)}}}function Hp(t){let e,n,r,i,s,a,c,l,u,f,p,h,d,v,g,y,k,_,C,O,A,N,E,D,z,R,I,B,P,j,V,L,H,F,W,q,J;return s=new qf({props:{icon:mf}}),p=new qf({props:{icon:gf}}),k=new qf({props:{icon:df}}),E=new qf({props:{icon:hf}}),B=new pf({props:{path:"/log",$$slots:{default:[Pp]},$$scope:{ctx:t}}}),j=new pf({props:{path:"/character",$$slots:{default:[jp]},$$scope:{ctx:t}}}),L=new pf({props:{path:"/moves",$$slots:{default:[Vp]},$$scope:{ctx:t}}}),F=new pf({props:{path:"/oracles",$$slots:{default:[Lp]},$$scope:{ctx:t}}}),{c(){e=$("div"),n=$("nav"),r=$("a"),i=$("span"),ct(s.$$.fragment),a=M("Log"),l=S(),u=$("a"),f=$("span"),ct(p.$$.fragment),h=M("Character"),v=S(),g=$("a"),y=$("span"),ct(k.$$.fragment),_=M("Moves"),O=S(),A=$("a"),N=$("span"),ct(E.$$.fragment),D=M("Oracles"),R=S(),I=$("section"),ct(B.$$.fragment),P=S(),ct(j.$$.fragment),V=S(),ct(L.$$.fragment),H=S(),ct(F.$$.fragment),T(i,"class","svelte-n81tin"),T(r,"href","/#/log"),T(r,"class","svelte-n81tin"),T(f,"class","svelte-n81tin"),T(u,"href","/#/character"),T(u,"class","svelte-n81tin"),T(y,"class","svelte-n81tin"),T(g,"href","/#/moves"),T(g,"class","svelte-n81tin"),T(N,"class","svelte-n81tin"),T(A,"href","/#/oracles"),T(A,"class","svelte-n81tin"),T(n,"class","svelte-n81tin"),T(I,"class","svelte-n81tin"),T(e,"id","tools"),T(e,"class","svelte-n81tin")},m(t,o){w(t,e,o),b(e,n),b(n,r),b(r,i),lt(s,i,null),b(i,a),b(n,l),b(n,u),b(u,f),lt(p,f,null),b(f,h),b(n,v),b(n,g),b(g,y),lt(k,y,null),b(y,_),b(n,O),b(n,A),b(A,N),lt(E,N,null),b(N,D),b(e,R),b(e,I),lt(B,I,null),b(I,P),lt(j,I,null),b(I,V),lt(L,I,null),b(I,H),lt(F,I,null),W=!0,q||(J=[m(c=tf.call(null,r)),m(d=tf.call(null,u)),m(C=tf.call(null,g)),m(z=tf.call(null,A))],q=!0)},p(t,[e]){const n={};1&e&&(n.$$scope={dirty:e,ctx:t}),B.$set(n);const r={};1&e&&(r.$$scope={dirty:e,ctx:t}),j.$set(r);const o={};1&e&&(o.$$scope={dirty:e,ctx:t}),L.$set(o);const i={};1&e&&(i.$$scope={dirty:e,ctx:t}),F.$set(i)},i(t){W||(it(s.$$.fragment,t),it(p.$$.fragment,t),it(k.$$.fragment,t),it(E.$$.fragment,t),it(B.$$.fragment,t),it(j.$$.fragment,t),it(L.$$.fragment,t),it(F.$$.fragment,t),W=!0)},o(t){st(s.$$.fragment,t),st(p.$$.fragment,t),st(k.$$.fragment,t),st(E.$$.fragment,t),st(B.$$.fragment,t),st(j.$$.fragment,t),st(L.$$.fragment,t),st(F.$$.fragment,t),W=!1},d(t){t&&x(e),ut(s),ut(p),ut(k),ut(E),ut(B),ut(j),ut(L),ut(F),q=!1,o(J)}}}function Fp(t){return Qu.mode.hash(),[]}const Wp=class extends pt{constructor(t){super(),ft(this,t,Fp,Hp,s,{})}};function qp(e){let n,r,o,i,s,a,c,l,u;return o=new ju({}),a=new Wp({}),l=new pf({props:{path:"/",redirect:"/log"}}),{c(){n=$("main"),r=$("div"),ct(o.$$.fragment),i=S(),s=$("div"),ct(a.$$.fragment),c=S(),ct(l.$$.fragment),T(r,"id","editor-wrapper"),T(r,"class","svelte-42ia0z"),T(s,"id","tools-wrapper"),T(s,"class","svelte-42ia0z"),T(n,"class","svelte-42ia0z")},m(t,e){w(t,n,e),b(n,r),lt(o,r,null),b(n,i),b(n,s),lt(a,s,null),w(t,c,e),lt(l,t,e),u=!0},p:t,i(t){u||(it(o.$$.fragment,t),it(a.$$.fragment,t),it(l.$$.fragment,t),u=!0)},o(t){st(o.$$.fragment,t),st(a.$$.fragment,t),st(l.$$.fragment,t),u=!1},d(t){t&&x(n),ut(o),ut(a),t&&x(c),ut(l,t)}}}new class extends pt{constructor(t){super(),ft(this,t,null,qp,s,{})}}({target:document.body});const Jp="mock",Kp="character_mock",Up=localStorage.getItem(Kp),Yp=localStorage.getItem("log"),Gp=Ul(Jp);if(null!=Up){const t=Fl(JSON.parse(Up));Gp.set(t)}null!=Yp&&eu.set(JSON.parse(Yp)),eu.subscribe((t=>{localStorage.setItem("log",JSON.stringify(t))})),Ul(Jp).subscribe((t=>{const e={id:(n=t).id,name:n.name,experience:n.experience,stats:{ironBaseValue:n.stats.iron.baseValue,heartBaseValue:n.stats.heart.baseValue,edgeBaseValue:n.stats.edge.baseValue,shadowBaseValue:n.stats.shadow.baseValue,witsBaseValue:n.stats.wits.baseValue},statuses:{healthBaseValue:n.statuses.health.baseValue,spiritBaseValue:n.statuses.spirit.baseValue,supplyBaseValue:n.statuses.supply.baseValue},momentum:{currentBaseValue:n.momentum.current.baseValue,maxBaseValue:n.momentum.max.baseValue,minBaseValue:n.momentum.min.baseValue,resetBaseValue:n.momentum.reset.baseValue},bonds:n.bonds,debilities:n.debilities,vows:n.vows};var n;localStorage.setItem(Kp,JSON.stringify(e))}))})()})();